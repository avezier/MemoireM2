\chapter{Préliminaires}

\section{Algèbre commutative}

\subsection{Extensions entières d'anneaux}

\begin{defn}[Anneau intègralement clos]\label{normalring}
Soit $A$ un anneau. $A$ est dit intégralement clos si il est intègre et égal à sa clôture intégrale. 
\end{defn}

\begin{rem}
Il existe une notion plus générale qu'il est utile de mentionner pour la consistance avec la terminologie de variété normale que nous verrons plus loin. Pour un anneau quelconque $A$, on dit que $A$ est normal si tout localisé de $A$ en idéal premier est un anneau intègre et intégralement clos. On note qu'un anneau intègre est intégralement clos si et seulement si il est normal (\cite{atiyahmacdo} 5.13). Mentionnons que nous ne rencontrerons pas dans ce mémoire d'anneaux normaux non-intègres, donc la définition ci-dessus sera suffisante.
\end{rem}


\begin{thm}\label{factonormal}
Soit $A$ un anneau intègre noetherien intégralement clos. Alors
\begin{enumerate}
\item Tous les diviseurs premiers d'un idéal principal non-nul sont de hauteur 1.
\item $A=\cap_{p \textrm{ premier, } \textrm{ht}(p)=1} A_p$
\end{enumerate}
\end{thm}
\begin{proof}
Prendre la preuve dans \cite{Matsumura} thm 11.5 p81
\end{proof}


\begin{thm}\label{UFDPID}
Soit $A$ un anneau intègre noetherien intégralement clos. \\
Alors, $A$ est factoriel $\iff$ Tout idéal premier de hauteur 1 est principal.
\end{thm}
\begin{proof}
\end{proof}

\subsection{Anneaux locaux, Anneaux de valuation discrète}

\begin{thm}\label{reglocufd}
Un anneau local régulier est factoriel.
\end{thm}
\begin{proof}
Voir \cite{Matsumura} 20.3
\end{proof}

\begin{thm}\label{ideauxinversibles}
Soit $A$ un anneau intègre et $I$ un idéal fractionnaire de $A$. Les assertions suivantes sont équivalentes:
\begin{enumerate}
\item $I$ est inversible
\item $I$ est un $A$-module projectif
\item $I$ est de type fini, et pour tout idéal maximal $m$ de $A$, l'idéal fractionnaire $I_m$ de $A_m$ est principal.
\end{enumerate}
\end{thm}
\begin{proof}
Voir \cite{Matsumura} 11.3
\end{proof}

\subsection{Algèbres graduées}



\section{Schémas}

Notre principale référence est \cite{Hartshorne}. On résume dans cette partie certains faits et définitions. En particulier, on donne les démonstrations de certains résultats donnés en exercices. Soit $A$ un anneau, $\mathfrak{p}$ un idéal premier de $A$, et $f\in A$ un élément. On note $A_\mathfrak{p}$ la localisation de $A$ en la partie multiplicative $A\setminus \mathfrak{p}$, et $A_f$ la localisation de $A$ en la partie multiplicative $\lbrace 1, f, f^2, ....\rbrace$.

\subsection{Généralités}

Soit $A$ un anneau, on note $X=\spec A$ l'ensemble de ses idéaux premiers, il est naturellement muni d'une topologie en définissant que les fermés sont les parties de la forme $\Vv_X(\mathfrak{a})=\lbrace \mathfrak{p}\in X\mid \mathfrak{a}\subset \mathfrak{p}\rbrace$, où $\mathfrak{a}$ est un idéal de $A$. On munit $X$ d'un faisceau d'anneaux $\Oo_X$, dit faisceau structural, constitué pour tout ouvert $U\subset X$ des sections $s: U\mapsto \bigsqcup_{\mathfrak{p}\in U}A_\mathfrak{p}$ telles que $s(\mathfrak{p})\in A_\mathfrak{p}$, et pour tout $\mathfrak{p}\in U$, il existe un voisinage $V\subset U$ de $\mathfrak{p}$ et des éléments $a,f\in A$ tels que pour tout $\mathfrak{q}\in V$, on ait $f\notin \mathfrak{q}$ et $s(\mathfrak{q})=a/f\in A_\mathfrak{q}$. Les sections $s$ sur un ouvert $U$ sont appelées les fonctions régulières sur $U$. On peut définir le même faisceau structural d'une manière différente en remarquant que $X$ possède une base d'ouverts, dits principaux, de la forme $X_f:=X\setminus \Vv_X((f))$ avec $f\in A$. On pose alors $\Oo(X_f)=A_f$ et on vérifie grâce aux propriétés $(A_f)_g\simeq A_{fg}$ et $X_{fg}=X_f\cap X_g$ que cela définit bien un "faisceau" sur cette base d'ouverts. qui se prolonge donc de manière unique en un faisceau sur $X$. En particulier on obtient immédiatement $A=\Gamma(X, \Oo_X)$, et sans difficulté $\Oo_{X,\mathfrak{p}}\simeq A_\mathfrak{p}$. 

\begin{defn}[Espace annelé]
Un espace annelé est un espace topologique $X$ muni d'un faisceau d'anneau $\Oo_X$ tel que les tiges $\Oo_{X,x}$ soient des anneaux locaux en tout point $x\in X$.

Un morphisme d'espaces annelés $(f, f^\sharp):(X,\Oo_X)\rightarrow (Y,\Oo_Y)$ est une application continue $f:X\rightarrow Y$ et un morphisme $f^\sharp:\Oo_Y\rightarrow f_*\Oo_X$ tel que les morphismes induits entre les tiges soient locaux, c'est à dire $f^{\sharp -1}_x(\mathfrak{m}_x)=\mathfrak{m}_{f(x)}$ pour tout $x\in X$.
\end{defn}

\begin{defn}[Schéma affine, schéma]
Un schéma affine est un espace annelé isomorphe au spectre d'un anneau muni de son faisceau structural. Un schéma est espace annelé $(X,\Oo_X)$ tel que tout point $x\in X$ admet un voisinage ouvert $U$ tel que $(U,\Oo_U)$ soit un schéma affine. Un morphisme de schémas est un morphisme d'espaces annelés.
\end{defn}

Tout morphisme d'anneaux $\phi:A\rightarrow B$ définit un morphisme de schémas affines $(f,f^\sharp):\spec B\rightarrow\spec A$. En effet, on pose $f(\mathfrak{p}):=\phi^{-1}(\mathfrak{p})$ pour tout $\mathfrak{p}\in \spec B$. Puis, pour tout ouvert $V\subset \spec A$, $s\in\Oo_{\spec A}(V)$, et $\mathfrak{p}\in f^{-1}(V)$, on pose $f^\sharp(s)(\mathfrak{p}):=\phi_{\mathfrak{p}}\circ s \circ f(\mathfrak{p})$, où $\phi_{\mathfrak{p}}:A_{f(\mathfrak{p})}\rightarrow B_{\mathfrak{p}}$ est la localisation de $\phi$.
Réciproquement, tout morphisme entre schémas affines $f:\spec B\rightarrow \spec A$ définit un morphisme d'anneaux en prenant les sections globales $\Gamma(\spec A, f^\sharp):A\rightarrow B$. Ces deux procédés sont inverses l'un de l'autre et on obtient:


\begin{prop}
Les foncteurs $\spec$ et $\Gamma(.)$ définissent une anti-équivalence de catégories entre la catégorie des schémas affines et la catégorie des anneaux (commutatifs).
\end{prop}

Soit $X$ un schéma, $f\in \Oo(X)$ une fonction régulière sur $X$, et $x$ un point de $X$. On dit que $f$ s'annule en $x$ si son germe n'est pas inversible dans l'anneau local $\Oo_{X,x}$. Soit $U=\spec A$ un voisinage affine de $x$, on a un isomorphisme canonique $\Oo_{X,x}\simeq A_\mathfrak{p}$, où $\mathfrak{p}$ est l'idéal premier correspondant à $x$. Alors $f$ s'annule en $x$ revient à dire que $f_{|U}\in p$. On peut alors par exemple parler de l'idéal de $\Oo(X)$ des fonctions régulières s'annulant sur un fermé $F$ de $X$, on le note $\Ii_X(F)$. Ainsi, $F$ définit un faisceau d'idéaux $\Ii_F:U\mapsto \Ii_U(F\cap U)$ radicaux qui définit une structure de schéma $(F, i^{-1}(\Oo_X/\Ii_F))$ sur $F$, où $i$ est l'inclusion. Si $X=\spec A$ est un schéma affine, on a alors pour un idéal $\mathfrak{a}$ et une partie $Y$ de $X$ les formules
$$\Ii_X(Y)=\bigcap_{\mathfrak{p}\in Y}\mathfrak{p},\,\,\,\,\, \Ii_X(\Vv_X(\mathfrak{a}))=\sqrt{\mathfrak{a}},\,\,\,\,\,\,\Vv_X(\Ii_X(Y))=\overline{Y}$$

\begin{rem}
On remarque que si on considère une algèbre affine, c'est à dire une $k$-algèbre de type fini réduite, et que l'on suppose de plus le corps algébriquement clos. Alors si l'on remplace "premier" par "maximal" dans les formules ci-dessus relatives aux opérations $\Vv$ et $\Ii$, on retombe sur les définitions classiques de ces opérations qui donnent les ensemble algébriques et leurs équations dans un espace affine de dimension finie sur $k$. En effet le Nullstellensatz assure dans ce cas que les points de l'ensemble algébrique correspondent aux idéaux maximaux de l'algèbre et que $\Ii(Y)=\bigcap_{y\in Y}\mathfrak{m}_y$.

Par ailleurs, une fonction régulière $s$ sur un ouvert $U$ d'un schéma $X$ peuvent être vue comme une fonction à valeurs dans les différents corps résiduels $A_\mathfrak{p}/\mathfrak{p}A_\mathfrak{p}$ pour chaque $\mathfrak{p}\in U$ en prenant $s(\mathfrak{p})$ modulo $\mathfrak{p}A_\mathfrak{p}$. Dans le cas d'une variété affine, c'est à dire $X=\spec A$ où $A$ est une $k$-algèbre affine sur un corps algébriquement clos, tous les corps résiduels sont isomorphes à $k$. D'après le Nullstellensatz, l'évaluation de $s\in A$ en les points fermés, c'est à dire les idéaux maximaux, coïncide avec l'évaluation de $s$ en les points correspondants de l'ensemble algébrique associé à $A$. Enfin, considérons deux $k$-algèbres affines $A$ et $B$ sur un corps algébriquement clos, et $X, Y$ les variétés affines correspondantes. Étant donné un morphisme $f:X\rightarrow Y$, le morphisme de $k$-algèbres correspondant est $\phi:A\rightarrow B,s\mapsto s\circ f$. En considérant $X$ et $Y$ plongés dans un espace affine et en prenant pour $s$ les différentes coordonnées de $Y$ on retrouve la définition classique que les morphismes entre ensembles algébriques sont les applications polynomiales.
\end{rem}

\noindent On rappelle maintenant la construction de schémas par recollement qui nous sera très utile par la suite.

\begin{cons}\label{gluevar}[Recollement de schémas]
Soit $(X_i)_{u\in I}$ une famille de schémas. Supposons $\forall i,j$ on ait des ouverts $X_{ij}\subset X_i$ et des isomorphismes $f_{ij}:X_{ij}\rightarrow X_{ji}$ tels que $\forall i,j,k\in I$ on ait:
	\begin{enumerate}
	\item $X_{ii}=X_i$ et $f_{ii}=id$
	\item $f_{ij}^{-1}(X_{ji} \cap X_{jk}) =  X_{ij} \cap X_{ik}$
	\item Le diagramme suivant commute:
	$$
		\begin{tikzcd}
		  X_{ij}\cap X_{ik} \arrow[rd, "f_{ij}"] \arrow[rr, "f_{ik}"] & & X_{ki}\cap X_{kj}\\
  		 & X_{ji}\cap X_{jk} \arrow[ru, "f_{jk}"] &
	\end{tikzcd}
	$$
	\end{enumerate}
Alors on peut définir un schéma $X$ comme la réunion disjointe des $X_i$ modulo la relation d'équivalence $x\sim x' \iff (x\in X_{ij}, x'\in X_{ji}$ et $f_{ij}(x)=x')$. On note $f_i:X_i\rightarrow X$ les applications canoniques, et on munit 
$X$ de la topologie finale associée aux $f_i$. On vérifie que chaque $f_i$ est une immersion ouverte dont on note $U_i$ l'image. Le faisceau structural est définit en recollant les $\mathcal{O}_{U_i}:=f_{i\star}\mathcal{O}_{X_i}$, ses sections sur un ouvert $W\subset X$ étant $$
\mathcal{O}_X(W) =
\{
(s_i)_{i \in I} \mid
s_i \in \mathcal{O}_{U_i}(W \cap U_i),
f_{ij}(s_i|_{W \cap U_i \cap U_j}) = s_j|_{W \cap U_i \cap U_j}
\}
$$
\end{cons}




\subsection{Quelques propriétés des schémas}

\subsubsection{Schémas réduits, irréductibles, intègres, noetheriens}

\begin{defn}
Un schéma $X$ est réduit si pour tout $x\in X$ les anneaux locaux $\Oo_{X,x}$ sont réduits. 
\end{defn}

\begin{prop}
Un schéma $X$ est réduit si et seulement si pour tout ouvert $U\subset X$, l'anneau $\Oo(U)$ est réduit.
\end{prop}
\begin{proof}
Supposons $X$ réduit et $f\in \Oo(U)$ nilpotent. Si $f$ est non-nul, alors il existe un germe $f_x$ non-nul pour un point $x\in U$. Mais alors $f_x^n=0$ pour un $n>0$, et donc $f_x=0$, contradiction.
Réciproquement, soit $f_x\in \Oo_{X,x}$ nilpotent alors $f_x$ est la classe d'une fonction nilpotente $f\in \Oo(U)$ pour un ouvert $U\subset X$. Cela implique $f_x=0$.
\end{proof}

\begin{defn}
Un schéma est dit irréductible si l'espace topologique sous-jacent est irréductible, c'est à dire qu'il est non vide et n'est pas réunion de deux fermés propres.
\end{defn}

\begin{prop}
Un schéma $X=\spec A$ un schéma affine, et $\mathfrak{a}$ un idéal.
\begin{enumerate}
\item $\Vv_X(\mathfrak{a})$ est irréductible si et seulement si $\sqrt{\mathfrak{a}}$ est premier
\item Soit $(\mathfrak{p}_i)$ les premiers minimaux de $A$. Alors $(\Vv_X(\mathfrak{p}_i))$ sont les composantes irréductibles de $X$.
\item $X$ est irréductible si et seulement si $A$ admet un unique idéal premier minimal. Dans ce cas, cet idéal est nécessairement $(0)$, et $A$ est intègre.
\end{enumerate}
\end{prop}

\begin{defn}
Un schéma $X$ est dit noetherien si c'est une union finie d'ouverts affines $U_i$ tels que $\Oo(U)$ est un anneau noetherien
\end{defn}

\begin{prop}
Soit $X$ un schéma noetherien. Alors 
\begin{enumerate}
\item Les tiges de $X$ sont des anneaux noetheriens. Tout sous-schéma ouvert ou fermé de $X$ est noetherien.
\item $X$ est quasi-compact et $\Oo(U)$ est noetherien pour tout ouvert affine $U\subset X$.
\end{enumerate}
\end{prop}

Par le lemme de Zorn, on montre que l'ensemble des fermés irréductibles d'un schéma $X$ admet des éléments maximaux, appelés composantes irréductibles. Si $X$ est noetherien, ce nombre est fini et $X$ s'écrit donc de manière unique comme réunion de ses composantes irréductibles. Pour tout point $x\in X$, les composantes irréductibles de $\spec \Oo_{X,x}$ correspondent bijectivement aux composantes irréductibles de $X$ passant par $x$.

Un point $x$ d'un espace topologique $X$ est dit générique si $\overline{\lbrace x\rbrace}=X$. Ainsi, si $X$ admet un point générique, il est irréductible. Pour un schéma $X$ on a en fait une correspondance bijective entre fermés irréductibles de $X$ et points génériques donnée par $x\mapsto \overline{\lbrace x\rbrace}$. Dans le cas d'un schéma affine

\begin{defn}
Un schéma $X$ est intègre si il est réduit et irréductible.
\end{defn}

\begin{prop}
Un schéma $X$ est intègre si et seulement si $\Oo(U)$ est intègre pour tout ouvert $U\subset X$ non-vide.
\end{prop}

Un schéma affine $X=\spec A$ est intègre si et seulement si $A$ est intègre. Alors le point générique $\eta$ de $X$ correspond à l'idéal $(0)$ est $\Oo_{X,\eta}$ est la localisation $A_{(0)}$, c'est à dire le corps des fractions de $A$. Plus généralement, on introduit le de corps des fonctions rationnelles d'un schéma intègre $X$ comme les fonctions régulières sur un ouvert non-vide de $X$. Comme tout ouvert non-vide contient le point générique $\eta$ de $X$, il s'agit de $\Oo_{X,\eta}$ qui est bien un corps d'après ce que précède, on le note $k(X)$.

\begin{prop}
Un schéma $X$ un schéma intègre et $k(X)$ son corps des fonctions rationnelles. Alors 
\begin{enumerate}
\item Les tiges de $X$ sont des anneaux noetheriens. Tout sous-schéma ouvert ou fermé de $X$ est noetherien.
\item $X$ est quasi-compact et $\Oo(U)$ est noetherien pour tout ouvert affine $U\subset X$.
\end{enumerate}
\end{prop}


\subsubsection{Schémas quasi-affines}

\subsection{Quelques propriétés des morphismes de schémas}

\subsubsection{morphismes de type fini, morphismes finis}

\subsubsection{Morphismes finis, normalité}

\begin{defn}[Morphisme fini]
Soit $f:X \rightarrow Y$ un morphisme de schémas. On dit que $f$ est fini si pour tout ouvert affine $V$ de $Y$, si la $\Oo_Y(V)$-algèbre $(\Oo_X(f^{-1}(V)), f^\sharp)$ est finie.
\end{defn}

\subsubsection{morphismes affines}

\begin{defn}[Morphisme affine]
Un morphisme de variétés algébriques $\phi: X\rightarrow Y$ est dit affine si pour tout ouvert affine $V\subset Y$, l'image réciproque $\phi^{-1}(V)$ est affine.
\end{defn}

\begin{ex}\label{exaff}
Un morphisme de variétés affines $\phi: X\rightarrow Y$ est affine. En effet, soit $V$ un ouvert affine de $Y$ et $U=\phi^{-1}(V)$. En considérant le diagramme commutatif ci-dessous on constate que l'on a $U \simeq (\phi\times i_2)^{-1}(\Delta_Y)=\lbrace (x,\phi(x))\mid x\in U \rbrace \subset X\times V$. Comme $X\times V$ est affine, $U$ aussi.
	\begin{center}
	\begin{tikzcd}
  		U \arrow[r, "\phi"] \arrow[d, "i_1"]& V \arrow[d, "i_2"] \\ 
  		X \arrow[r, "\phi"] & Y
	\end{tikzcd}\\
	\end{center}

\end{ex}

\subsubsection{morphismes séparés}


\begin{defn}
Soit $X, Y$ des variétés. Supposons que $X$ soit une variété sur $Y$ par un morphisme $f:X\rightarrow Y$. On dit que $X$ est séparé sur $Y$ si $f$ est séparé, c'est à dire que l'image du morphisme diagonal dans $X\times_Y X$ est fermé.
\end{defn}

\begin{prop}\label{sepCritere}
	\begin{enumerate}
	\item la composition de deux morphismes séparés est séparé.
	\item Lemme 25.21.8 stacks
	\end{enumerate}
\end{prop}
\begin{proof}
\end{proof}

\subsubsection{morphismes propres}


\subsection{Variétés algébriques}

Dans ce mémoire, on travaille principalement dans la catégorie des $k$-schémas réduits séparés de type fini sur $k$, où $k$ est un corps algébriquement clos de caractéristique zéro fixé. Ces objets sont appelés des $k$-variétés algèbriques, ou tout simplement variétés.  Cette catégorie est équivalente à la catégorie des $k$-variétés algébriques au sens de \cite{LAGSpringer} en ne considérant que les points fermés. D'ailleurs, par un point d'une variété $X$, on entendra point fermé, sauf mention du contraire. Soit $X_0$ le sous espace des points fermés de $X$ muni de la topologie induite. Alors les treillis des ouverts des topologies de $X$ et $X_0$ sont isomorphes. On bénéficie ainsi des résultats sur les morphismes et la dimension démontrés par exemple dans \cite{LAGSpringer} ou \cite{MumfordRedBook} chap I.

On note que la sous-catégorie pleine des variétés affines est anti-équivalente à celle des $k$-algèbre de type fini réduites via le foncteur sections globales, noté $k[.]$ dans ce cas pour coller aux notations traditionnelles. Un schéma de type fini sur un corps est noetherien, on en déduit que toute partie localement fermée d'une variété admet une unique structure de variété, et tout fermé se décompose de manière unique en une union finie de sous-variétés fermées irréductibles maximales. Enfin, le produit sur $k$ préserve l'irréductibilité.





\subsection{Dimension des variétés algébriques}

\begin{thm}\label{dimsousvariete}
Soit $X$ une variété irréductible, $U\subset X$ un ouvert non-vide et $f\in \Oo_X(U)^*$ non inversible. Soit $Z$ une composante irréductible de $\lbrace x \in U \mid f(x)=0 \rbrace$. Alors $\dime Z= \dime(X)-1$.
\end{thm}
\begin{proof}
Voir \cite{MumfordRedBook} I.7 Th.2, après réduction au cas $X$ affine, la preuve consiste en une réduction au cas facile où $\Oo(X)$ est factoriel. 
\end{proof}

\subsection{Propriétés des variétés normales}

\begin{defn}
Une variété est dite normale si tous ses anneaux locaux sont intègres et intégralement clos.
\end{defn}



\begin{prop}\label{normaluniondisjointe}
Une variété normale est union disjointe de ses composantes irréductibles.
\end{prop}
\begin{proof}
Si un point $p\in X$ d'une variété se situe à l'intersection de deux composantes irréductibles, l'anneau local en $p$ contient au moins deux premiers minimaux et n'est donc pas intègre.
\end{proof}

On note que une variété irréductible $X$ est normale si et seulement si pour tout ouvert affine $U\subset X$, $\mathcal{O}_X(U)$ est normal au sens de la définition \ref{normalring}.

\begin{prop}\label{codimesingnormal}
Le lieu singulier d'une variété normale est un fermé de codimension $\geq 2$
\end{prop}
\begin{proof}

\end{proof}


\begin{prop}\label{extregularnormal}
Soit $X$ une variété normale irréductible. Pour toute sous-variété fermée $Y$ de codimension $\geq 2$, la restriction $\Oo(X)\rightarrow \Oo(X\setminus Y)$ est un isomorphisme.
\end{prop}
\begin{proof}
On peut traiter le problème localement et supposer $X=\spec A$ affine. On considère $f$ régulière sur $U:=X\setminus Y$. On remarque que tout $p\in \spec A$ de hauteur $1$ est un point de $U$. En effet, dans le cas contraire il contiendrait les idéaux premiers correspondants aux composantes irréductibles de $Y$, ce qui est impossible car ils sont de hauteur $\geq 2$. On en déduit, en tenant compte de l'irréductibilité de $X$, des injections $\Oo_X(U)\xhookrightarrow{} \Oo_p=A_p$ dans les tiges qui peuvent être vues comme des inclusions dans le corps des fonctions rationnelles de $X$. On a ainsi en tenant compte de \ref{factonormal} un morphisme $\Oo_X(U)\xhookrightarrow{} \cap_p A_p=A=\Oo(X)$ qui est inverse de la restriction, d'où le résultat.
\end{proof}

\begin{prop}\label{codimaffinenormal}
Soit $X$ une variété affine irréductible. Pour toute variété irréductible $Y$ contenant $X$, le complémentaire $Y\setminus X$ est de codimension 1.
\end{prop}
\begin{proof}
On considère l'application de normalisation $\eta_Y$. Alors l'application induite $\eta_Y^{-1}(X)\rightarrow X$ est l'application de normalisation de $X$. On en déduit que $\eta_Y^{-1}(X)$ est affine. De plus, comme $\eta_Y$ est finie, la dimension du complémentaire de $X$ ne change pas en remplaçant $Y$ par sa normalisation et $X$ par sa préimage. On peut donc supposer $Y$ normal.

Quitte à soustraire de $Y$ les composantes irréductibles de codimension $1$ de $Y\setminus X$, on peut supposer $\codime_Y(Y\setminus X)\geq 2$. Soit $V$ un ouvert affine de $Y$. Par irréductibilité de $Y$, on a $U:=X\cap V$ non-vide et $\codime_V(V\setminus U)=\codime_Y(Y\setminus X)\geq 2$. Ainsi d'après \ref{extregularnormal}, la restriction $\Oo(V)\rightarrow \Oo(U)$ est un isomorphisme. Comme $U$ et $V$ sont affines, cela signifie que l'inclusion $U\subset V$ est un isomorphisme, d'où $U=V$ puis $X=Y$.
\end{proof}


\subsection{Fibres des morphismes}

\begin{defn}[Morphisme quasi-fini]
Soit $f:X \rightarrow Y$ un morphisme de variétés. On dit que $f$ est quasi-fini si les fibres de $f$ sont finies.
\end{defn}

\begin{thm}[Théorème principal de Zariski]\label{ZMT}
Soit $f:X\rightarrow Y$ un morphisme birationnel quasi-fini (séparé?) de variétés irréductibles. On suppose de plus que $Y$ est normale. Alors $f$ est une immersion ouverte.
\end{thm}
\begin{proof}
Voir \cite{QingLiu} 4.4.6
\end{proof}

\begin{prop}\label{fibersCardinal}
Soient $X,Y$ deux variétés algébriques affines irréductibles de même dimension et $f:X \mapsto Y$ un morphisme dominant. Alors il existe $g\in \Oo(Y)$ non nulle tel que le morphisme induit $f:X_g \mapsto Y_g$ soit fini, surjectif avec des fibres de même cardinal.
\end{prop}
\begin{proof}
Par hypothèse, l'extension $k(Y) \xrightarrow{f^*} k(X)$ est algébrique finie, disons de degré n. En caractéristique zéro on peut trouver $u\in k(X)$ tel que $k(X)=k(Y)[u]$. On remarque que l'on peut imposer $u\in \Oo(X)$. On considère $P:=P_{min}(u, k(Y))=T^n+a_1T^{n-1}+...+a_0$. En réduisant au même dénominateur on a $P\in \Oo(Y)_v[T]$ pour un $v\in \Oo(Y)$. De plus, en prenant l'intersection avec d'autres ouverts principaux on peut supposer $\Oo(X)_v$ entier sur $\Oo(Y)_v$, et $\Oo(Y)_v[u]$ intégralement clos, ce qui donne $\Oo(Y)_v[u]=\Oo(X)_v$ et $\Oo(X)_v$ entier sur $\Oo(Y)_v$. Ainsi $f:X_v \rightarrow Y_v$ est fini et donc surjectif car dominant.\\
On a donc une factorisation de $f^*:\Oo(Y)_v\xrightarrow{p_1^*}\Oo(Y)_v[T]\xrightarrow{\pi}\Oo(Y)_v[T]/(P)\xrightarrow{\overline{ev_f}}\Oo(Y)_v[u]$ qui donne $f:X_v \xrightarrow{\simeq} \lbrace (y,t) \in Y_v\times \mathbb{A}^1\mid P(y)(t)=0\rbrace \hookrightarrow Y_v\times \mathbb{A}^1 \xrightarrow{p_1} Y_v$. Ainsi le cardinal de la fibre $f^{-1}(y), y\in Y_v$ est le cardinal de l'ensemble des zéros du polynôme $P(y)(T)$. On peut s'assurer que cet ensemble est de cardinal constant en intersectant à nouveau avec l'ouvert principal du discriminant de $P$ qui est un polynôme en les coefficients de $P$.
\end{proof}

Ce résultat reste vrai en caractéristique positive, voir 
~\cite{LAGSpringer} 5.1.6 pour une preuve légèrement différente dans ce cadre. On y montre que le cardinal de la fibre générale est $[k(X):k(Y)]_s$. En revanche pour le corollaire immédiat suivant, la caractéristique zéro est essentielle (penser par exemple au morphisme de Frobenius $\AAA^1 \xrightarrow{x \mapsto x^p} \AAA^1$ ). 

\begin{cor}\label{injectiveBirationel}
Avec les hypothèses de \ref{fibersCardinal}, si de plus $f$ est injectif, alors il existe $g\in \Oo(Y)$ non-nulle tel que le morphisme induit $f:X_g \mapsto Y_g$ soit un isomorphisme.
\end{cor}

\begin{thm}\label{ZMTCor}
Soit $f:X \mapsto Y$ un morphisme bijectif de variétés irréductibles avec $Y$ normale. Alors $f$ est un isomorphisme.
\end{thm}
\begin{proof}
D'après \ref{dimension fibres} on peut appliquer \ref{injectiveBirationel} et on obtient ainsi que $f$ est birationnel. Ensuite, \ref{ZMT} nous dit que $f$ est une immersion ouverte. Mais $f$ est surjective par hypothèse, c'est donc un isomorphisme.
\end{proof}

\begin{prop}\label{facto}
Soit $f:X \mapsto Y$ un morphisme dominant de variétés irréductibles. Soit $g:X \rightarrow Z$ constant sur les fibres de $f$. Alors il existe $h\in \Oo(Y)^*$ et une factorisation
	\begin{tikzcd}
		X_h \arrow[r,"g"] \arrow[d,"f"] & Z \\
		Y_h \arrow[ru, dashed]
	\end{tikzcd}
\end{prop}
\begin{proof}
	\begin{multicols}{2}
	On considère $\phi=(f,g):X\rightarrow Y\times Z$ et le diagramme commutatif ci-contre. Comme $f$ est dominant, $\pi_1$ l'est aussi. De plus $\overline{\phi(X)}$ est irréductible et $\phi(X)$ contient un ouvert dense de $\overline{\phi(X)}$. Par ailleurs comme $g$ est constante sur les fibres de $f$ on vérifie que $\pi_1$ est injective sur $\phi(X)$. Par le corollaire \ref{injectiveBirationel}, $\pi_1$ réalise un isomorphisme $\overline{\phi(X)}_h \xrightarrow{\pi_1} Y_h$ pour un $h\in \Oo(Y)$ non-nul. Finalement, le morphisme recherché est  $Y_h \xrightarrow{\pi_2\pi_1^{-1}} Z$.
	
	\columnbreak
	\begin{center}
	\begin{tikzcd}
  		& X \arrow[ldd,bend right,swap, "f"] \arrow[d, "\phi"] \arrow[rdd, bend left,"g"]  &\\ 
  		& \overline{\phi(X)} \arrow[ld,swap,"\pi_1"] \arrow[d,"i=\subset"] \arrow[rd,"\pi_2"]  &\\ 
		Y & \arrow[l,"p_1"]  Y\times Z \arrow[r,swap,"p_2"]  & Z
	\end{tikzcd}\\
	\end{center}
	\end{multicols}
\end{proof}




