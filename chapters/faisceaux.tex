\chapter{Faisceaux divisoriels sur une variété algébrique}


\section{Faisceaux de modules}

\noindent Dans cette partie on utilise les références \cite{QingLiu} et \cite{Hartshorne}.\\

Soit $X$ un schéma. Un \textit{$\Oo_X$-module} est un faisceau $\Ff$ tel que $\Ff(U)$ soit un $\Oo_X(U)$-module pour tout ouvert $U\subset X$, en demandant de plus que les actions soit compatibles aux restrictions, c'est à dire que pour tout ouverts $V\subset U$, $a\in\Oo(U)$, $f\in \Ff(U)$, on ait $(af)_{|V}=a_{|V}f_{|V}$. Un morphisme $\Ff\rightarrow\Gg$ de $\Oo_X$-modules est un morphisme de prefaisceaux tel que pour tout $U$ la flèche $\Ff(U)\rightarrow\Gg(U)$ soit un morphisme de $\Oo(U)$-modules. 

\subsection{Faisceaux quasi-cohérents}

Soit $X$ un schéma. Un $\Oo_X$-module $\Ff$ est \textit{quasi cohérent} si localement il admet une \textit{présentation}, c'est à dire que pour tout $x\in X$, il existe un voisinage ouvert $x\in U$ tel que on ait une suite exacte
\begin{center}
$\bigoplus_{j\in J}\Oo_{X|U}\rightarrow\bigoplus_{i\in I}\Oo_{X|U}\rightarrow \Ff_{|U}\rightarrow 0$
\end{center}

On dit que $\Ff$ est \textit{cohérent} si sur chaque voisinage, la présentation est finie, c'est à dire que les famille $I$ et $J$ sont finies.
Soit $X\simeq \spec A$ un schéma affine, et $M$ un $A$-module. On définit un $\Oo_X$-module $\widetilde{M}$ sur le même modèle que le faisceau structural en posant $\widetilde{M}(X_f)=M_f$ pour chaque ouvert principal $X_f$. On vérifie que cela définit un $\Oo_X$-module tel que $\widetilde{M}_\mathfrak{p}=M_\mathfrak{p}$ pour tout $\mathfrak{p}\in X$, et $\widetilde{M}(X)=M$.


\begin{prop}
Soit $X\simeq\spec A$ un schéma affine. L'application $M\mapsto \widetilde{M}$ définit un foncteur exact, plein et fidèle de la catégorie des $A$-module vers la catégorie des $\Oo_X$-module. De plus il commute aux sommes directes et au produit tensoriel.
\end{prop}
\begin{proof}
\cite[II.5.2]{Hartshorne}
\end{proof}


\begin{prop}\label{FQCProp2}
Soit $\Ff$ un faisceau quasi-cohérent sur un schéma $X$. On suppose $X$ noetherien, ou quasi-compact et séparé. Alors pour tout $f\in \Oo(X)$, le morphisme canonique
\begin{center}
$\Ff(X)_f=\Ff(X)\otimes_{\Oo(X)}\Oo(X)_f\rightarrow \Ff(X_f)$
\end{center}
est un isomorphisme.
\end{prop}
\begin{proof}
\cite[5.1.6]{QingLiu}
\end{proof}

\begin{thm}\label{FQCThm}
Soit $\Ff$ un $\Oo_X$-module sur un schéma $X$. Alors $\Ff$ est quasi-cohérent si et seulement si pour tout ouvert affine $U\subset X$, on a $\Ff(U)^{\widetilde{}}\simeq\Ff_{|U}$.

En particulier, si $X\simeq \spec A$ est affine, alors les foncteurs $M\mapsto \widetilde{M}$ et $\Gamma(X,.)$ réalisent une équivalence de catégories entre la catégorie des $A$-module et la catégorie des faisceaux quasi-cohérents sur $X$.
\end{thm}
\begin{proof}
\cite[5.1.7]{QingLiu}
\end{proof}

\begin{prop}
Soit $\Ff$ un faisceau quasi-cohérent sur un schéma noetherien $X$. Alors $\Ff$ est cohérent si et seulement si pour tout ouvert affine $U\subset X$, le module $\Ff(U)$ est de type fini. 
\end{prop}
\begin{proof}
\cite[5.1.11]{QingLiu}
\end{proof}

\begin{prop}\label{FQCProps3}
Soit $X$ un schéma, alors on a les propriétés suivantes
\begin{enumerate}
\item Une somme directe de faisceaux quasi-cohérents est un faisceau quasi-cohérent. Si $X$ est notherien, une somme directe finie de faisceaux cohérents est un faisceau cohérent.
\item Soient $\Ff$ et $\Gg$ des faisceaux quasi-cohérents sur $X$, alors $\Ff\otimes \Gg$ est quasi-cohérent. Si $X$ est noetherien et $\Ff,\Gg$ cohérents, alors $\Ff\otimes_{\Oo_X} \Gg$ est cohérent. Enfin, si $X$ est affine, alors $(\Ff\otimes_{\Oo_X}\Gg)(U)=\Ff(U)\otimes_{\Oo(U)}\Gg(U)$ pour tout ouvert $U\subset X$.
\item Soit $f:\Ff\rightarrow \Gg$ un morphisme de faisceaux quasi-cohérents. Alors $\Ker f$, $\Im f$ et $\Coker f$ sont quasi-cohérents. Si $X$ est noetherien, et $\Ff, \Gg$ cohérents, alors $\Ker f$, $\Im f$ et $\Coker f$ sont cohérents.
\item Soit $f:X\rightarrow Y$ un morphisme, et $\Gg$ un $\Oo_Y$-module quasi-cohérent. Soit $U$ un ouvert affine de $X$ tel que $f(U)$ est contenu dans un ouvert affine $V$ de $Y$. Alors
\begin{center}
$f^*\Gg_{|U}\simeq(\Gg(V)\otimes_{\Oo_Y(V)}\Oo_X(U))^{\widetilde{}}$
\end{center}
En particulier, $f^*\Gg$ est quasi-cohérent sur $X$. Si $X$ est noetherien et $\Gg$ cohérent, alors $f^*\Gg$ est cohérent.
\item Soit $f:X\rightarrow Y$ un morphisme, et $\Ff$ un $\Oo_X$-module quasi-cohérent. Si $X$ est noetherien, ou si $f$ est séparé et quasi-compact, alors $f_*\Ff$ est quasi-cohérent sur $Y$.
\item Soit $f:X\rightarrow Y$ un morphisme fini, et $\Ff$ un $\Oo_X$-module cohérent. Si $Y$ est noetherien, alors $f_*\Ff$ est cohérent sur $Y$.
\end{enumerate}
\end{prop}
\begin{proof}
\cite[5.1.14]{QingLiu}
\end{proof}

\subsection{Spectre relatif d'une $\Oo_X$-algèbre}

Soit $X=\spec A$ un schéma affine, et $B$ une $A$-algèbre. Ces données définissent naturellement un schéma $\widetilde{X}:=\spec B$ sur $X$ via un morphisme $f:\widetilde{X}\rightarrow X$ défini par la structure de $A$-algèbre sur $B$. De plus, $f_*\Oo_{\widetilde{X}}$ est un faisceau d'algèbres sur $X$ dans le sens où pour tout ouvert $U\subset X$, l'anneau $\Oo_{\widetilde{X}}(f^{-1}(U))$ est naturellement une $\Oo_X(U)$-algèbre. Finalement, $f_*\Oo_{\widetilde{X}}$ est un $\Oo_X$-module quasi-cohérent car il s'agit de $\widetilde{B}$.

\begin{defn}[$\Oo_X$-algèbre]
Soit $X$ un schéma. Une $\Oo_X$-algèbre est un faisceau d'anneaux $\Ss$ sur $X$ muni d'un morphisme $\Oo_X\rightarrow \Ss$. On dit que $\Ss$ est quasi-cohérente si elle l'est en tant que $\Oo_X$-module. On dit qu'elle est localement de type fini si tout point $x\in X$ admet un voisinage ouvert $U$ tel que $\Ss(U)$ soit de type fini en tant que $\Oo_X(U)$-algèbre.
\end{defn}

On introduit ci-dessous la version relative du spectre d'un anneau. On se donne un schéma de base $X$ que l'on suppose séparé pour les applications que l'on a en vue, et une $\Oo_X$-algèbre quasi-cohérente $\Ss$. A partir de ces données, on souhaite construire un schéma $\spec_X S$ sur $X$ dont le morphisme structural est affine. Cette construction nous sera très utile par la suite.

\begin{cons}[Spectre relatif]	\label{relspec}
Soit $X$ un schéma séparé, $\Ss$ une $\Oo_X$-algèbre quasi-cohérente, et $(U_i)_{i\in I}$ un recouvrement affine de $X$. Il existe un schéma $\spec_X \Ss$ construit par recollement des schémas affines $\spec(\Ss(U_i))$, unique à isomorphisme canonique près. Ce schéma est séparé sur $X$ via le recollement des morphismes $\spec(\Ss(U_i))\rightarrow U_i$ donnés par la structure d'algèbre. De plus, le morphisme structural $p$ est affine est on a l'égalité de faisceaux
$$p_*(\Oo_{\spec_X\Ss})=\Ss$$
Enfin, si $X$ est une variété et que $\Ss$ est un faisceau d'algèbres réduites, localement de type fini, alors $\spec_X \Ss$ est une variété.
\end{cons}
\begin{proof}
On note $U_{ij}:=U_i\cap U_j$, $A_i:=\Ss(U_i)$ et $A_{ij}:=\Ss(U_{ij})$. Les données donnent naturellement un diagramme commutatif

	\begin{center}
	\begin{tikzcd}
  		\widetilde{X}_{ij}:=\spec A_{ij} \arrow[r, "\phi_i"] \arrow[d, "p_{ij}"]& \widetilde{X}_i:=\spec A_i \arrow[d, "p_i"] \\ 
  		U_{ij} \arrow[r, "\iota=\subset"] & U_i
	\end{tikzcd}\\
	\end{center}
	
On a $\Ss_{|U_{ij}}=\iota^*(\Ss_{|U_i})$ donc $\widetilde{A_{ij}}=\iota^*(\widetilde{A_i})=\widetilde{A_i \otimes_{R_i}R_{ij}}$ d'après \ref{FQCProps3} $4$, où $R_i:=\Oo_X(U_i)$ et $R_{ij}:=\Oo_X(U_{ij})$, ce qui donne $A_{ij}\simeq A_i\otimes_{R_i}R_{ij}$ d'après \ref{FQCThm}, puis $\widetilde{X}_{ij}\simeq U_{ij}\times_{U_i}\widetilde{X}_i$. Cela prouve que $\phi_i$ est une immersion ouverte. On a de même une immersion ouverte $\phi_j:\widetilde{X}_{ij}\rightarrow \widetilde{X}_j$. Les $\phi_{ij}:=\phi_j\phi_i^{-1}$ vérifient bient les conditions de recollement de \ref{gluevar}. On a donc un schéma $\widetilde{X}$ sur $X$ car les $p_i$ se recollent en un morphisme $p:\widetilde{X}\rightarrow X$ qui est affine par construction. Ce morphisme est séparé d'après \ref{sepCritere}. La dernière assertion est claire par définition.
\end{proof}

\begin{rem}
Soit $X$ un schéma. On peut montrer (\cite[12.1]{Gortz}) que le foncteur $\Ss\mapsto \spec_X\Ss$ définit une anti-équivalence de catégories entre la catégorie des $\Oo_X$-algèbres quasi-cohérentes et la catégorie des schémas qui sont affines sur $X$, c'est à dire dont le morphisme structural est affine. Un quasi-inverse est donnée par $(f:Y\rightarrow X)\mapsto f_*\Oo_Y$.
\end{rem}


\subsection{Faisceaux quasi-cohérents sur une variété projective}

\label{FQCProj}

Soit $X:=\proj A$ une variété projective. Ainsi $A$ est une algèbre affine $\NN$-graduée engendrée par $r$ éléments homogènes de degré $1$ (\ref{ProjConstruction}), et on note $i:X\rightarrow \PP_k^r$ le plongement associé. Soit $M$ un $A$-module $\ZZ$-gradué. On définit un $\Oo_X$-module $\widetilde{M}$ en posant $\widetilde{M}(X_f):=M_{(f)}:=(M_f)_0$ pour tout ouvert principal $X_f$, avec $f\in A$ homogène. C'est un faisceau quasi-cohérent car $(\widetilde{M})_{|X_f}=\widetilde{M_{(f)}}$, où $M_{(f)}$ est un module sur $A_{(f)}=\Oo(X_f)$. Cette construction définit un foncteur exact de la catégorie des $A$-modules $\ZZ$-gradués vers la catégorie des faisceaux quasi-cohérents sur $X$, qui commute au produit tensoriel.

Pour tout $n\in \ZZ$, on note $\Oo_X(n)$ le faisceau quasi-cohérent associé au $A$-module décalé $A(n)$. Plus généralement, étant donné un $\Oo_X$-module quasi-cohérent $\Ff$, on définit le faisceau décalé $\Ff(n):=\Ff\otimes_{\Oo_X}\Oo_X(n)$, c'est un faisceau quasi-cohérent. L'opération tilde commute au décalage, et on a $\Oo_X(n)=i^*(\Oo_{\PP_k^r}(n))$.

On définit un foncteur exact à gauche de la catégorie des $\Oo_X$-module dans la catégorie des $A$-modules $\ZZ$-gradués en posant 
\begin{center}
$\Gamma_*(\Ff):=\bigoplus_{n=-\infty}^{+\infty}\Gamma(X,\Ff(n))$
\end{center}
En effet, tout élément homogène $f\in A_d$ définit une section globale de $\Oo_X(d)$ pour $d\in \ZZ$, puis pour tout $t\in \Gamma(X,\Ff(n)),\, n\in\ZZ$, on pose $ft=s\otimes_{\Oo(X)} t\in \Gamma(X, \Ff(n+d))$. Comme $A$ est engendré par des éléments homogènes de degré $1$, on a un isomorphisme naturel 
\begin{center}
$\Gamma_*(\Ff)^{\widetilde{}}\simeq \Ff\,\,\,\,\,$ (\cite[II.5.15]{Hartshorne})\end{center}

\begin{rem}
Si $X=\PP_k^r$, c'est à dire $A=k[x_0,....,x_r]$ on peut voir que l'on a un isomorphisme de $k$-algèbres graduées $\Gamma_*(\Oo_{\PP_k^r})\simeq k[x_0,...,x_r]$ (\cite[II.5.13]{Hartshorne}). En revanche, on n'a pas en général $\Gamma_*(\Oo_X)=A$ pour une algèbre affine $\NN$-graduée $A$ quelconque. En effet, supposons $X=\proj A$ irréductible et normale, avec $A=k[x_0,...,x_r]/I$ où $I$ est un idéal premier radical et homogène (\ref{ProjConstruction}). Le plongement $i$ donne lieu à une suite exacte courte
\begin{center}
$0\rightarrow\Ii_X:=\Ker i^\sharp\rightarrow\Oo_{\PP_k^r}\xrightarrow{i^\sharp}i_*\Oo_X\rightarrow 0$
\end{center}
On a $\Gamma_*(\Ii_X)=I$ (\cite[ex II.5.10]{Hartshorne}), et en appliquant $\Gamma_*$ on obtient une suite exacte
\begin{center}
$0\rightarrow I \xrightarrow{\subset} k[x_0,...,x_r]\xrightarrow{\Gamma_*(i^\sharp)}\Gamma_*(\Oo_X)$
\end{center}

Le morphisme $\Gamma_*(i^\sharp)$ n'est pas surjectif en général. Son image est isomorphe à $A$, et on peut montrer (\cite[II ex 5.14]{Hartshorne}) que $\Gamma_*(\Oo_X)$ est la clôture intégrale de $A$. Comme exemple concret on peut prendre par exemple l'immersion fermée $i:\PP_k^1\xhookrightarrow{}\PP_k^3$ donnée par le morphisme gradué $\phi:k[x,y,z,w]\rightarrow k[s,t]$, ($x\mapsto s^m, t\mapsto s^{m-1}t, z\mapsto st^{m-1},w\mapsto t^m)$. On peut voir que $\Gamma_*(\Oo_{i(\PP_k^1)})=\bigoplus_{d\geq 0}k[s,t]_{md}$ et que l'image de $\phi$ est strictement incluse dans cette algèbre pour $m\geq 4$.

\end{rem}

\subsection{Cohomologie des faisceaux et applications}

\subsubsection{Généralités}

On rappelle sans démonstrations quelques définitions et résultats de base, l'objectif étant de définir les groupes de cohomologie d'un faisceau sur un schéma relatifs au foncteur sections globales. La référence principale est \cite[chap III]{Hartshorne}.\\

Soit $X$ un schéma, on considère la catégorie $\Aa b(X)$ des faisceaux de groupes abéliens sur $X$, et la catégorie $\Mm od(X)$ des $\Oo_X$-modules. Soit $A^.$ un \textit{complexe} dans $\Aa b(X)$, c'est à dire une famille d'objets $(A^i)_{i\geq 0}$ et des morphismes $d^i:A^i\rightarrow A^{i+1}$ tels que $d^{i+1}d^i=0$ pour tout $i\geq 0$. Un morphisme de complexes $f:A^.\rightarrow B^.$ est une famille de morphismes $f^i:A^i\rightarrow B^i$ qui commutent avec les applications $d^i$. Le $i^e$ groupe de cohomologie $h^i(A^.)$ du complexe $A^.$ est le groupe $\Ker d^i/\Im d^{i-1}$. Soit $0\rightarrow A^.\rightarrow B^. \rightarrow C^. \rightarrow 0$ une suite exacte courte de complexes, on obtient grâce au lemme du serpent (\cite{atiyahmacdo} 2.10) des morphismes $\delta ^i:h^i(C^.)\rightarrow h^{i+1}(A^.) $ dits de connexion, donnant une suite exacte longue:
\begin{equation}\label{eq:longSES}
...\rightarrow h^i(A^.) \rightarrow h^i(B^.) \rightarrow h^i(C^.) \xrightarrow{\delta ^i} h^{i+1}(A^.) \rightarrow ...
\end{equation}

Ces définitions ont également un sens dans la catégorie $\Aa b$ des groupes abéliens, et si on se donne un foncteur $F:\Aa b(X)\rightarrow \Aa b$, alors $F$ envoie des complexes de faisceaux sur des complexes de groupes. On se fixe un tel foncteur $F$ et on suppose de plus qu'il est covariant exact à gauche. Pour tout faisceau $\Ff\in \Aa b(X)$ (resp. tout $\Ff\in\Mm od(X)$) on peut obtenir une résolution injective, c'est à dire une suite exacte:
$$0\rightarrow \Ff \xrightarrow{\epsilon} I^0\rightarrow I^1\rightarrow ...$$
telle que les faisceaux $I^k$ soient injectifs dans leurs catégories respectives. Cela signifie que les foncteurs $\Hom(.,I^k)$ sont exacts (ils sont exacts seulement à gauche en général). On définit les foncteurs dérivés à droite $R^iF$ de $F$ pour $i\geq 0$ par $R^i F(\Ff)=h^i(F(I^.))$, et on a le résultat fondamental suivant:

\begin{thm}
\begin{enumerate}
\item Les $R^i F$ définissent des foncteurs $\Aa b(X)\rightarrow \Aa b$. De plus, ils ne dépendent pas du choix des résolutions injectives à isomorphisme près.
\item On a un isomorphisme $F\simeq R^0F$
\item Pour tout suite exacte courte $0\rightarrow \Ff'\rightarrow \Ff \rightarrow \Ff'' \rightarrow 0$ dans $\Aa b(X)$, il existe un morphisme naturel de connexion $\delta^i:R^iF(\Ff'')\rightarrow R^{i+1}F(\Ff')$, tel que l'on obtient une suite exacte longue:
$$...\rightarrow R^iF(\Ff') \rightarrow R^iF(\Ff) \rightarrow R^iF(\Ff'') \xrightarrow{\delta ^i} R^{i+1}F(R^{i+1}) \rightarrow ...$$
\end{enumerate}
\end{thm}

\begin{defn}[Groupes de cohomologie d'un faisceau]
Soit $\Gamma(X,.):\Aa b(X)\rightarrow \Aa b$ le foncteur sections globales. Les foncteurs de cohomologie $H^i(X,.)$ sont les foncteurs dérivés à droite de $\Gamma(X,.)$. Pour tout $\Ff\in \Aa b(X)$, les groupes $H^i(X,\Ff)$ sont appelés les groupes de cohomologie de $\Ff$.
\end{defn}


Un faisceau $\Ff\in \Aa b(X)$ est dit \textit{acyclique} si $H^i(X,\Ff)$ est nul pour tout entier $i>0$. On peut toujours remplacer une résolution injective de $\Ff$ par une résolution acyclique pour le calcul des groupes de cohomologie de $\Ff$. Les faisceaux \textit{flasques} donne une classe de faisceaux acycliques, ce sont les faisceaux dont les flèches de restriction sont surjectives. De plus, tout $\Oo_X$-module injectif est flasque, on en déduit que l'on peut utiliser des résolutions injectives dans $\Mm od(X)$ pour calculer les groupes de cohomologie d'un $\Oo_X$-module vu comme faisceau de groupes abélien sur $X$.

\subsubsection{Cohomologie à support}

Soit $X$ un schéma, $\Ff\in \Aa b(X)$, et $Z$ un fermé de $X$. Le support $\supp\Ff$ est l'ensemble des points où la tige et non-nulle. De même, le support d'une section est l'ensemble des points où le germe de la section est non-nul, c'est un fermé de $X$. On définit le sous-faisceau $\Hh ^0 _Z(\Ff):V\mapsto \Gamma_{Z\cap V}(V,\Ff)$ où $\Gamma_{Z\cap V}(V,\Ff)$ est le sous-groupe de $\Gamma(V,\Ff)$ constitué des sections à support contenu dans $Z\cap V$. C'est bien un faisceau car les sections locales se recollent de manière unique en sections de $\Ff$ qui restent à support dans $Z$. En notant $U:=X\setminus Z$ et $j:U\rightarrow X$ l'inclusion, on a de plus une suite exacte

\begin{equation}\label{eq:ESSupport}
0\rightarrow \Hh^0 _Z(\Ff) \rightarrow \Ff \rightarrow j_*(\Ff_{|U})
\end{equation}

\begin{ex}\label{cohomsupportaffineex}
Soit $X=\spec A$ un schéma affine noetherien, $M$ un $A$-module, $\Ff:=\widetilde{M}$, $\mathfrak{a}\subset A$ un idéal, et $Z=\Vv_X(\mathfrak{a})$. Soit $m\in M=\Gamma(X,\Ff)$, alors $\supp m=\Vv_X(\ann m)$, où $\ann M=\lbrace a\in A\mid am=0\rbrace$ est l'annulateur de $m$. En effet, soit $\mathfrak{p}$ un point de $X$, alors $m_\mathfrak{p}\neq 0\iff \forall a\in A\setminus \mathfrak{p}, am\neq 0\iff \ann(m)\subset \mathfrak{p}$.

On définit un sous-module $\Gamma_\mathfrak{a}(M)$ de $M$ par $\Gamma_\mathfrak{a}(M):=\lbrace m\in M\mid \mathfrak{a}^nm=0 \text{ pour un } n>0 \rbrace$. Alors on a $\Gamma_\mathfrak{a}(M)^{\widetilde{}} = \Hh ^0 _Z(\Ff)$. En effet, tout d'abord $\Hh^0 _Z(\Ff)$ est quasi-cohérent comme noyau d'un morphisme entre faisceaux quasi-cohérents, cela d'après la suite exacte ci-dessus et \ref{FQCProps3} $5$ et $3$. En utilisant \ref{FQCThm}, il reste donc à montrer que $\Gamma_\mathfrak{a}(M)\simeq\Gamma_Z(X,\Ff)=\Gamma(X,\Hh ^0 _Z(\Ff))$ en tant que $A$-modules. Soit $m\in\Gamma_Z(X,\Ff)$, on a par définition $\supp m=\Vv_X(\ann m)\subset \Vv_X(\mathfrak{a})$, d'où $\mathfrak{a}\subset \sqrt{\ann m}$. Or, $\mathfrak{a}$ est de type fini car $A$ est noetherien, on en conclut que $m\in \Gamma_\mathfrak{a}(M)$. En effet, si on a $k$ générateurs $x_1,...,x_k$ de $\mathfrak{a}$, on peut trouver un exposant commun $n$ tel que $x^n_i$ annule $m$ pour tout $i$. Il s'en suit que l'on a par exemple $\mathfrak{a}^{n^k}m=0$. Réciproquement, si $m\in \Gamma_\mathfrak{a}(M)$, alors $\mathfrak{a}^n\subset \ann m$ pour un $n>0$, ce qui donne $\supp m \subset\Vv(\mathfrak{a}^n)=\Vv(\mathfrak{a})$, puis $m\in \Gamma_Z(X,\Ff)$. Finalement on a bien $\Gamma_\mathfrak{a}(M)=\Gamma_Z(X,\Ff)$.
\end{ex}

Il est facile de montrer que $\Gamma_Z(X, .)$ est un foncteur exact à gauche, on définit alors \textit{les groupes de cohomologie de $\Ff$ à support dans $Z$} comme ses foncteurs dérivés à droite, on les note $H_Z^i(X,\Ff)$. Si $\Ff$ est flasque, il est acyclique pour $\Gamma_Z(X, .)$, et de plus, en appliquant le foncteur sections globales $\Gamma(X,.)$ à la suite exacte \ref{eq:ESSupport}, on obtient la suite exacte courte ci-dessous:

\begin{center}
$0\rightarrow \Gamma_Z(X,\Ff)\rightarrow \Gamma(X,\Ff)\rightarrow \Gamma(U,\Ff)\rightarrow 0$, où $\Ff$ est flasque.
\end{center}

On choisit maintenant une résolution flasque $\Ii^.$ de $\Ff$, alors $\Ii^._{|U}$ est flasque également. On peut donc utiliser ces résolutions pour calculer les groupes de cohomologie $H_Z^i(X,\Ff)$, $H^i(X,\Ff)$ et $H^i(U,\Ff_{|U})$. En utilisant la suite exacte courte ci-dessus on obtient une suite exacte courte de complexes de groupes abéliens:

\begin{center}
$0\rightarrow \Gamma_Z(X,\Ii^.)\rightarrow \Gamma(X,\Ii^.)\rightarrow \Gamma(U,\Ii^.)\rightarrow 0$
\end{center}

Les techniques utilisées pour obtenir la suite exacte longue \ref{eq:longSES} s'appliquent dans la catégorie des groupes abéliens et on obtient ainsi une suite exacte longue:
\begin{equation}\label{eq:longSESSupport}
0\rightarrow H_Z^0(X,\Ff)\rightarrow H^0(X,\Ff)\rightarrow H^0(U,\Ff_{|U})\rightarrow  H_Z^1(X,\Ff)\rightarrow H^1(X,\Ff)\rightarrow H^1(U,\Ff_{|U})\rightarrow ...
\end{equation}


Remarquons enfin qu'avec les notations et hypothèses de l'exemple \ref{cohomsupportaffineex}, on a $\Gamma_Z(X, .)\circ\, \widetilde{}=\Gamma_\mathfrak{a}(.)$ en tant que foncteurs $A$-$\Mm od\rightarrow A$-$\Mm od$. On en déduit que le foncteur $\Gamma_\mathfrak{a}(.)$ est exact à gauche et que ses foncteurs dérivés à droite, notés $H_\mathfrak{a}^i$, sont égaux aux foncteurs $H_Z^i(X,.)\circ \widetilde{}$ . En effet, soit $\Ff \in \Aa b(X)$ et $M:=\Gamma(X,\Ff)$, le tilde envoie une résolution injective de $M$ sur une résolution flasque de $\Ff\simeq \widetilde{M}$, comme on va le voir en \ref{cohomAffProp1}. En utilisant cette dernière pour calculer les groupes de cohomologie de $\Ff$ à support dans $Z$, on obtient le résultat par l'égalité des foncteurs $\Gamma_Z(X, .)\circ\, \widetilde{}=\Gamma_\mathfrak{a}(.)$.

\subsubsection{Cohomologie sur un schéma affine}

L'objectif de cette partie est de montrer que les $\Oo_X$-module quasi-cohérents sur un schéma affine noetherien $X=\spec A$ sont acycliques. Le point clé sera de montrer que pour un $A$-module injectif $I$, le faisceau $\widetilde{I}$ est flasque. On commence par des préliminaires d'algèbre commutative:

\begin{thm}[de Krull]
Soit $A$ un anneau noetherien, $M\subset N$ des $A$-modules de type fini, et $\mathfrak{a}$ un idéal de $A$. Alors, la topologie $\mathfrak{a}$-adique sur $M$ est induite par la topologie $\mathfrak{a}$-adic sur $N$. En particulier, pour tout $n>0$, il existe $n'\geq n$ tel que $\mathfrak{a}^{n'}N\cap M\subset\mathfrak{a}^nM$.
\end{thm}
\begin{proof}
\cite[10.11]{atiyahmacdo}
\end{proof}

\begin{cor}\label{cohomAffLemme1}
Soient $A$ un anneau noetherien, $\mathfrak{a}$ un idéal de $A$, et $I$ un $A$-module injectif. Alors le sous-module $\Gamma_\mathfrak{a}(I)$ est aussi un $A$-module injectif.
\end{cor}
\begin{proof}
\cite[III.3.2]{Hartshorne} 
\end{proof}

\begin{lem}
Soient $A$ un anneau noetherien et $I$ un $A$-module injectif. Alors pour tout $f\in A$, la flèche de localisation $I\rightarrow I_f$ est surjective.
\end{lem}
\begin{proof}
\cite[III.3.3]{Hartshorne} 
\end{proof}

\begin{prop}\label{cohomAffProp1}
Soient $A$ un anneau noetherien et $I$ un $A$-module injectif. Alors le faisceau $\widetilde{I}$ est flasque.
\end{prop}
\begin{proof}
On utilise que $X$ est un espace topologique noetherien, et on considère les fermés de la forme $Y:=\overline{\supp \widetilde{I}}$, où $I$ est un $A$-module injectif. On remarque que le résultat est immédiatement vérifié si $Y$ est l'ensemble vide. Il suffit donc de montrer qu'étant donné un fermé $Y$ de la forme $\overline{\supp \widetilde{I}}$ on est ramené à montrer le résultat pour un fermé propre de $Y$ de même forme.

Pour montrer que $\widetilde{I}$ est flasque, il est suffisant de montrer que $\Gamma(X,\widetilde{I})\rightarrow\Gamma(U,\widetilde{I})$ est surjectif pour tout ouvert $U\subset X$. Si $Y\cap U=\emptyset$ il n'y a rien à montrer. Sinon, il existe $f\in A$ tel que $X_f\subset U$ et $X_f\cap Y\neq \emptyset$. On note $Z= X\setminus X_f$, et on Considère le diagramme commutatif:

	\begin{center}
	\begin{tikzcd}
  		\Gamma(X,\widetilde{I}) \arrow[r, ""] & \Gamma(U,\widetilde{I}) \arrow[r, ""] & \Gamma(X_f,\widetilde{I})\\ 
  		\Gamma_Z(X,\widetilde{I}) \arrow[u, hook, ""] \arrow[r, ""] & \Gamma_Z(U,\widetilde{I}) \arrow[u, hook, ""] &
	\end{tikzcd}\\
	\end{center}
Soit une section $s\in\Gamma(U,\widetilde{I})$, et $s'$ son image dans $\Gamma(X_f,\widetilde{I})$. D'après le lemme précédent et \ref{FQCProp2}, $s'$ admet un antécédent $t\in \Gamma(X,\widetilde{I})$. On note $t'$ la restriction de $t$ à $U$. Alors $s-t'$ se restreint en la section nulle sur $X_f$, et a donc support dans $Z$. Si on peut trouver un antécédent $u$ de $s-t'$ dans $\Gamma_Z(X,\widetilde{I})$, alors $t+u$ est antécédent de $s$ dans $\Gamma(X,\widetilde{I})$. On est donc ramenés à prouver la surjectivité de $\Gamma_Z(X,\widetilde{I})\rightarrow\Gamma_Z(U,\widetilde{I})$.

Posons $J=\Gamma_Z(X,\widetilde{I})$, et $\mathfrak{a}=fA$. Alors d'après l'exemple \ref{cohomsupportaffineex}, on a $J=\Gamma_\mathfrak{a}(I)$. Puis d'après \ref{cohomAffLemme1}, $J$ est un $A$-module injectif. Enfin, le support de $\widetilde{J}$ est contenu dans $Y\cap Z$ qui est fermé propre de $Y$.  Toujours d'après l'exemple \ref{cohomsupportaffineex}, on a $\widetilde{J} = \Hh ^0 _Z(\Ff)$. On est donc ramené à montrer que $\widetilde{J}$ est flasque, ce qui termine la preuve.
\end{proof}


\begin{thm}\label{cohomoaffine}
Soit $X=\spec A$ un schéma affine noetherien. Alors pour tout faisceau quasi-cohérent $\Ff$ sur $X$, et pour tout $i>0$, on a $H^i(X,\Ff)=0$. 
\end{thm}
\begin{proof}
Soit $M=\Gamma(X,\Ff)$, et $M\rightarrow I^.$ une résolution injective de $M$. On obtient d'après \ref{FQCThm} une résolution injective $\Ff\simeq \widetilde{M}\rightarrow \widetilde{I}^.$ de $\Ff$ dans la catégorie des $\Oo_X$-modules quasi-cohérents. Or cette résolution est flasque d'après \ref{cohomAffProp1}. Cela suffit à montrer le théorème car une résolution flasque de faisceau est acyclique, et peut être utiliser pour calculer la cohomologie.
\end{proof}

\subsubsection{Une application}

On introduit la notion de profondeur d'un $A$-module $M$ relative à un idéal $\mathfrak{a}\subset A$ et on en donne une interprétation en termes de cohomologie à support. On en déduit un corollaire qui donne une réciproque à \ref{extregularnormal} et nous sera utile par la suite.

\begin{defn}[Élément $M$-régulier]
Un élément $x\in A$ est $M$-régulier si la multiplication par $x$ est un endomorphisme injectif de $M$, c'est à dire que $x$ n'est pas diviseur de zéro d'un élément de $M$. Si $x$ n'est pas régulier on dit que c'est un diviseur de zéro de $M$.
\end{defn}

\begin{defn}[Suite $M$-régulière]
Soit $A$ un anneau, $M$ un $A$-module. Une suite $x_1,...,x_r$ d'éléments de $A$ est $M$-régulière si $x_1$ est $M$-régulier, et pour tout $i=2,...,r$, $x_i$ est $M/(x_1,...,x_{i-1})M$-régulier.
\end{defn}

\begin{defn}[Profondeur]
Soit $A$ un anneau, $M$ un $A$-module et $\mathfrak{a}\subset A$ un idéal. La $\mathfrak{a}$-profondeur de $M$, notée $\depth_\mathfrak{a} M$, est la longueur maximale des suites régulières de $M$ contenues dans $\mathfrak{a}$.
\end{defn}

\begin{prop}
Soit $A$ un anneau noetherien, $\mathfrak{a}$ un idéal, et $M$ un $A$-module de type fini. Alors pour tout $n\geq 0$, les conditions suivantes sont équivalentes:
\begin{enumerate}
\item $\depth_\mathfrak{a} M\geq n$.
\item $H_\mathfrak{a}^i(M)=0$ pour tout $i<n$.
\end{enumerate}
\end{prop}
\begin{proof}
Montrons cette équivalence par récurrence. Le cas $n=0$ est trivial, mais nous aurons besoin du cas $n=1$ dans la récurrence, on le démontre maintenant. Supposons $n=1$, et $\depth_\mathfrak{a} M\geq 1$. Alors il existe $x\in\mathfrak{a}$ tel que $x$ n'est pas diviseur de zéro de $M$. Soit $m\in \Gamma_ \mathfrak{a}(M)$, ainsi il existe $k\geq 0$ tel que $\mathfrak{a}^k m=0$. En particulier, $x^km=0$, ce qui prouve $m=0$, puis $H^0_\mathfrak{a}(M)=0$. Réciproquement, supposons $H^0_\mathfrak{a}(M)=0$. Cela signifie que pour tout $m\in M$ et $k\geq 0$, il existe $x\in \mathfrak{a}^k$ tel que $mx\neq 0$. Ainsi, d'après \ref{AssociatedPrimesProp2} on peut trouver un $x\in \mathfrak{a}$ qui n'est pas diviseur de zéro de $M$, c'est à dire $\depth_\mathfrak{a}M\geq 1$.

Supposons maintenant le résultat acquis pour $n\geq 1$. Pour le sens direct on suppose $\depth_\mathfrak{a} M\geq n+1$. Compte tenu de l'hypothèse de récurrence il reste à montrer que $H^n_\mathfrak{a}(M)=0$. Choisissons $x\in \mathfrak{a}$ égal au premier terme d'une suite $M$-régulière de longueur $n+1$, ce qui est possible par hypothèse. Alors $x$ n'est pas diviseur de zéro de $M$ et $\depth_\mathfrak{a} M/xM \geq n$. On considère alors la suite exacte de $A$-modules
$$0\rightarrow M \xrightarrow{x.} M\rightarrow M/xM\rightarrow 0$$

\noindent et la suite exacte longue de cohomologie associée:

$$..\rightarrow H^{n-1}_\mathfrak{a}(M/xM) \rightarrow H^n_\mathfrak{a}(M) \xrightarrow{x.}  H^n_\mathfrak{a}(M) \rightarrow ...$$

\noindent Comme $H^{n-1}_\mathfrak{a}(M/xM)=0$ par hypothèse de récurrence, l'application $H^n_\mathfrak{a}(M) \rightarrow  H^n_\mathfrak{a}(M)$ est injective. Or ceci ne peut être le cas que si $H^n_\mathfrak{a}(M)=0$ car on peut remarquer que $H^n_\mathfrak{a}$ est un quotient d'un $\Gamma_\mathfrak{a}(N)$ pour un module $N$, ses éléments sont donc annulés par des puissances de $x$. 

Montrons maintenant la réciproque. On suppose $H^i_\mathfrak{a}(M)=0$ pour tout $i<n+1$. Par hypothèse de récurrence et comme $n\geq 1$, il existe $x\in \mathfrak{a}$ qui n'est pas diviseur de zéro pour $M$. On peut à nouveau utiliser la suite exacte longue ci-dessus et en déduire immédiatement que $H^{i}_\mathfrak{a}(M/xM)=0$ pour $i<n$. Ainsi, $\depth_\mathfrak{a} M/xM\geq n$, ce qui montre $\depth_\mathfrak{a} M \geq n+1$.
\end{proof}

\begin{cor}\label{cohomcodimgeq2}
Soit $X$ une variété affine irréductible et $Z\subset X$ un fermé tel que la restriction $\Oo(X)\rightarrow \Oo(X\setminus Z)$ soit un isomorphisme. Alors $Z$ est de codimension au moins $2$ dans $X$.
\end{cor}
\begin{proof}
On pose $U:=X\setminus Z$ et on utilise la suite exacte longue \ref{eq:longSESSupport}. Compte tenu de l'hypothèse et de \ref{cohomoaffine} on obtient que $H^0_Z(X,\Oo_X)=H^1_Z(X,\Oo_X)=0$. D'après la propriété précédente cela donne $\depth_\mathfrak{a}(\Oo(X))\geq 2$, où $\mathfrak{a}:=\Ii(Z)$. Mais d'après, \ref{dimsousvariete} on obtient facilement $\codime_X(Z)\geq \depth_\mathfrak{a}(\Oo(X))$.
\end{proof}


\subsection{Faisceaux inversibles, Fibrés en droites}
\begin{defn}[Faisceau inversible]
Un faisceau inversible $\Ll$ sur un schéma $X$ est un $\mathcal{O}_X$-module localement libre de rang 1. Autrement dit, tout point $x\in X$ admet un voisinage ouvert $U \subset X$ tel que ${\mathcal L}|_U$ est isomorphe à ${\mathcal O}_U$.
\end{defn}

On peut toujours trivialiser deux faisceaux inversibles sur un même recouvrement ouvert de $X$. On voit ainsi que le produit tensoriel sur $\mathcal{O}_X$ de faisceaux inversibles est inversible. Par ailleurs, le faisceau dual $\Ll^\vee:=\Hh om(\Ll,\Oo_X)$ est clairement inversible car sur les ouverts $U$ où $\Ll$ est trivial, se donner un morphisme $\Ll_{|U}\rightarrow\Oo_{|U}$ revient à se donner une section de $\Oo(U)$. De plus, l'application naturelle $\Ll\otimes_{\Oo_X} \Hh om(\Ll,\Oo_X)\rightarrow \Oo_X, (s,f)\mapsto f(s)$ est un isomorphisme. Ainsi, les classes d'isomorphie de faisceaux inversible sur $X$ munies du produit tensoriel forment un groupe appelé groupe de Picard de $X$, noté $\pic(X)$. 

\begin{ex}\label{expicaff}
Soit $X=\spec (A)$ un schéma affine irréductible. Alors se donner un faisceau inversible sur $X$ revient (à isomorphisme près) à se donner un idéal fractionnaire $I$ de $A$ qui est inversible (cf \ref{ideauxinversibles}), son inverse est alors $I^{-1}:=(A:I)$. Les idéaux fractionnaires inversibles donnant le faisceau inversible trivial sont les idéaux fractionnaires principaux. Le groupe de Picard de $X$ est ainsi isomorphe au groupe des idéaux fractionnaires inversibles modulo les idéaux fractionnaires principaux. Les idéaux de $A$ qui sont inversibles forment une partie génératrice de ce groupe. 

Si de plus $A$ est localement factoriel, par exemple si $X$ est lisse, les idéaux inversibles sont les idéaux de hauteur 1 pure, c'est à dire tels que leurs idéaux premiers associés sont tous de hauteur 1. De plus tout idéal inversible s'écrit de manière unique comme produit de puissances d'idéaux premiers de hauteur 1. Ainsi $\pic(X)$ est donc le quotient du groupe libre sur les idéaux premiers de hauteur 1 par les idéaux fractionnaires principaux.
\end{ex}

On va maintenant voir qu'un faisceau inversible sur une variété $X$ s'incarnent naturellement en une variété sur $X$, que l'on appelle un fibré en droites.

\begin{defn}[Fibré en droites, morphismes, faisceau des sections]\label{linebundle}
Soit $X$ une variété. Un fibré en droite sur $X$ est une variété $L$ munie d'un morphisme $\pi:L\rightarrow X$ tel que $X$ admet un recouvrement ouvert $(U_i)_{i\in I}$ satisfaisant:

\begin{enumerate}
\item $\forall i\in I$, il existe un isomorphisme $\phi_i :\pi^{-1}(U_i)\rightarrow U_i\times\AAA^1`-k$ de variétés sur $U_i$.
\item $\forall i, j\in I$, l'isomorphisme $\phi_j\circ \phi_i^{-1}: (U_i\cap U_j)\times \AAA^1_k\rightarrow (U_i\cap U_j)\times \AAA^1_k$ est de la forme $(x, z)\mapsto (x, a_{ij}(x)z)$.
\end{enumerate}
Un morphisme de fibrés en droites sur $X$ est un morphisme de variétés sur $X$ avec la conditions supplémentaire que les morphismes induits sur les fibres soient linéaires.
Une section d'un fibré en droites $(L, \pi)$ est une section de $\pi$, et on a la version locale de cette notion.
\end{defn}

On constate qu'un fibré en droite $(L,\pi)$ sur $X$ est obtenu en recollant des fibrés en droites de la forme $U_i\times \AAA^1\rightarrow U_i$ appelés fibrés triviaux via des automorphismes linéaires sur les intersections définis par des fonctions $a_{ij}\in \Oo(U_i\cap U_j)^*$, dites de transition. De plus, un automorphisme de fibré en droites est donné par une fonction $f\in \Oo(X)^*$. En effet, localement il s'agit d'automorphismes de fibrés triviaux qui sont nécessairement de cette forme.

Considérons un faisceau inversible $\Ll$ sur $X$ trivialisé sur un recouvrement affine $(U_i)_{i\in I}$ avec un générateur $s_i\in\Ll(U_i)$ sur chaque $U_i$. Sur $U_i\cap U_j$, on a $s_j=a_{ij}s_i$ avec $a_{ij} \in \mathcal{O}_X(U_i\cap U_j)^\times$. On considère au dessus de chaque $U_i$ le fibré trivial $(U_i\times\AAA^1, \pi_i)$, et on les recolle avec des isomorphismes définis par $\mathcal{O}_X(U_i\cap U_j)\otimes_k k[t]\rightarrow \mathcal{O}_X(U_i\cap U_j)\otimes k[u]$, $f\otimes_k 1\mapsto f\otimes_k 1$, $1 \otimes_k t \mapsto a_{ij}\otimes_k u$. On a ainsi construit un fibré en droites sur $X$.

Réciproquement, considérons le $\mathcal{O}_X$-module des sections d'un fibré en droite $L$ sur $X$. Sur les ouverts $U_i$ où $L$ est trivialisé on voit que les sections forment un faisceau isomorphe à $\mathcal{O}_{X|U_i}$. En effet se donner une section sur $U_i$ revient à se donner un morphisme $U_i\rightarrow \AAA^1$, c'est à dire un élément de $\mathcal{O}_X(U_i)$. C'est donc un faisceau inversible. Les sections globales de $L$ s'identifie via les trivialisations locales aux familles $(f_i)_{i\in I}$ telles que $f_i=a_{ij}f_j$ sur $U_i\cap U_j$. En effet, un telle section donne sur les intersections $U_i\cap U_j$ un diagramme commutatif:

	\begin{center}
	\begin{tikzcd}
  		U_i\cap U_j\times \AAA^1 \arrow[rr, "\id\times m_{a_{ij}}"] & & U_i\cap U_j\times \AAA^1 \arrow[ld, ""] \\ 
  		& U_i\cap U_j \arrow[ul, "\id\times f_i"] \arrow[ur, swap, "\id\times f_j"] &
	\end{tikzcd}
	$\,\,\,\,\,\,\,\,\,$ où $m_{a_{ij}}$ est la multiplication par $a_{ij}$ 
	\end{center}

En composant les deux opérations on trouve le faisceau inversible dual du faisceau de départ, car les sections de $L$ s'identifient naturellement à des éléments de $\Hh om(\Ll,\Oo_X)$, et on a particulier $\Gamma(X,L)=\Gamma(X,\Ll^\vee)$. Ces opérations sont fonctorielles et réalisent une anti-équivalence de catégorie entre la sous-catégorie des faisceaux inversibles sur $X$ et la catégorie des fibrés en droites sur $X$. Cela permet de transporter la structure du groupe de Picard sur les classes d'isomorphie de fibrés en droites. En particulier, on définit le fibré dual $L^{^-1}$ de $L$ comme le fibré en droites construit à partir de $\Ll^\vee$. Il est défini par les fonctions de transition $a_{ij}^{-1}$.

\begin{rem}
Si on se donne un faisceau inversible $\Ll$ sur une variété $X$, le fibré en droites qu'on lui associe dans la discussion précédente n'est autre que $\spec_X(\sym(\Ll))$, où $\sym(\Ll))$ est l'algèbre symétrique associée à $\Ll$ sur $\mathcal{O}_X$. En effet, on recolle les $\spec_{U_i}(\sym(\Ll)_{|U_i}))\simeq\spec_{U_i}( \mathcal{O}_{U_i}[t])\simeq U_i \times_k \AAA^1_k$, où $(U_i)_i$ est un recouvrement qui trivialise $\Ll$.
\end{rem}

Soit $(L,\pi)$ un fibré en droite sur $X$, et $f:X'\rightarrow X$ un morphisme de variétés. L'image inverse de $f^*(L)$ est le produit fibré $X'\times_X L$ muni de sa projection vers $X'$. C'est un fibré en droites sur $X'$, en effet c'est un recollement des fibrés triviaux $f^{-1}(U_i)\times \AAA^1\rightarrow f^{-1}(U_i)$ via les fonctions de transition $f^\sharp(a_{ij})$. Si on a $L=\spec_X(\sym(\Ll))$ pour un faisceau inversible $\Ll$, on constate que $f^*(L)$ est le fibré en droites construit à partir du faisceau inversible $f^*(\Ll)$. Enfin, si on se donne un morphisme $\phi:(L_1,\pi_1)\rightarrow (L_2,\pi_2)$ de fibrés en droites sur $X$ et un morphisme de variétés $f:X'\rightarrow X$ on définit l'image inverse $f^*(\phi)$ comme l'unique morphisme faisant commuter le diagramme ci-dessous:

	\begin{center}
	\begin{tikzcd}
  		f^*(L_1)=X'\times_X L_1 \arrow[r, ""] \arrow[rd, dashed, "f^*(\phi)"] \arrow[rdd, bend right, ""] & L_1 \arrow[rd, bend left, "\phi"] &\\ 
  		& f^*(L_2)=X'\times_X L_2 \arrow[r, ""]  \arrow[d, ""] & L_2 \arrow[d, "\pi_2"] \\ 
		& X' \arrow[r, "f"] & X
	\end{tikzcd}
	\end{center}

\begin{rem}\label{remfibsectionsglobales}
Notons qu'un fibré en droites $(L, \pi)$ est muni d'une action de $\GG_m$, c'est l'action de multiplication par les scalaires dans les fibres. L'ensemble $L_0$ des points fixes sous $\GG_m$ est le fermé correspondant à l'image de la section nulle. Son complémentaire $L^\times:=L\setminus L_0$ est une $\GG_m$-variété et $\pi$ se restreint en $\pi^\times: L^\times \rightarrow X$ qui est un quotient géométrique. En effet sur les $U_i$, on a $\pi^{\times-1}(U_i) \simeq U_i\times_k \GG_m$ et l'action de $\GG_m$ se fait par multiplication sur le facteur de droite. Cette action sur $L$  se traduit par une graduation du faisceau d'algèbres $\pi_*\Oo_L=\sym\Ll=\oplus_{n\geq 0}\Ll^{\otimes n}$ sur $X$. Le sous-espace de poids $1$ de $\Oo(L)=\pi_*\Oo_L(X)$ s'identifie alors à $\Gamma(X,L^{-1})$.
\end{rem}

\subsection{$G$-fibré principal}

\noindent On se fixe un groupe algébrique $G$.

\begin{defn}[$G$-fibré principal]\label{GPrincipalBundleDef}
Soit $X$ une $G$-variété, et $\pi:X\rightarrow Y$ un morphisme $G$-invariant. On dit que $(X,\pi)$ est un $G$-fibré principal sur $Y$ si
\begin{enumerate}
\item $\pi$ est plat et surjectif.
\item Le morphisme $\Gamma:G\times X\rightarrow X\times_Y X$, $(g,x)\mapsto (x,g.x)$ est un isomorphisme.
\end{enumerate}
\end{defn}

\begin{ex}
\begin{enumerate}
\item La variété $G\times Y$ munie de sa deuxième projection, ou toute $G$-variété localement de cette forme.
\item Un fibré en droites est un $\GG_m$-fibré principal. On peut montrer une "réciproque" (voir \cite[3.1.3]{LinearizationGBrion}).
\end{enumerate}
\end{ex}

\subsection{$G$-linearisation d'un fibré en droites}

Dans cette section on s'interroge sur la possibilité d'étendre une action d'un groupe algébrique $G$ sur une variété $X$ à un fibré en droite $(L,\pi)$ sur $X$ tout en préservant la structure du fibré. C'est la notion de $G$-linéarisation. 

\begin{defn}[$G$-linéarisation]
Soit $G$ un groupe algébrique, $X$ une $G$-variété, et $(L,\pi)$ un fibré en droites. Une $G$-linéarisation de  $(L,\pi)$ est une action de $G$ sur $L$ telle que $\pi$ est $G$-équivariante et pour tout $(g,x)\in G\times X$ l'application $L_x\rightarrow L_{g.x},\, l\mapsto g.l$ est linéaire.
\end{defn}

Une action $G$-linéarisée définit donc un morphisme $G\rightarrow \Aut L$ à valeurs dans le groupe d'automorphisme de fibrés en droites de $(L,\pi)$. On note $\alpha: G\times X\rightarrow X$ l'action de $G$ sur $X$ et $p_2:G\times X\rightarrow X$ la projection sur $X$. Pour tout $g\in G$ on a une application:
$$g\times \id: X\rightarrow G\times X,\,\, x\mapsto (g,x)$$ 
Les images inverses des deux fibrés $\alpha^*(L)$ et $p_2^*(L)$ par cette application sont explicitement: 
$$(g\times \id)^*\alpha^*(L)=X\times_{G\times X}((G\times X)\times_X L)=\lbrace (x,(g',x'),l)\mid \alpha(g',x')=\pi(l)\text{ et } (g,x)=(g',x')\rbrace$$
$$(g\times \id)^*p_2^*(L)=X\times_{G\times X}((G\times X)\times_X L)=\lbrace (x,(g',x'),l)\mid x'=\pi(l)\text{ et } (g,x)=(g',x')\rbrace$$
On obtient ainsi des isomorphismes canoniques $(g\times \id)^*\alpha^*(L)\simeq g^*L$ et $(g\times \id)^*p_2^*(L)\simeq L$, où $g^*L$ est l'image inverse de $L$ par l'automorphisme de $X$ associé à l'action de $g$, et on fait ces identifications par la suite. Ainsi, vu la discussion suivant \ref{linebundle}, tout morphisme de fibrés en droites $\Phi: \alpha^*(L)\rightarrow p_2^*(L)$ induit pour tout $g\in G$ un morphisme $\Phi_g:g^*(L)\rightarrow L$.

\begin{lem}\label{CritereExistenceGLin}
Avec les notations ci-dessus, on a une correspondance bijective entre les $G$-linéarisations de $L$ et les isomorphismes
$$\Phi: \alpha^*(L)\rightarrow p_2^*(L)$$
de fibrés en droites sur $G\times X$ tels que $\Phi_{gh}=\Phi_h\circ h^*(\Phi_g)$ pour tous $g,h\in G$.
\end{lem}
\begin{proof}
Soit $\beta:G\times L\rightarrow L$ une $G$-linéarisation. Par définition, on a un diagramme commutatif:
	\begin{center}
	\begin{tikzcd}
  		G\times L \arrow[r, "\beta"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}\\
	\end{center}
Par la propriété universelle du produit fibré on a donc un morphisme $\gamma:G\times L\rightarrow\alpha^*(L)$ de variétés sur $G\times X$. On remarque que l'on a un isomorphisme canonique $G\times L\rightarrow p_2^*(L),\, (g,l)\mapsto ((g,\pi (l)),l)$. Avec cette identification, $\gamma$ s'écrit explicitement $\gamma(g,l)=((g,\pi(l)),\beta(g,l))$. C'est un isomorphisme car on a un inverse évident $\Phi((g,x),l)=(g,\beta(g^{-1},l))$. Pour $g\in G$ fixé, l'image inverse de $\gamma$ par $g\times \id$ est simplement $\gamma_g:L\rightarrow g^*L, l\mapsto (\pi(l),\beta(g,l))$. Soit maintenant $h\in G$, et on note également $h$ l'automorphisme de $X$ donné par son action. En tenant compte des identifications précédentes on a pour $l\in L$ les formules $h^*(\gamma_g)\circ\gamma_h(l)=h^*(\gamma_g)(\pi(l),\beta(h,l))=(\pi(l),\beta(g,\beta(h,l)))=(\pi(l),\beta(gh,l))=\gamma_{gh}(l)$. Ainsi, $\Phi$ satisfait la condition de l'énoncé.

Réciproquement, étant donné un $\Phi$ comme dans l'énoncé, on note $\gamma:=\Phi^{-1}$ et $p_L:\alpha^*(L)\rightarrow L$ la projection sur $L$. On a alors un morphisme $\beta:=p_L\circ\gamma : G\times L \rightarrow L$. La condition sur $\Phi$ exprime qu'il s'agit d'une action de $G$  sur $L$. Enfin, pour $g\in G$ fixé, $p_L\circ \gamma_g$ est un automorphisme de $(L,\pi)$, autrement dit on obtient un diagramme commutatif comme ci-dessus. On a donc bien une $G$-linéarisation.
\end{proof}

\begin{lem}\label{existenceGLin}
Soient $G$ un groupe algébrique connexe, $X$ une $G$-variété irréductible, et $(L,\pi)$ un fibré en droites sur $X$. Alors $L$ admet une $G$-linéarisation si et seulement si $\alpha^*(L)$ et $p_2^*(L)$ sont isomorphes en tant que fibrés en droites sur $G\times X$.
\end{lem}
\begin{proof}
L'implication directe est contenue dans le lemme précédent. Pour la réciproque, on considère un isomorphisme $\Phi:\alpha^*(L)\rightarrow p_2^*(L)$ de fibrés en droites sur $G\times X$. Comme $\alpha(e,x)=x$ pour tout $x\in X$, on a une identification canonique $(e\times \id)^*\alpha^*(L)\simeq L$, d'où un automorphisme $(e\times \id)^*(\Phi):L\rightarrow L$ de fibré en droites. Cet automorphisme est donné d'après \ref{linebundle} par une fonction $f\in \Oo(X)^*$. En remplaçant $\Phi$ par $\Phi\circ p_2^\sharp(f^{-1})$, on peut supposer $f=1$. On obtient ainsi un morphisme  $\beta: G\times L \rightarrow L$ qui satisfait le diagramme commutatif suivant:
	\begin{center}
	\begin{tikzcd}
  		G\times L \arrow[r, "\beta"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}\\
	\end{center}
De plus, on a modifié $\Phi$ de telle manière que l'on ait $\forall l\in L,\,\beta(e,l)=l$. Il reste maintenant à prouver que la condition d'associativité d'une action de groupe est satisfaite. On note $\beta_1:G\times G\times X\rightarrow X, (g,h,x)\mapsto \beta(g,\beta(h, x))$, $\beta_2:G\times G\times X\rightarrow X, (g,h,x)\mapsto \beta(gh, x)$, et par abus on note encore $\alpha:G\times G\times X\rightarrow X, (g,h,x)\mapsto \alpha(gh, x)$. On obtient deux diagrammes commutatifs:
	\begin{center}
	\begin{tikzcd}
  		G\times G\times L \arrow[r, "\beta_1"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}
	\,\,\,\,\,\,\,\,\,\,\,\,
	\begin{tikzcd}
  		G\times G\times L \arrow[r, "\beta_2"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}
	\end{center}
	On obtient ainsi deux isomorphismes $\gamma_1:G\times G\times L\rightarrow\alpha^*(L), (g,h,l)\mapsto ((g,h,\pi(l)), \beta_1(g,h,l))$ et $\gamma_2:G\times G\times L\rightarrow\alpha^*(L), (g,h,l)\mapsto ((g,h,\pi(l)), \beta_2(g,h,l))$. La condition d'associativité correspond à $\gamma_1\gamma_2^{-1}=\id$. Or $\gamma_1\gamma_2^{-1}$ est un automorphisme du fibré en droite $(G\times G\times L,\id\times \pi)$, donc correspond à une fonction $\phi\in \Oo(G\times G\times X)^*$. D'après \ref{rosenlicht1}, il existe $\chi\in X^*(G\times G)$ et $\psi\in\Oo(X)^*$ tels que $\phi(g,h,x)=\chi(g,h)\psi(x)$ pour tout $g,h\in G$ et $x\in X$. En évaluant en $g=h=e$ on obtient $\psi=1$, puis comme $\phi(g,e,x)=1=\phi(e,g,x)$ pour tout $g\in G$ et $x\in X$, on obtient $\chi(g,e)=\chi(e,g)$ pour tout $g\in G$. Comme l'application naturelle $X^*(G)\times X^*(G)\rightarrow X^*(G\times G)$ est un isomorphisme, on conclut que $\chi=1$ et donc $\phi=1$, ce qui termine la preuve.
\end{proof}

\begin{prop}\label{GmoduleSectionsGlobalesGlin}
Soit $X$ une $G$-variété et $L$ un fibré en droite $G$-linéarisé sur $X$. Alors le $k$-espace vectoriel des sections globales $\Gamma(X, L)$ a une structure naturelle de $G$-module.
\end{prop}
\begin{proof}
$L^{-1}$ admet aussi une $G$-linéarisation d'après \ref{CritereExistenceGLin} et le fait que l'image inverse d'un fibré en droite commute à la prise de son dual. $L^{-1}$ est en fait une $G\times \GG_m$-variété où l'action de $\GG_m$ est l'action naturelle sur les fibres par multiplication. D'après \ref{GmoduleSectionsGlobales}, $\Oo(L^{-1})$ est un $G\times \GG_m$-module, donc en particulier un $\GG_m$-module. Le sous-espace de poids $1$ pour l'action de $\GG_m$ de ce module est $\Gamma(X, L)$ d'après \ref{remfibsectionsglobales}. Il est facile de vérifier que ce sous-espace est stable par l'action de $G$, ce qui en fait un $G$-module.
\end{proof}

\section{Diviseurs}

\subsection{Diviseurs de Weil}

En se rappelant le résultat \ref{extregularnormal}, on voit que la "géométrie en codimension 1" d'une variété normale irréductible, c'est à dire le comportement des fonctions sur les fermés irréductibles de codimension 1, contient beaucoup d'information sur la variété. Ces fermés sont appelés des diviseurs premiers, on va voir qu'ils permettent de définir un invariant particulièrement intéressant de la variété, et fondamental pour la construction de l'anneau de Cox, c'est le groupe des classes. Notre cadre est celui d'une variété normale que l'on supposera de plus irréductible pour plus de simplicité, suivant la remarque \ref{normaluniondisjointe}.

\begin{defn}[Diviseur premier, diviseur de Weil, diviseur effectif]
Soit $X$ une variété normale irréductible. Un diviseur premier $D$ est une sous-variété fermée irréductible de codimension 1. On définit $\wdiv(X)$ le groupe abélien libre engendré par les diviseurs premiers. Un élément de $\wdiv(X)$ est appelé un diviseur de Weil. Enfin, un diviseur est dit effectif si il est à coefficients $\geq 0$. 
\end{defn}
On introduit maintenant pour chaque diviseur premier $D$ une valuation sur $k(X)$ donnant des informations sur le comportement des fonctions rationnelles en $D$. C'est l'analogue de l'ordre d'un zéro ou d'un pôle d'une fonction rationnelle de la droite affine en un point. Soit $\eta$ le point générique de $D$, et $\mathcal{O}_{\eta,X}$ son anneau local. Par hypothèse et grâce aux propriétés de la localisation, il est noethérien normal et de dimension 1, c'est donc un anneau de valuation discrète (\ref{DVRCarac}). La valuation associée $v_D:k(X)\rightarrow \ZZ$ donne par définition l'ordre d'annulation d'une fonction rationnelle le long de $D$. La propriété ci-dessous montre que les fonctions rationnelles permettent de définir des diviseurs de Weil.

\begin{prop}\label{noetherienPWDivBienDef}
Soit $X$ une variété normale et irréductible et $f\in k(X)^*$. Alors $v_D(f)=0$ sauf pour un nombre fini de diviseurs premiers $D$.
\end{prop}
\begin{proof}
Soit $f=g/h\in k(X)^*$, où l'on peut supposer $X=\spec A$ affine. Comme $v_D(f)=v_D(g)-v_D(h)$, on peut supposer $f\in A$, et non-inversible. Soit $D$ un diviseur premier et $\mathfrak{p}$ son point générique. Si $f\in A_\mathfrak{p}^*$ alors $v_D(f)=0$. Sinon, $f\in \mathfrak{p}$ et donc $D \subset \mathcal{V}_X(f)$. Or, d'après \ref{factonormal} et \ref{AssociatedPrimesProp1}, les éléments minimaux du support de $A/(f)$ sont en bijection avec les idéaux premiers associés à $(f)$, qui sont tous de hauteur $1$. On en déduit que les composantes irréductibles $Z_i$ de $\mathcal{V}_X(f)$ qui leur correspondent sont des diviseurs premiers, en nombre fini. Ainsi $v_D(f)=0$ à moins que $D$ ne soit l'un des $Z_i$.
\end{proof}

Ainsi l'application $k(X)^*\rightarrow \wdiv(X),\, f\mapsto $ div$(f):=\sum_D v_D(f)D$ définit un morphisme de groupes. Son image est le \textit{groupe des diviseurs principaux} noté PDiv$(X)$. La relation modulo PDiv$(X)$ s'appelle \textit{l'équivalence linéaire}, et le groupe quotient $\clg(X)$ est le \textit{groupe des classes de diviseurs}. Le groupe des classes de diviseurs de $X$ est un invariant en général difficile à calculer. On liste ci-dessous quelques outils et exemples.


\begin{prop}\label{AffUFDClgTrifial}
Soit $X=\spec(A)$ une variété affine normale et irréductible. Alors $A$ est factoriel si et seulement si $\clg(X)=0$.
\end{prop}
\begin{proof}
C'est une conséquence de \ref{factonormal} et \ref{UFDPID}. Voir \cite{Hartshorne} II.6.2.
\end{proof}

\begin{cor}
$\clg(\mathbb{A} ^n_k)=0$ pour $n\geq 1$.
\end{cor}

\begin{thm}\label{divexactseq}
Soit $X$ une variété normale et irréductible et $Z$ une sous-variété fermée propre. On pose $U:=X\setminus Z$. Alors:
\begin{enumerate}
\item Le morphisme $\clg(X)\rightarrow\clg(U)$ défini par $\sum_i n_iD_i\mapsto \sum_i n_i(D_i\cap U)$, avec $D_i\cap U = 0$ si $D_i\cap U=\emptyset $, est un morphisme de groupe surjectif.
\item Si $\codime(Z,X)\geq 2$, alors $\clg(X)\rightarrow \clg(U)$ est un isomorphisme.
\item Soient $D_1,..., D_s$ les composantes irréductibles de $Z$ qui sont des diviseurs. Alors la suite ci-dessous exacte
\begin{center}
 $0\rightarrow\Oo(X)^*\rightarrow \Oo(X\setminus \cup_{i=1}^s D_i)^*\xrightarrow{\divi} \bigoplus_{i=1}^s \ZZ D_i \xrightarrow{\pi} \clg(X) \xrightarrow{.\cap U} \clg(U) \rightarrow 0 $
\end{center}

\end{enumerate}
\end{thm}
\begin{proof}
\begin{enumerate}
\item Si $D\cap U\neq \emptyset$ alors $\dim X=\dim U$ et $\dim D=\dim D\cap U$ car ce sont des ouverts de variétés irréductibles donc la dimension est préservée. Ainsi cela définit une application $\wdiv(X)\rightarrow \wdiv(U)$ qui est un morphisme par construction. De plus, comme un diviseur principal est envoyé sur un diviseur principal, on a bien le morphisme attendu. Il est surjectif car pour tout $D\in\wdiv(U)$ premier, on a $D=\overline{D}\cap U$.
\item Dans ce cas on ne peut avoir $D\subset Z$ cause de la dimension donc $D\cap U\neq \emptyset$. Ainsi, le noyau du morphisme $\wdiv(X)\rightarrow \wdiv(U)$ est exactement PDiv$(X)$ d'où l'isomorphisme.
\item Le noyau de $.\cap U$ est exactement l'ensemble des $\pi(D)$ où $D$ est un diviseur dont le support est contenu dans $X\setminus U=Z$. De plus ce morphisme est surjectif donc les deux dernières flèches sont exactes. La deuxième flèche est injective car $X$ est irréductible, et son image est bien l'ensemble des fonctions régulières et inversibles sur $U$ de diviseur nul. Cela montre l'exactitude des deux premières flèches. La troisième et la quatrième flèche sont exacts par définition.
\end{enumerate}
\end{proof}

\subsection{Faisceau d'algèbres divisorielles}

La proposition suivante montre que l'on peut caractériser les sections du faisceau structural d'une variété normale irréductible en terme de diviseurs.

\begin{prop}\label{caracfaisceaustructdiv}
Soit $X$ une variété normale et irréductible et $f\in k(X)^*$. Alors 
\begin{enumerate}
\item $\divi(f)\geq 0\iff f \in\Oo_X(X)$.
\item $\divi(f)= 0\iff f\in\Oo_X(X)^*$.
\end{enumerate}
\end{prop}
\begin{proof}
Il est suffisant de vérifier ces propriétés localement sur les ouverts affines. Or dans ce cas, $f$ est une section globale si et seulement si $f$ appartient à tous les anneaux locaux des diviseurs premier d'après \ref{factonormal}. Cette dernière condition revient à dire que $\divi(f)$ est effectif, cela prouve $1$. Pour la deuxième assertion, on remarque que div$(f)=0\iff$div$(f)\geq 0$ et div$(f^{-1})\geq 0$.
\end{proof}

Plus généralement, on définit pour chaque diviseur $D\in \wdiv(X)$ le \textit{faisceau divisoriel} $\Oo_X(D)$ associé à $D$ en posant
\begin{center}
$\Gamma(U,\Oo_X(D)):=\lbrace f\in k(X)^* \mid (\textrm{div}(f)+D)_{|U}\geq 0\rbrace\cup \lbrace 0 \rbrace$ pour tout ouvert $U\subset X$
\end{center}
C'est un sous $\Oo_X$-module de $k(X)$, ce qui se vérifie grâce aux propriétés des valuations $v_D$. Pour tout ouvert affine $U$ de $X$, les sections sur $U$ d'un faisceau divisoriel forment un idéal fractionnaire de $\Oo_X(U)$ que l'on peut décrire explicitement:

\begin{prop}\label{divaff}
Soit $X=\spec A$ une variété affine normale et irréductible, et $D=:=\sum_i a_iD_i$ un diviseur de Weil sur $X$. Alors
\begin{enumerate}
\item $\Gamma(X,\Oo_X(D))=\bigcap_{\haut \mathfrak{p}_i=1}(\mathfrak{p}_iA_{\mathfrak{p}_i})^{-a_i}$.
\item Si $D$ est premier correspondant à un idéal premier $\mathfrak{p}$ de hauteur $1$, on a $\Gamma(X,\Oo_X(-D))=\mathfrak{p}$. Si de plus $\mathfrak{p}$ est inversible et $a\in \ZZ$, on a $\Gamma(X,\Oo_X(aD))=\mathfrak{p}^{-a}$.
\end{enumerate}
\end{prop}
\begin{proof}
\begin{enumerate}
\item Cela vient de la discussion suivant \ref{DefIdealInvertible}.
\item Dans ce cas, $D$ est effectif, donc $\Gamma(X,\Oo_X(-D))$ est un sous-module de $A$, donc un idéal. On a donc $\Gamma(X,\Oo_X(-D))=\mathfrak{p}A_\mathfrak{p}\cap A=\mathfrak{p}$. Pour l'autre assertion, c'est immédiat car $\Oo_X(D)$ est alors inversible d'après \ref{expicaff}, c'est à dire que $D$ est de Cartier.
\end{enumerate}
\end{proof}

On forme maintenant la somme directe $\Ss:=\bigoplus_{D\in \wdiv(X)}\Oo_X(D)$. C'est naturellement une $\Oo_X$-algèbre $\wdiv$-graduée. En effet, pour tout ouvert $U\subset X$, prenons des sections $s\in\Gamma(U,\Oo_X(D_1))$, $t\in \Gamma(U,\Oo_X(D_2))$, et formons le produit $st$ dans $k(X)$. On a alors $\divi(st)_{|U}+D_{1|U}+D_{2|U}=\divi(s)_{|U}+D_{1|U}+\divi(t)_{|U}+D_{2|U}\geq 0$, donc $st$ définit bien un élément de $\Gamma(U,\Oo_X(D_1+D_2))$.

\begin{defn}[Faisceau d'algèbres divisorielles]
Soit $X$ une variété normale et irréductible. Le faisceau d'algèbres divisorielles associé à un sous-groupe $K\subset \wdiv(X)$ est le faisceau de $\Oo_X$-algèbres $K$-graduées $$\bigoplus_{D\in K}\Ss_D,\,\,\,\,\,\,\,\,\, \Ss_D:=\Oo_X(D)$$ 
\end{defn}


\begin{ex}
On considère la droite projective $\PP^1$, $D=\lbrace\infty\rbrace$ et $K=\ZZ D$. Cherchons la forme d'une section $f\in S_{nD}(\PP^1)$. On se place sur la carte affine $U_0=\PP^1\setminus \lbrace \infty\rbrace$ associée au repère projectif $(\infty, 0, 1)=(e_0,e_1,e_0+e_1)$, on note $z$ la coordonnée associée. Par hypothèse, $f$ est régulière sur $U_0$, c'est donc un polynôme en $z$. On fait agir l'homographie $z\mapsto w=1/z$  pour se placer sur la carte $U_1=\PP^1\setminus \lbrace e_1 \rbrace$ associée au repère $(0, \infty,1)$. Sur cette carte, la fonction qui coïncide avec $f$ sur $U_0\cap U_1$ est $g(w)=f(1/w)$. Or si on écrit $f(z)=z^kh(z)$ avec $z\nmid h(z)$, on obtient $g(w)=w^{-k-\textrm{deg}(h)}h(w)$. Comme on doit avoir $k+\textrm{deg}(h)\leq n$, on obtient que $f$ est un polynôme de degré $\leq n$.\\
Ainsi on voit que l'application $\phi_n:k[t_0,t_1]_n\rightarrow S_{nD}(\PP^1), f\mapsto f(1,z)$ est un isomorphisme de $k$-ev. De plus, on a facilement $\phi_n\phi_m=\phi_{n+m}$. Finalement, $(\phi, \widetilde{\phi})$ avec $\phi: k[t_0,t_n]\rightarrow S(\PP^1), f\mapsto f(1,z)$ et $\widetilde{\phi}:\ZZ\rightarrow K, n\mapsto nD$ est un isomorphisme d'algèbres graduées.
\end{ex}

\begin{prop}
Soit $X$ une variété normale et irréductible et $D\in\wdiv(X)$. Alors $\Oo_X(D)$ est un $\Oo_X$-module cohérent. En particulier, le faisceau d'algèbres divisorielles associé à un sous-groupe $K\in \wdiv(X)$ est une $\Oo_X$-algèbre quasi-cohérente.
\end{prop}
\begin{proof}
On peut supposer $X=\spec A$ affine car le problème est local.  Alors d'après \ref{FQCThm}, $\Oo_X(D)\simeq \tilde{M}$ où $M=\Gamma(X,\Oo_X(D))$. Il s'agit donc de montrer que $M$ est un $A$-module de type fini. Mais d'après \ref{divaff}, on voit que $\Gamma(X,\Oo_X(D))$ est un idéal fractionnaire de $A$, il est donc isomorphe à un idéal de $A$ en tant $A$-module après multiplication par une certaine fonction rationnelle. Comme $A$ est noetherien cela conclut la preuve.
\end{proof}

\begin{prop}\label{isomorphismcodim2}
Soit $X$ une variété normale et irréductible et $D\in\wdiv(X)$. Alors pour tout ouvert $U\subset X$ tels que $X\setminus U$ soit de codimension $\geq 2$ dans $X$, on a $\Gamma(U,\Oo_X(D))\simeq \Gamma(X,\Oo_X(D))$.
\end{prop}
\begin{proof}
Encore une fois, on peut traiter le problème localement et supposer $X=\spec A$ affine. La restriction est injective et comme en \ref{extregularnormal}, on remarque que $U$ contient tous les premiers $\mathfrak{p}$ de hauteur $1$. On écrit $D=a_1D_1+...+a_rD_r$ et on considère les injections dans les tiges $\Gamma(X,\Oo_X(D))_\mathfrak{p}=(\mathfrak{p}A_\mathfrak{p})^{-a_\mathfrak{p}}$ (voir \ref{divaff}). On construit ainsi l'inverse de la restriction $\Gamma(U, \Oo_X(D))\xhookrightarrow{}\Gamma(X,\Oo_X(D))=\bigcap_{\haut\mathfrak{p}=1}(\mathfrak{p}A_p)^{-a_\mathfrak{p}}$, en procédant comme en \ref{extregularnormal}.
\end{proof}

\begin{cor}\label{isomorphismcodim2CorXreg}
Soit $X$ une variété normale et irréductible et $D\in\wdiv(X)$. On a des isomorphismes donnés par la restriction à $X_{reg}$
\begin{center}
$\wdiv(X)\simeq \wdiv(X_{reg})$, et  $\Oo_X(D)=i_*\Oo_{X_{reg}}(D)$, où $i:X_{reg}\rightarrow X$ est l'inclusion.
\end{center}
\end{cor}
\begin{proof}
C'est une conséquence de la proposition précédente, de \ref{divexactseq}, et de \ref{codimesingnormal}.
\end{proof}

\subsection{Diviseurs de Cartier et groupe de Picard}
\label{SectionDivCartierPicardGroup}
Sur des variétés quelconques, par exemple avec des singularités, les anneaux locaux associés aux diviseurs premiers ne sont pas en général des anneaux de valuation discrète. On a alors des difficultés pour définir par exemple le diviseur d'une fonction rationnelle. On a néanmoins la notion générale de diviseur de Cartier, qui dans le cadre des variétés normales irréductibles correspondra aux diviseurs de Weil \textit{localement principaux}.

\begin{defn}[Diviseur de Cartier]
Soit $X$ une variété irréductible. Un diviseur de Cartier sur $X$ est une section globale du faisceau $k(X)^*/\mathcal{O}_X^*$. Ainsi un diviseur de Cartier est la donnée d'une famille $(U_i, f_i)_{i\in I}$ telle que les ouverts $U_i$ recouvrent $X$, et pour tous $i,j \in I$, on a $f_i\in k(X)^*$ et $f_if_j^{-1}\in \mathcal{O}_X^*(U_i\cap U_j)$.

Un diviseur de Cartier est dit principal si il provient d'une section globale de $k(X)^*$ c'est à dire d'une fonction rationnelle. Deux diviseurs de Cartier sont dits linéairement équivalents si ils sont égaux modulo le sous-groupe des diviseurs principaux. Le groupe quotient se note $\cacl(X)$.
\end{defn}





Soit $X$ une variété irréductible. On remarque que pour un diviseur de Cartier $D=(U_i, f_i)_{i\in I}$ de $X$, $\mathcal{O}_X(D)_{|U_i}$ est le $(\mathcal{O}_X)_{|U_i}$-module libre de base $(f_i^{-1})$. Il est donc localement libre de rang $1$, c'est à dire inversible. On récupère facilement $D$ à partir de $\mathcal{O}_X(D)$ en prenant un recouvrement qui le trivialise. Enfin, pour tout sous-faisceau inversible de $k(X)$ on construit de la même manière un diviseur de Cartier. On a donc une correspondance bijective entre diviseurs de Cartier et sous-faisceaux inversibles de $k(X)$. 
$$
\left\{
\begin{matrix}
\text{Diviseurs de Cartier sur }X
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{Sous-faisceaux inversibles de } k(X)
\end{matrix}
\right\}
$$

Par cette correspondance, deux diviseurs sont linéairement équivalents si et seulement si les faisceaux inversibles sont isomorphes. On a ainsi définit une application injective CaCl$(X)\rightarrow$ Pic$(X)$ dont on voit facilement que c'est un morphisme de groupes. Comme $X$ est supposé irréductible, c'est un isomorphisme car tout faisceau inversible est isomorphe à un sous-faisceau inversible de $k(X)$. En résumé on a le résultat suivant:


\begin{prop}\label{isopic}
Soit $X$ une variété irréductible. L'application $D\mapsto \Oo_X(D)$ définit un isomorphisme de groupes $\cacl(X)\simeq \pic(X)$.
\end{prop}


On suppose à nouveau $X$ normale et irréductible. Dans ce cadre, tout diviseur de Cartier $(U_i, f_i)_{i\in I}$ définit un unique diviseur de Weil de la façon suivante. Pour tout diviseur premier $D$, on choisit un indice $i\in I$ tel que $U_i\cap D\neq \emptyset$ et on prend $v_D(f_i)$ pour coefficient de $D$. Cette somme est finie par la même preuve que \ref{noetherienPWDivBienDef}. Par ailleurs elle ne dépend pas du choix des indices car si $j$ est un autre indice possible, $f_if_j^{-1}\in \Oo_X^*(U_i\cap U_j)$ par définition, donc $v_D(f_i)=v_D(f_j)$. On a ainsi un diviseur de Weil tel que sa restriction à tout ouvert du recouvrement $(U_i)_{i\in I}$ est principal. D'où la terminologie "localement principal". Ce constat permet de voir $\cacl(X)$ comme un sous-groupe de $\clg(X)$ car on vérifie que les diviseurs principaux se correspondent.

Le sous-groupe $\cacl(X)$ est propre en général (cf \cite{Hartshorne} 6.11.3). En revanche, si $X$ est lisse, tout diviseur de Weil est localement principal . En effet dans ce cas, les anneaux locaux sont factoriels, on obtient ainsi en tout point une équation locale d'un diviseur premier car un idéal premier de hauteur 1 d'un anneau factoriel est principal, ce qui permet de conclure.

\begin{prop}\label{isomophismeOTimes}
Soit $X$ une variété normale irréductible, $D,E\in\wdiv X$ avec $D$ de Cartier. Alors le morphisme naturel $\alpha:\Oo_X(D)\otimes_{\Oo_X}\Oo_X(E)\rightarrow \Oo_X(D+E)$ est un isomorphisme.
\end{prop}
\begin{proof}
Écrivons $D=(U_i,f_i)_{i\in I}$. Alors sur chaque $U_i$, le morphisme $\alpha$ induit un isomorphisme de $\Oo_X$-module. En effet on a un morphisme inverse, il s'agit de la multiplication par $f_i$ composée avec l'inverse de l'isomorphisme $\Oo_{U_i}(D)\otimes_{\Oo_{U_i}}\Oo_{U_i}(E) \simeq \Oo_{U_i}(D)$, localement donné par $a\otimes b\mapsto abf_i$ .
\end{proof}

Par analogie avec les diviseurs de Weil, un diviseur de Cartier $D=(U_i, f_i)_{i\in I}$ est dit effectif si pour tout $i\in I$, $f_i\in \Oo_X(U_i)$. Dans ce cas $\Oo_X(-D)$ est un sous $\Oo_X$-module de $\Oo_X$, c'est concrètement le faisceau d'idéaux localement généré sur chaque $U_i$ par $f_i$. D'après \ref{dimsousvariete} cela définit un sous-schéma fermé de $X$ de codimension 1. L'inclusion $\Oo_X(-D)\xhookrightarrow{} \Oo_X$ est une section globale de $\Hh om(\Oo_X(-D), \Oo_X)\simeq \Oo_X(D)$ appelée \textit{section canonique} et notée $1_D$ puisqu'elle correspond à la multiplication par $1$. Réciproquement, la donnée d'un couple $(\Ll, s)$ constitué d'un faisceau inversible sur $X$ et d'une section globale définit un diviseur de Cartier effectif de la manière suivante. Soit $(U_i)_{i\in I}$ un recouvrement qui trivialise $\Ll$. Sur chaque $U_i$ on a un isomorphisme $\phi_i:\Ll_{|U_i}\rightarrow\Oo_{X|U_i}$. On voit que $(U_i,\phi_i(s))_i$ définit un diviseur de Cartier effectif indépendant du choix des isomorphismes $\phi_i$, et donc du couple $(\Ll,s)$ à isomorphisme près, on l'appelle \textit{le diviseur des zéros} de $s$. Lorsque l'on a un isomorphisme $(\Ll,s)\simeq (\Oo_X(D),f)$, on note ce diviseur $\divi_D(f)$ et on a $\divi_D(f)=\divi(f)+D$. On voit qu'il existe un unique diviseur de Cartier effectif $D$ tel que $(\Ll,s)\simeq(\Oo_X(D),1_D)$. Les deux procédés que l'on vient de décrire sont inverses l'un de l'autre, on obtient ainsi une correspondance bijective:

$$
\left\{
\begin{matrix}
\text{Diviseurs de Cartier effectifs sur }X
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{Classes d'isomorphies de couples }(\Ll, s)\\
\text{ constitués d'un faisceau inversible}\\
\text{et d'une section globale non-nulle}
\end{matrix}
\right\}
$$
En faisant varier $s$ non-nulle dans les couples $(\Oo_X(D),s)$ tels que ci-dessus, on obtient tous les diviseurs de Cartier effectifs linéairement équivalents à $D$. En effet, $\divi_D(s)$ est par définition un diviseur effectif linéairement équivalent à $D$. Réciproquement un diviseur effectif linéairement équivalent à $D$ s'écrit $D+\divi(s)\geq 0$ où $s$ est donc une section globale $s$ de $\Oo_X(D)$.

On peut étendre la correspondance précédente en une correspondance entre diviseurs de Weil effectifs et couples $(\Oo_X(D),s)$ constitués d'un faisceau divisoriel et d'une section globale. En effet on a d'une part un isomorphisme $\wdiv(X)\simeq\wdiv(X_{reg})$ respectant l'effectivité (\ref{isomorphismcodim2} et \ref{divexactseq}). D'autre part on a une égalité $\Oo_X(D)= i_*\Oo_{X_{reg}}(D)$, pour tout diviseur $D\in\wdiv(X)$, où $i:X_{reg}\rightarrow X$ est l'inclusion. Comme tous les diviseurs de Weil sont de Cartier sur $X_{reg}$, on obtient
$$
\left\{
\begin{matrix}
\text{Diviseurs de Weil effectifs sur }X
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{Classes d'isomorphies de couples }(\Oo_X(D), s)\\
\text{ constitués d'un faisceau divisoriel}\\
\text{et d'une section globale non-nulle}
\end{matrix}
\right\}
$$
On note encore $\divi_D(s):=\divi(s)+D$ les diviseurs de Weil effectifs obtenus de cette manière.
\subsection{L'espace projectif $\PP_k^n$}

\subsubsection{Faisceaux inversibles sur $\PP_k^n$}

\begin{prop}
Soit $X:=\PP_k^n=\proj k[x_0,...,x_n]$. Pour tout diviseur $D=\sum a_i D_i\in\wdiv(X)$, on définit le degré de $D$ par $\deg D:=\sum a_i\deg D_i$, où $\deg D_i$ est le degré de l'équation définissant $D_i$ dans une carte affine standard qui intersecte $D_i$. Soit $H$ l'hyperplan $x_0=0$. Alors
\begin{enumerate}
\item Si $D$ est un diviseur de degré $d\in \ZZ$, alors $D\sim dH$.
\item Pour tout $f\in k(X)^*$, on a $\deg\divi(f)=0$.
\item Le degré définit un isomorphisme $\clg(X)\simeq \ZZ$.
\end{enumerate}
\end{prop}
\begin{proof}
\cite{Hartshorne} II.6.4
\end{proof}

La proposition précédente et \ref{isopic} nous dit que $\pic(X)$ est engendré librement par $\Oo_X(H)$ pour tout hyperplan $H$ de $\PP_n^k$. De plus, comme $k[x_0,...,x_n]$ est engendré par des éléments homogènes de degré $1$, le faisceau $\Oo_X(l)$ est inversible pour tout $l\in \ZZ$, et on a $\Oo_X(m)\otimes_{\Oo_X}\Oo_X(l)\simeq \Oo_X(m+l)$, pour tout $m,l\in \ZZ$. Comme $\Oo_X(1)$ est isomorphe à $\Oo_X(H)$, on en déduit que tout faisceau inversible sur $\PP_k^n$ est isomorphe à un faisceau $\Oo_X(l)$, pour un entier $l\in \ZZ$.

\subsubsection{Faisceau engendré par ses sections globales, Image inverse d'une section globale}
\noindent Un $\Oo_X$-module $\Ff$ sur un schéma $X$ est \textit{engendré par des section globales} si on a une suite exacte 
$$\bigoplus_{i\in I}\Oo_X\rightarrow \Ff\rightarrow 0$$
Soient $f:Y\rightarrow X$ un morphisme de schémas, $\Ff$ un $\Oo_X$-module engendré par des sections globales $s_1,...,s_n$. On considère le morphisme canonique de $\Oo_X$-modules $\alpha:\Ff\rightarrow f_*f^*\Ff$, où la structure de $\Oo_X$-module sur $f_*f^*\Ff$ est donnée par $\lambda.t=f^\sharp(\lambda)t$ pour tout ouvert $V\subset X$, $\lambda\in \Oo_X(V)$, $t\in f_*f^*\Ff(V)$. On définit \textit{l'image inverse} de la section $s_i$ par $f^*(s_i):=\alpha(X)(s_i)$, c'est une section globale du faisceau de modules $f^*(\Ff)$. On vérifie que $f^*(\Ff)$ est engendré par les sections globales $f^*(s_1),...,f^*(s_n)$.

Considérons maintenant une paire $(\Ll,s)$ constituée d'un faisceau inversible $\Ll$ sur $X$, et d'une section globale $s$. On note $\Vv_X(s)$ le support du diviseur des zéros de $s$, et $X_{s}=\lbrace x\in X\mid \Oo_{X,x}s_x=\Ll_x\rbrace=\lbrace x\in X\mid s_x\notin \mathfrak{m}_x\Ll_x\rbrace$ son complémentaire. Si $\Ll=\Oo_X$, il s'agit de l'ouvert principal $X_s$, et on a de plus $f^{-1}(X_s)=X_{f^\sharp(s)}=X_{f^*(s)}$ car $f^*\Oo_Y=\Oo_X$ et $\alpha=g^\sharp$ dans ce cas. Dans le cas général, on voit facilement que $f^*\Ll$ est inversible et en raisonnant localement sur des ouverts affines qui trivialisent $\Ll$, on voit d'après ce qui précède que $f^{-1}(X_s)=Y_{f^*(s)}$.  

Enfin, si $s_1,...,s_n$ sont des sections globales qui engendrent $\Ll$, on voit que $(X_{s_i})$ est un recouvrement de $X$ qui trivialise $\Ll$. En effet, sur chaque $Y_{l_i}$, on a un isomorphisme $\Oo_{X_{s_i}}\rightarrow \Ll_{|X_{s_i}}$, $\lambda \mapsto \lambda s_i$, et par hypothèse, l'intersection $\cap_{i=1}^n \Vv_X(s_i)$ est vide. Enfin, on note sans ambiguïté $s_j/s_i$ l'unique élément de $\Oo(X_{s_i})$ tel que $s_j/s_i.s_i=s_j$ par l'isomorphisme précédent.

\subsubsection{Morphismes vers l'espace projectif}
\label{morphismeproj}

Soit $A$ un anneau, $X$ un schéma sur $\spec A$, et $f:X\rightarrow\PP_A^n$ un morphisme de schémas sur $\spec A$ où $\PP^n_A=\proj A[x_0,...,x_n]$. On considère le faisceau décalé $\Oo(1)$ sur $\PP^n_A$. C'est un faisceau inversible engendré par les sections globales $x_0,...,x_n$. Les sections globales $s_i:=f^*(x_i)$ pour $0\leq i\leq n$, engendrent $f^*\Oo(1)$ d'après la partie précédente. Sur la carte affine standard $U_i:=\Oo(1)_{x_i}$, la $A$-algèbre $\Oo_{P^n_A}(U_i)$ est engendrée par les éléments $x_j/x_i$ et on a $s_j/s_i.s_i=s_j=\alpha(U_i)(x_j)=\alpha(U_i)(x_j/x_i.x_i)=f^\sharp(x_j/x_i).\alpha(U_i)(x_i)=f^\sharp(x_j/x_i).s_i$. On a donc nécessairement $f^\sharp(x_j/x_i)=s_j/s_i$. Comme les $U_i$ sont affines, cela définit des morphismes $f_i:X_{s_i}\rightarrow P^n_A$ en composant avec l'inclusion. C'est morphismes se recollent en un unique morphisme, car ils coïncident sur les $X_{s_i}\cap X_{s_j}$. En résumé, on récupère $f$ par la donnée des sections $s_i$. Ainsi $f$ est l'unique morphisme tel que $f^*(x_i)=s_i$.

Réciproquement montrons que la donnée d'un faisceau inversible $\Ll$ sur $X$ et de sections globales $s_0,...,s_n$ qui l'engendrent définissent un unique morphisme $f:X\rightarrow \PP^n_A$ tel que $\Ll\simeq f^*\Oo(1)$, ce dernier isomorphisme étant celui qui envoie $f^*(x_i)$ sur $s_i$. Si $f$ existe avec ces propriétés, il est unique d'après ce qui précède. Pour l'existence, on construit comme précédemment des morphismes $f_i:X_{s_i}\rightarrow U_i$ qui se recollent en un morphisme $f:X\rightarrow \PP^n_A$. Par construction, $\Ll$ et $f^*\Oo(1)$ se trivialisent sur le même recouvrement $(f^{-1}(U_i)=X_{s_i}=X_{f^*(x_i)})_{1\leq i\leq n}$. On a des isomorphismes locaux $\phi_i:\Ll_{|f^{-1}(U_i)}\rightarrow f^*\Oo(1)_{|f^{-1}(U_i)}$, $s_i\mapsto f^*x_i$. Ce sont des sections locales de $\mathscr{H}om_{\Oo_X}(\Ll,\Oo(1))$ sur un recouvrement de $X$. Pour vérifier qu'elles coïncident aux intersections $X_{s_i}\cap X_{s_j}$, on remarque que l'on a $s_i/s_j=f^\sharp(U_i\cap U_j)(x_i/x_j)= f^*(x_i)/f^*(x_j)\in \Oo_X(X_{s_i}\cap X_{s_j})^*$. Ces sections se recollent donc en un unique isomorphisme $\Ll\simeq f^*\Oo(1)$ qui est bien l'isomorphisme recherché.

\noindent En résumé on a obtenu une correspondance bijective
$$
\left\{
\begin{matrix}
\text{Morphismes de schémas sur } \spec A\\
f:X\rightarrow \PP_A^n
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{Classes d'isomorphies de uplets }(\Ll, s_0,...,s_n)\\
\text{constituées d'un faisceau inversible}\\
\text{et de sections globales qui l'engendrent}
\end{matrix}
\right\}
$$


\subsubsection{Variétés quasi-projectives, faisceaux amples}

\noindent On se fixe un anneau de base $A$.

\begin{defn}[Morphisme projectif, quasi-projectif]
Un morphisme de schémas $f:X\rightarrow \spec A$ est projectif si il se factorise à travers une immersion fermée $i:X\rightarrow \PP_A^n$ sur $\spec A$, pour un entier $n>0$. Le morphisme est quasi-projectif si il se factorise à travers une immersion ouverte $X\rightarrow X'$ sur $\spec A$ composée avec un morphisme projectif $X'\rightarrow \spec A$.
\end{defn}


\begin{defn}[Schéma projectif, quasi-projectif]
Un schéma $X$ sur $\spec A$ est projectif (resp. quasi-projectif) si le morphisme structural est projectif (resp. quasi-projectif).
\end{defn}

\begin{defn}[Faisceau très ample relativement à $\spec A$]
Soit $X$ un schéma sur $\spec A$ et $\Ll$ un faisceau inversible sur $X$ engendré par une famille finie de sections globales. Si ces sections définissent une immersion $X\xhookrightarrow{}\PP_A^n$ sur $\spec A$, on dit que $\Ll$ est très ample relativement à $\spec A$. Cela revient à dire que $\Ll\simeq i^*\Oo(1)$  pour une immersion $i:X\xhookrightarrow{}\PP_A^n$.
\end{defn}

\begin{defn}[Faisceau ample]
Soit $X$ un schéma. Un faisceau inversible $\Ll$ sur $X$ est ample si pour tout faisceau cohérent $\Ff$ sur $X$, il existe un entier $n_0>0$ tel que pour tout $n\geq n_0$, le faisceau $\Ff\otimes_{\Oo_X}\Ll^{\otimes n}$ est engendré par ses sections globales.
\end{defn}

\begin{prop}
Soit $X$ un schéma sur $\spec A$ avec $A$ noetherien. Un faisceau très ample sur $X$ relativement à $\spec A$ est ample.
\end{prop}
\begin{proof}
\cite[II.5.17]{Hartshorne} 
\end{proof}

\begin{thm}
Soit $X$ un schéma de type fini sur $\spec A$ avec $A$ noetherien, et $\Ll$ un faisceau inversible sur $X$. Alors $\Ll$ est ample si et seulement si $\Ll^{\otimes m}$ est très ample relativement à $\spec A$ pour un entier $m>0$.
\end{thm}
\begin{proof}
\cite[II.7.6]{Hartshorne}
\end{proof}


Considèrons maintenant $X$ une variété lisse irréductible et projective, $D\in \wdiv(X)$, et $\Oo_X(D)$ le faisceau inversible associé. On a vu que l'ensemble des diviseurs effectifs linéairement équivalents à $D$ est $\lbrace \divi_D(s)\mid s\in\Gamma(X,\Oo_X(D))\setminus\lbrace0\rbrace \rbrace$. D'autre part, deux sections globales $s, s'$ non nulles ont même diviseur des zéros si et seulement si elles sont colinéaires dans le $k$-espace vectoriel $\Gamma(X, \Oo_X(D))$, en effet dans ce cas $s/s'\in \Oo(X)^*=k^*$, car $k$ est algébriquement clos. Notons enfin que $\Gamma(X, \Oo_X(D))$ est de dimension finie sur $k$ (\cite[II.5.19]{Hartshorne}). Ainsi l'ensemble des diviseurs effectifs linéairement équivalent à $D$ est naturellement muni d'une structure d'espace projectif, cela amène la définition suivante:
\begin{defn}[Système linéaire, point de base]
Soit $X$ une variété lisse et projective, et $D$ un diviseur. Le système linéaire complet défini par $D$ est l'ensemble des diviseurs effectifs linéairement équivalents à $D$, on le note $|D|$. Un système linéaire est une partie de $|D|$ correspondant à un sous espace projectif. On dit que $p\in X$ est un point de base d'un système linéaire $\PP(V)\subset |D|$ si l'intersection des $\Vv_X(s):=X\setminus X_s$ pour $s\in V$ est non-vide. 
\end{defn}

Autrement dit dans ce langage, se donner un morphisme $X\rightarrow \PP^n_k$ est équivalent à se donner un système linéaire $\PP(V)\subset |D|$ sans point de base et une base de $V$. Voir \cite[II.7.8.2]{Hartshorne} pour une caractérisation des variétés projectives dans ce langage.


\subsection{Le groupe des unités d'une variété irréductible}
\label{unitGroupFiniteType}


Soit $X$ une variété, le groupe des unités $U(X)$ de $X$ est le quotient du groupe $\Oo(X)^*$ des fonctions régulières inversibles par le sous-groupe $k^*$ des fonctions constantes. On va appliquer les techniques précédentes pour obtenir un résultat de finitude de $U(X)$ lorsque $X$ est irréductible, ainsi que du groupe des caractères d'un groupe algébrique. On commence par énoncer un lemme utile.

\begin{lem}\label{CompletionNormal}
Soit $X$ une variété affine irréductible.
Il existe une variété projective irréductible $\bar{X}$ contenant $X$ comme ouvert. Si $X$ est normale, alors $\bar{X}$ peut être choisie normale également.
\end{lem}
\begin{proof}
On peut supposer que $X$ est plongée dans un espace affine $\AAA^n_k$. On considère alors l'adhérence $Y$ de $X$ dans l'espace projectif $\PP^n_k$ (qui contient $\AAA^n_k$ comme ouvert). Par construction, $Y$ est projective, irréductible et contient $X$ comme ouvert.

Si $X$ est normale, on considère la normalisation $\eta:\widetilde{Y}\rightarrow Y$. Alors $\widetilde{Y}$ contient encore $X$ comme ouvert par hypothèse. Pour montrer que $\widetilde{Y}$ est projective, il suffit de montrer qu'elle est quasi-projective car comme $\eta$ est fini, $\widetilde{Y}$ est propre sur $Y$ et donc sur $k$ (\cite[II.4.8, ex II.4.1]{Hartshorne}), ce qui permet d'utiliser \cite[ex II.4.4]{Hartshorne}. Par hypothèse, $Y$ admet un faisceau ample $\Ll$, on va vérifier que $\eta^*\Ll$ est ample, ce qui achèvera la preuve. Soit $\Ff$ un faisceau cohérent sur $\widetilde{Y}$. Alors $\eta_*\Ff$ est cohérent sur $Y$ car $\eta$ est fini et $Y$ est noetherien (\ref{FQCProps3} 6). Comme $\Ll$ est ample, $\eta_*\Ff\otimes_{\Oo_Y} \Ll^{\otimes m}$ est engendré par ses sections globales pour $m\gg 0$, ce qui donne un morphisme surjectif $\bigoplus_{i\in I}\Oo_Y\rightarrow \eta_*\Ff\otimes_{\Oo_Y} \Ll^{\otimes m}$. Par la formule de projection (\cite[ex II.5.1.d]{Hartshorne}), on a $\eta_*\Ff\otimes_{\Oo_Y} \Ll^{\otimes m}=\eta_*(\Ff\otimes_{\Oo_{\widetilde{Y}}}\eta^*(\Ll^{\otimes m}))$. Le foncteur $\eta^*$ est exacte à droite, commute au produit tensoriel et aux sommes directes. On obtient donc un morphisme surjectif 
$$\oplus_{i\in I}\Oo_{\widetilde{Y}}=\oplus_{i\in I}\eta^*\Oo_Y\rightarrow \eta^*\eta_*(\Ff\otimes_{\Oo_{\widetilde{Y}}}(\eta^*\Ll)^{\otimes m})$$
Finalement, comme l'application canonique $\eta^*\eta_*(\Ff\otimes_{\Oo_{\widetilde{Y}}}(\eta^*\Ll)^{\otimes m})\rightarrow \Ff\otimes_{\Oo_{\widetilde{Y}}}(\eta^*\Ll)^{\otimes m}$ est surjective car $\eta$ est affine, on obtient que $\eta^*\Ll$ est ample en composant les deux applications précédentes.
\end{proof}

\begin{prop}
Soit $X$ une variété irréductible. Alors $U(X)$ est libre de type fini.
\end{prop}
\begin{proof}
Comme $\Oo(X)^*$ s'injecte dans $\Oo(U)^*$ pour tout ouvert $U\subset X$, on peut supposer $X$ affine car un sous-groupe d'un groupe abélien libre de type fini est aussi libre de type fini. Soit $\eta_X:\widetilde{X}\rightarrow X$ l'application de normalisation. Alors $\widetilde{X}$ est affine, on a une injection $\eta_X^\sharp:\Oo(X)\xhookrightarrow{}\Oo(\widetilde{X})$ qui induit une injection $U(X)\xhookrightarrow{}U(\widetilde{X})$. On peut donc supposer $X$ normale.

D'après \ref{CompletionNormal}, on peut supposer que $X$ est un ouvert d'une variété projective normale $\bar{X}$. On note $D_1,...,D_r$ les composantes irréductibles de $\bar{X}\setminus X$. Ceux sont des diviseurs premiers car ils sont définis par l'équation de l'hyperplan à l'infini. Dans chaque carte affine qui les rencontre, il s'agit donc de sous-variétés fermés de codimension $1$ d'après \ref{dimsousvariete}. Chacun de ces diviseurs premiers $D_i$ définit un anneau de valuation discrète dont on note $v_i$ la valuation. On considère l'application:
$$\Oo(X)^*\rightarrow \ZZ^r, f\mapsto (v_1(f),...,v_r(f))$$
C'est un morphisme de groupes de noyau $k^*$ d'après \cite[I.3.4]{Hartshorne}. ce qui conclut la preuve.
\end{proof}

\begin{prop}
Soit $X, Y$ des variétés irréductibles. Alors le morphisme:
$$\Oo(X)^*\times\Oo(Y)^*\rightarrow\Oo(X\times Y)^*,\,(f,g)\mapsto ((x,y )\mapsto f(x)g(y))$$
est surjectif.
\end{prop}
\begin{proof}
Il suffit de montrer que $f\in \Oo(X\times Y)^*$ peut s'écrire $f=gh$ pour $g\in k(X)$ et $h\in k(Y)$. En effet, on considère un point $y\in Y$ où $h$ est régulière. D'autre part on constate que $f_y:x\mapsto f(x,y)$ est régulière sur $X$, ce qui se voit sur les ouverts affines $U\times V$. En effet $\Oo(U\times V)$ est alors le coproduit des algèbres de coordonnées $\Oo(U)$ et $\Oo(V)$, c'est à dire leur produit tensoriel. De plus, $f_y$ ne s'annule pas donc est inversible dans $\Oo(X)$. Cela prouve que $g$ est en fait régulière, et $h$ aussi par le même raisonnement.

On peut ainsi remplacer $X$ et $Y$ par deux ouverts affines lisses. Le produit  $X\times Y$ est encore affine et lisse. D'après \ref{CompletionNormal}, on peut supposer que $X$ est un ouvert d'une variété projective normale $\bar{X}$, et on note $D_1,...,D_r$ les diviseurs premiers correspondants aux composantes irréductibles de $\bar{X}\setminus X$. Soit $f\in \Oo(X\times Y)^*$ que l'on regarde comme une fonction rationnelle sur $\bar{X}\times Y$, qui est normal d'après \ref{tensorproductNormalDomain}. Le diviseur associé à $f$ est à support dans $(\bar{X}\setminus X)\times Y$, on a donc $\divi(f)=\sum_{i=1}^rn_iD_i\times Y$ pour des entiers $n_1,...,n_r$. Soit $\pi_i$ une uniformisante de l'anneau de valuation discrète $\Oo_{\bar{X},D_i}$. Il existe $x_0\in D_i$ tel que $\pi_i$ définisse une équation locale de $D_i$. Soit $y_0\in Y$, on peut écrire une équation locale de $D_i\times Y$ en $(x_0,y_0)$ sous la forme $\pi_i(x)u(x,y)$ avec $u$ inversible sur un voisinage de $(x_0,y_0)$. Ainsi il existe un ouvert non-vide $V\subset Y$ tel que pour tout $y\in V$, on ait $\divi(f_y)=\sum_{i=1}^rn_iD_i$. Choisissons $y_0\in V$, alors $\divi(f_yf_{y_0}^{-1})=0$ donc $f_yf_{y_0}^{-1}$ définit une fonction régulière sur $\bar{X}$. Comme $\bar{X}$ est propre sur $k$ (\cite[II.4.9]{Hartshorne}), $f_yf_{y_0}^{-1}$ est en fait constante (\cite[ex II.4.4]{Hartshorne}). Ainsi $h:=f/f_{y_0}$ définit une fonction rationnelle sur $Y$ telle que $f=f_{y_0}h$ comme désiré.
\end{proof}

\noindent Soit $X,\,Y$ des variétés irréductibles. Considérons la suite exacte courte

\begin{equation}\label{eq:sesUnitGroup}
0\rightarrow k^* \rightarrow \Oo(X)^*\rightarrow U(X) \rightarrow 0
\end{equation}
Elle est scindée car tout choix de $x\in X$ définit une section. En effet, le sous-groupe de $\Oo(X)^*$ des fonctions valant $1$ en $x$ s'envoie isomorphiquement sur $U(X)$. On a donc $\Oo(X)^*\simeq k^*\times U(X)$. De plus, le noyau du morphisme naturel $\Oo(X)^*\times\Oo(Y)^*\rightarrow U(X\times Y)$ est $k^*\times k^*$. Comme il est surjectif d'après la proposition précédente, on obtient $U(X\times Y)\simeq U(X)\times U(Y)$.
On applique maintenant ces résultats au groupe de caractères d'un groupe algébrique connexe. 


\begin{prop}
Soit $G$ un groupe algébrique connexe, et $f\in \Oo(G)^*$ telle que $f(e)=1$. Alors $f\in X^*(G)$.
\end{prop}
\begin{proof}
L'application
$$f\circ m:G\times G\rightarrow \AAA^1, (g,h)\mapsto f(gh)$$
est régulière inversible sur $G\times G$ qui est connexe donc irréductible. On applique donc la proposition précédente pour trouver $\phi,\psi \in \Oo(G)^*$ tels que $f(gh)=\phi(g)\psi(g),\,\forall g,h\in G$. Quitte à multiplier $\phi$ par un scalaire, on peut supposer $\phi(e)=1$. En fixant $g=e$ on obtient $\psi=f$, puis en fixant cette fois $h=e$, on obtient $g=\phi$. Finalement, $f(gh)=f(g)f(h)$, donc $f$ est un caractère.
\end{proof}

Ainsi, pour un groupe algébrique connexe $G$, le groupe des caractères $X^*(G)$ définit un scindage de la suite exacte courte \ref{eq:sesUnitGroup}. On a donc $X^*(G)\simeq U(G)$ et donc $X^*(G\times H)\simeq X^*(G)\times X^*(H)$ pour tout autre groupe algébrique connexe $H$. En particulier on en déduit que le groupe des caractères d'un groupe algébrique quelconque est de type fini comme on le voit en considérant l'injection $X^*(G)\xhookrightarrow{} \prod_{i=1}^rU(g_iG^o)$, où les $g_iG^o$ désignent les composantes connexes de $G$. Le corollaire suivant nous sera utile par la suite.

\begin{cor}\label{rosenlicht1}
Soit $G$ un groupe algébrique connexe, et $X$ une $G$-variété. Alors l'application naturelle $X^*(G)\times \Oo(X)^*\rightarrow \Oo(G\times X)^*$ est un isomorphisme.

Si $X$ est de plus une $G$-variété. Alors pour tout $f\in \Oo(X)^*$, il existe $\chi_f\in X^*(G)$ tel que $f(g.x)=\chi_f(g)f(x)$ pour tout $g\in G$ et $x\in X$.
\end{cor}
\begin{proof}
L'application est bien surjective d'après le corollaire et la proposition précédente et son noyau est clairement trivial. Pour le deuxième point, il suffit de considérer l'application $(g,x)\mapsto f(g.x)\in \Oo(G\times X)^*$.
\end{proof}
