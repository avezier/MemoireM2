\chapter{Faisceaux divisoriels sur une variété algébrique}


\section{Faisceaux quasi-cohérents}

\subsection{Faisceaux quasi-cohérents sur un schéma}


\subsubsection{Spectre relatif d'une $\Oo_X$-algèbre}

Soit $X=\spec A$ un schéma affine, et $B$ une $A$-algèbre. C'est en particulier un $A$-module, et on remarque que $\widetilde{B}$ est naturellement munit de faisceau d'algèbres dans le sens où pour tout ouvert $U\subset X$, l'anneau $\widetilde{B}(U)$ est naturellement une $\Oo_X(U)$-algèbre. Cela mène à la définition suivante.

\begin{defn}[$\Oo_X$-algèbre]
Soit $X$ un schéma. Une $\Oo_X$-algèbre est un faisceau d'anneaux $\Ss$ sur $X$ muni d'un morphisme $\Oo_X\rightarrow \Ss$. On dit que $\Ss$ est quasi-cohérente si elle l'est en tant que $\Oo_X$-module. On dit qu'elle est localement de type fini si tout point $x\in X$ admet un voisinage ouvert $U$ tel que $\Ss(U)$ soit de type fini en tant que $\Oo_X(U)$-algèbre.
\end{defn}

On introduit ci-dessous la version relative du spectre d'un anneau. Cette construction nous sera très utile par la suite.

\begin{cons}[Spectre relatif]	\label{relspec}
Soit $X$ un schéma séparé, $\Ss$ une $\Oo_X$-algèbre quasi-cohérente, et $(U_i)_{i\in I}$ un recouvrement affine de $X$. Il existe un schéma $\spec_X \Ss$ construit par recollement des schémas affines $\spec(\Ss(U_i))$, unique à isomorphisme canonique près. Ce schéma est séparé sur $X$ via le recollement des morphismes $\spec(\Ss(U_i))\rightarrow U_i$ donnés par la structure d'algèbre. De plus, le morphisme $p$ est affine est on a l'égalité de faisceaux
$$p_*(\Oo_{\spec_X\Ss})=\Ss$$
Enfin, si $X$ est une variété et que $\Ss$ est faisceau d'algèbres réduites localement de type fini, alors $\spec_X \Ss$ est une variété.
\end{cons}
\begin{proof}
On note $U_{ij}:=U_i\cap U_j$, $A_i:=\Ss(U_i)$ et $A_{ij}:=\Ss(U_{ij})$. Les données donnent naturellement un diagramme commutatif

	\begin{center}
	\begin{tikzcd}
  		\widetilde{X}_{ij}:=\spec A_{ij} \arrow[r, "\phi_i"] \arrow[d, "p_{ij}"]& \widetilde{X}_i:=\spec A_i \arrow[d, "p_i"] \\ 
  		U_{ij} \arrow[r, "\iota=\subset"] & U_i
	\end{tikzcd}\\
	\end{center}
	
On a $\Ss_{|U_{ij}}=\iota^*(\Ss_{|U_i})$ donc $\widetilde{A_{ij}}=\iota^*(\widetilde{A_i})=\widetilde{R_{ij}\otimes_{R_i}A_i}$, où $R_i:=\Oo_X(U_i)$ et $R_{ij}:=\Oo_X(U_{ij})$, ce qui donne $A_{ij}\simeq R_{ij}\otimes_{R_i}A_i$, puis $\widetilde{X}_{ij}\simeq U_{ij}\times_{U_i}\widetilde{X}_i$. Cela prouve que $\phi_i$ est une immersion ouverte. On a de même une immersion ouverte $\phi_j:\widetilde{X}_{ij}\rightarrow \widetilde{X}_j$. Les $\phi_{ij}:=\phi_j\phi_i^{-1}$ vérifient bient les conditions de recollement de \ref{gluevar}. On a donc un schéma $\widetilde{X}$ sur $X$ car les $p_i$ se recollent en un morphisme $p:\widetilde{X}\rightarrow X$ qui est affine par construction. Ce morphisme est séparé d'après \ref{sepCritere}. La dernière assertion est claire par définition.
\end{proof}


\subsection{Faisceaux quasi-cohérents sur une variété projective}

\subsection{Cohomologie des faisceaux et applications}

\subsubsection{Généralités}

\noindent On rappelle sans démonstrations quelques définitions et résultats de base, l'objectif étant de définir les groupes de cohomologie d'un faisceau sur un schéma relatifs au foncteur sections globales. La référence principale est \cite{Hartshorne} chap III.\\

Soit $X$ un schéma, on considère la catégorie $\Aa b(X)$ des faisceaux de groupes abéliens sur $X$, et la catégorie $\Mm od(X)$ des $\Oo_X$-modules. Soit $A^.$ un complexe dans $\Aa b(X)$, c'est à dire une famille d'objets $(A^i)_{i\geq 0}$ et des morphismes $d^i:A^i\rightarrow A^{i+1}$ tels que $d^{i+1}d^i=0$ pour tout $i\geq 0$. Un morphisme de complexes $f:A^.\rightarrow B^.$ est une famille de morphismes $f^i:A^i\rightarrow B^i$ qui commutent avec les applications $d^i$. Le $i^e$ groupe de cohomologie $h^i(A^.)$ du complexe $A^.$ est le groupe $\ker d^i/\Im d^{i-1}$. Soit $0\rightarrow A^.\rightarrow B^. \rightarrow C^. \rightarrow 0$ une suite exacte courte de complexes, on obtient grâce au lemme du serpent (\cite{atiyahmacdo} 2.10) des morphismes $\delta ^i:h^i(C^.\rightarrow h^{i+1}(A^.) $ dits de connexion, donnant une suite exacte longue:
\begin{equation}\label{eq:longSES}
...\rightarrow h^i(A^.) \rightarrow h^i(B^.) \rightarrow h^i(C^.) \xrightarrow{\delta ^i} h^{i+1}(A^.) \rightarrow ...
\end{equation}

Ces définitions ont également un sens dans la catégorie $\Aa b$ des groupes abéliens, et si on se donne un foncteur $F:\Aa b(X)\rightarrow \Aa b$, alors $F$ envoie des complexes de faisceaux sur des complexes de groupes. On suppose de plus que $F$ est covariant exact à gauche. Pour tout faisceau $\Ff\in \Aa b(X)$ (resp. tout $\Oo_X$-module) on peut obtenir une résolution injective, c'est à dire une suite exacte:
$$0\rightarrow \Ff \xrightarrow{\epsilon} I^0\rightarrow I^1\rightarrow ...$$
telle que les faisceaux $I^k$ soient injectifs. Cela signifie que les foncteurs $\Hom(.,I^k)$ sont exacts (ils sont exacts seulement à gauche en général). On définit les foncteurs dérivés à droite $R^iF$ de $F$ pour $i\geq 0$ par $R^i F(\Ff)=h^i(F(I^.))$, et on a le résultat fondamental suivant:

\begin{thm}
\begin{enumerate}
\item Les $R^i F$ définissent des foncteurs $\Aa b(X)\rightarrow \Aa b$. De plus, ils ne dépendent pas du choix des résolutions injectives à isomorphisme près.
\item On a un isomorphisme $F\simeq R^0F$
\item Pour tout suite exacte courte $0\rightarrow \Ff'\rightarrow \Ff \rightarrow \Ff'' \rightarrow 0$ dans $\Aa b(X)$, il existe un morphisme naturel de connexion $\delta^i:R^iF(\Ff'')\rightarrow R^{i+1}F(\Ff')$, tel que l'on obtient une suite exacte longue:
$$...\rightarrow R^iF(\Ff') \rightarrow R^iF(\Ff) \rightarrow R^iF(\Ff'') \xrightarrow{\delta ^i} R^{i+1}F(R^{i+1}) \rightarrow ...$$
\end{enumerate}
\end{thm}

\begin{defn}
Soit $\Gamma(X,.):\Aa b(X)\rightarrow \Aa b$ le foncteur sections globales. Les foncteurs de cohomologie $H^i(X,.)$ sont les foncteurs dérivés à droite de $\Gamma(X,.)$. Pour tout $\Ff\in \Aa b(X)$, les groupes $H^i(X,\Ff)$ sont appelés les groupes de cohomologie de $\Ff$.
\end{defn}


Un faisceau $\Ff$ est dit acyclique si $H^i(X,\Ff)$ est nul pour tout $i>0$. On peut toujour remplacer une résolution injective de $\Ff$ par une résolution acyclique pour le calcul des groupes de cohomologie de $\Ff$. Les faisceaux flasques donne une classe de faisceaux acycliques, ce sont les faisceaux dont les flèches de restriction sont surjectives. De plus, tout faisceau injectif est flasque, on en déduit que l'on peut utiliser des résolutions injectives dans $\Mm od(X)$ pour calculer les groupes de cohomologie d'un $\Oo_X$-module.

\subsubsection{Cohomologie à support}

Soit $X$ un schéma, $\Ff\in \Aa b(X)$, et $Z$ un fermé de $X$. Le support $\supp\Ff$ est l'ensemble des points où la tige et non-nulle. De même, le support d'une section est l'ensemble des points où le germe est non-nul, c'est un fermé de $X$. On définit le sous-faisceau $\Hh ^0 _Z(\Ff):V\mapsto \Gamma_{Z\cap V}(V,\Ff)$ où $\Gamma_{Z\cap V}(V,\Ff)$ est le sous-groupe de $\Gamma(V,\Ff)$ constitué des sections à support contenu dans $Z\cap V$. C'est bien un faisceau car les sections locales se recollent de manière unique en sections de $\Ff$ qui restent à support dans $Z$. On a de plus une suite exacte:


\begin{equation}\label{eq:ESSupport}
0\rightarrow \Hh^0 _Z(\Ff) \rightarrow \Ff \rightarrow j_*(\Ff_{|U})
\end{equation}

\begin{ex}\label{cohomsupportaffineex}
Soit $X=\spec A$ un schéma affine noetherien, $M$ un $A$-module et $\Ff=\widetilde{M}$, $\mathfrak{a}$ un idéal et $Z=\Vv(\mathfrak{a})$. Soit $m\in M=\Gamma(X,\Ff)$, alors $\supp m=\Vv(\ann m)$, où $\ann M=\lbrace a\in A\mid am=0\rbrace$ est l'annulateur de $m$. En effet, soit $p\in X$, alors $m_p\neq 0\iff \forall a\in A\setminus p, fm\neq 0\iff \ann(m)\subset p$.

On définit un sous-module $\Gamma_\mathfrak{a}(M)$ de $M$ par $\Gamma_\mathfrak{a}(M):=\lbrace m\in M\mid \mathfrak{a}^nm=0 \text{ pour un } n>0 \rbrace$. Alors on a $\Gamma_\mathfrak{a}(M)^{\widetilde{}} = \Hh ^0 _Z(\Ff)$. En effet, tout d'abord $\Hh^0 _Z(\Ff)$ est quasi-cohérent comme noyau d'un morphisme entre faisceaux quasi-cohérents, cela d'après la suite exacte ci-dessus et \ref{j* qch}. En utilisant \ref{}, il reste donc à montrer que $\Gamma_\mathfrak{a}(M)\simeq\Gamma_Z(X,\Ff)$ en tant que $A$-modules. Soit $m\in\Gamma_Z(X,\Ff)$, on a par définition $\supp m=\Vv(\ann m)\subset \Vv(\mathfrak{a})$, d'où $\mathfrak{a}\subset \sqrt{\ann m}$. Or, $\mathfrak{a}$ est de type fini car $A$ est noetherien, on en conclut que $m\in \Gamma_\mathfrak{a}(M)$. En effet, si on a $k$ générateurs $x_1,...,x_k$ de $\mathfrak{a}$, on peut trouver un exposant commun $n$ tel que $x^n_i$ annule $m$ pour tout $i$. Alors on a par exemple $\mathfrak{a}^{n^k}m=0$. Réciproquement, si $m\in \Gamma_\mathfrak{a}(M)$, alors $\mathfrak{a}^n\subset \ann m$ pour un $n>0$, ce qui donne $\supp m \subset\Vv(\mathfrak{a}^n)=\Vv(\mathfrak{a})$, puis $m\in \Gamma_Z(X,\Ff)$. Finalement on a bien $\Gamma_\mathfrak{a}(M)=\Gamma_Z(X,\Ff)$.
\end{ex}

Il est facile de montrer que $\Gamma_Z(X, .)$ est un foncteur exact à gauche, on définit alors les groupes de cohomologie de $\Ff$ à support dans $Z$ comme ses foncteurs dérivés à droite, on les note $H_Z^i(X,\Ff)$. Si $\Ff$ est flasque, en appliquant le foncteur sections globales $\Gamma(X,.)$ à la suite exacte \ref{eq:ESSupport}, on obtient la suite exacte courte ci-dessous:
$$0\rightarrow \Gamma_Z(X,\Ff)\rightarrow \Gamma(X,\Ff)\rightarrow \Gamma(U,\Ff)\rightarrow 0$$

On choisit maintenant une résolution injective $\Ii^.$ de $\Ff$. Alors $\Ii^.$ est flasque et donc $\Ii^._{|U}$ aussi, on peut donc utiliser cette dernière pour calculer les groupes de cohomologie de $\Ff_{|U}$.   En utilisant la suite exacte courte ci-dessus on obtient une suite exacte courte de complexes de groupes abéliens:

$$0\rightarrow \Gamma_Z(X,\Ii^.)\rightarrow \Gamma(X,\Ii^.)\rightarrow \Gamma(U,\Ii^.)\rightarrow 0$$

Les techniques utilisées pour obtenir la suite exacte longue \ref{eq:longSES} s'appliquent dans la catégorie des groupes abéliens et on obtient ainsi une suite exacte longue:
\begin{equation}\label{eq:longSESSupport}
0\rightarrow H_Z^0(X,\Ff)\rightarrow H^0(X,\Ff)\rightarrow H^0(U,\Ff_{|U})\rightarrow  H_Z^1(X,\Ff)\rightarrow H^1(X,\Ff)\rightarrow H^1(U,\Ff_{|U})\rightarrow ...
\end{equation}


Remarquons enfin qu'avec les notations de l'exemple \ref{cohomsupportaffineex}, on a $\Gamma_Z(X, .)\circ\, \widetilde{}=\Gamma_\mathfrak{a}(.)$ en tant que foncteurs $A$-$\Mm od\rightarrow A$-$\Mm od$. On en déduit que le foncteur $\Gamma_\mathfrak{a}(.)$ est exact à gauche et que ses foncteurs dérivés à droite, notés $H_\mathfrak{a}^i$, sont égaux aux foncteurs $H_Z^i(X,.)\circ \widetilde{}$ . En effet, soit $\Ff \in \Aa b(X)$ et $M:=\Gamma(X,\Ff)$. Comme le tilde réalise une équivalence de catégories (voir \ref{}), il envoie une résolution injective de $M$ sur une résolution injective de $\Ff\simeq \widetilde{M}$. En utilisant cette dernière pour calculer les groupes de cohomologie de $\Ff$ à support dans $Z$, on obtient le résultat par l'égalité des foncteurs $\Gamma_Z(X, .)\circ\, \widetilde{}=\Gamma_\mathfrak{a}(.)$.

\subsubsection{Cohomologie sur un schéma affine}

L'objectif de cette partie est de montrer que les $\Oo_X$-module quasi-cohérents sur un schéma affine noetherien $X=\spec A$ sont acycliques. Le point clé sera de montrer que pour un $A$-module injectif $I$, le faisceau $\widetilde{I}$ est flasque. On commence par des préliminaires d'algèbre commutative:

\begin{thm}[de Krull]
Soit $A$ un anneau noetherien, $M\subset N$ des $A$-modules de type fini, et $\mathfrak{a}$ un idéal de $A$. Alors, la topologie $\mathfrak{a}$-adic sur $M$ est induite par la topologie $\mathfrak{a}$-adic sur $N$. En particulier, pour tout $n>0$, il existe $n'\geq n$ tel que $\mathfrak{a}^{n'}N\cap M\subset\mathfrak{a}^nM$.
\end{thm}
\begin{proof}
Voir \cite{atiyahmacdo} 10.11
\end{proof}

\begin{cor}\label{cohomAffLemme1}
$\mathfrak{a}$ un idéal de $A$, et $I$ un $A$-module injectif. Alors le sous-module $\Gamma_\mathfrak{a}(I)$ est aussi un $A$-module injectif.
\end{cor}
\begin{proof}
Voir \cite{Hartshorne} III.3.2
\end{proof}

\begin{lem}
Soit $A$ un anneau noetherien et $I$ un $A$-module injectif. Alors pour tout $f\in A$, la flèche de localisation $I\rightarrow I_f$ est surjective.
\end{lem}
\begin{proof}
Voir \cite{Hartshorne} III.3.3
\end{proof}

\begin{prop}\label{cohomAffProp1}
Soit $A$ un anneau noetherien et $I$ un $A$-module injectif. Alors le faisceau $\widetilde{I}$ est flasque.
\end{prop}
\begin{proof}
On prouve le résultat par induction noetherienne sur les fermés  non-vides de la forme $Y:=\overline{\supp \widetilde{I}}$ en utilisant le fait que $X$ est un espace topologique noetherien, c'est à dire que tout ensemble non-vide de fermés de $X$ admet un élément minimal. On remarque que le résultat est immédiatement vérifié si $Y$ est l'ensemble vide. Il suffit donc de montrer qu'étant donné un fermé $Y$ de la forme $\overline{\supp \widetilde{I}}$ on est ramené à montrer le résultat pour un fermé propre de $Y$ de même forme.

Supposons maintenant le résultat montré pour tout fermé propre de $Y:=\overline{\supp \widetilde{I}}$. Il est suffisant de montrer que $\Gamma(X,\widetilde{I})\rightarrow\Gamma(U,\widetilde{I})$ est surjectif pour tout ouvert $U\subset X$. Si $Y\cap U=\emptyset$ il n'y a rien à montrer. Sinon, il existe $f\in A$ tel que $X_f\subset U$ et $X_f\cap Y\neq \emptyset$. On note $Z= X\setminus X_f$, et on Considère le diagramme commutatif:

	\begin{center}
	\begin{tikzcd}
  		\Gamma(X,\widetilde{I}) \arrow[r, ""] & \Gamma(U,\widetilde{I}) \arrow[r, ""] & \Gamma(X_f,\widetilde{I})\\ 
  		\Gamma_Z(X,\widetilde{I}) \arrow[u, hook, ""] \arrow[r, ""] & \Gamma_Z(U,\widetilde{I}) \arrow[u, hook, ""] &
	\end{tikzcd}\\
	\end{center}
Soit une section $s\in\Gamma(U,\widetilde{I})$, et $s'$ son image dans $\Gamma(X_f,\widetilde{I})$. D'après le lemme précédent et \ref{}, $s'$ admet un antécédent $t\in \Gamma(X,\widetilde{I})$. On note $t'$ la restriction de $t$ à $U$. Alors $s-t'$ se restreint en la section nulle sur $X_f$, et a donc support dans $Z$. Si on peut trouver un antécédent $u$ de $s-t'$ dans $\Gamma_Z(X,\widetilde{I})$, alors $t+u$ est antécédent de $s$ dans $\Gamma(X,\widetilde{I})$. On est donc ramenés à prouver la surjectivité de $\Gamma_Z(X,\widetilde{I})\rightarrow\Gamma_Z(U,\widetilde{I})$.

Posons $J=\Gamma_Z(X,\widetilde{I})$, et $\mathfrak{a}=fA$. Alors d'après l'exemple \ref{cohomsupportaffineex}, on a $J=\Gamma_\mathfrak{a}(I)$. Puis d'après \ref{cohomAffLemme1}, $J$ est un $A$-module injectif. Enfin, le support de $\widetilde{J}$ est contenu dans $Y\cap Z$ qui est fermé propre de $Y$. Par hypothèse de récurrence, on obtient donc que $\widetilde{J}$ est flasque. Mais toujours d'après l'exemple \ref{cohomsupportaffineex}, on a $\widetilde{J} = \Hh ^0 _Z(\Ff)$ ce qui termine la preuve.
\end{proof}


\begin{thm}\label{cohomoaffine}
Soit $X=\spec A$ un schéma affine noetherien. Alors pour tout faisceau quasi-cohérent $\Ff$ sur $X$, et pour tout $i>0$, on a $H^i(X,\Ff)=0$. 
\end{thm}
\begin{proof}
Soit $M=\Gamma(X,\Ff)$, et $M\rightarrow I^.$ une résolution injective de $M$. On obtient d'après \ref{} une résolution injective $\Ff\simeq \widetilde{M}\rightarrow \widetilde{I}^.$ de $\Ff$ dans la catégorie des $\Oo_X$-modules quasi-cohérents. Or cette résolution est flasque d'après \ref{cohomAffProp1}. Cela suffit à montrer le théorème car une résolution flasque de faisceau est acyclique, et peut être utiliser pour calculer la cohomologie.
\end{proof}

\subsubsection{Une application}

On introduit la notion de profondeur d'un $A$-module $M$ relative à un idéal $\mathfrak{a}\subset A$ et on en donne une interprétation en termes de cohomologie à support. On en déduit un corollaire qui donne une réciproque à \ref{extregularnormal} et nous sera utile par la suite.

\begin{defn}[suite $M$-régulière]
Soit $A$ un anneau, $M$ un $A$-module. Une suite $x_1,...,x_r$ d'éléments de $A$ est $M$-régulière si $x_1$ est $M$-régulier, et pour tout $i=2,...,r$, $x_i$ est $M/(x_1,...,x_r)M$-régulier.
\end{defn}

\begin{defn}[Profondeur]
Soit $A$ un anneau, $M$ un $A$-module et $\mathfrak{a}\subset A$ un idéal. La $\mathfrak{a}$-profondeur de $M$ est la longueur maximale des suites régulières de $M$ contenues dans $\mathfrak{a}$.
\end{defn}



\begin{prop}
Soit $A$ un anneau noetherien, $\mathfrak{a}$ un idéal, et $M$ un $A$-module de type fini. Alors pour tout $n\geq 0$, les conditions suivantes sont équivalentes:
\begin{enumerate}
\item $\depth_\mathfrak{a} M\geq n$.
\item $H_\mathfrak{a}^i(M)=0$ pour tout $i<n$.
\end{enumerate}
\end{prop}
\begin{proof}
Montrons cette équivalence par récurrence. Le cas $n=0$ est trivial, mais nous aurons besoin du cas $n=1$ dans la récurrence, on le démontre maintenant. Supposons $n=1$, et $\depth_\mathfrak{a} M\geq 1$. Alors il existe $x\in\mathfrak{a}$ tel que $x$ n'est pas diviseur de zéro de $M$. Soit $m\in \Gamma_ \mathfrak{a}(M)$, ainsi il existe $k\geq 0$ tel que $\mathfrak{a}^k m=0$. En particulier, $x^nm=0$, ce qui prouve $m=0$. D'où $H^0_\mathfrak{a}(M)=0$. Réciproquement, supposons $H^0_\mathfrak{a}(M)=0$. Cela signifie que pour tout $m\in M$ et $k\geq 0$, il existe $x\in \mathfrak{a}^k$ tel que $mx\neq 0$. Ainsi, d'après \ref{AssociatedPrimesProp2} on peut trouver un $x\in \mathfrak{a}$ qui n'est pas diviseur de zéro de $M$, c'est à dire $\depth_\mathfrak{a}M\geq 1$.

Supposons maintenant le résultat acquis pour $n\geq 1$. Pour le sens direct on suppose $\depth_\mathfrak{a} M\geq n+1$. Compte tenu de l'hypothèse de récurrence il reste à montrer que $H^n_\mathfrak{a}(M)=0$. Choisissons $x\in \mathfrak{a}$ égal au premier terme d'une suite $M$-régulière de longueur $n+1$, ce qui est possible par hypothèse. Alors $x$ n'est pas diviseur de zéro de $M$ et $\depth_\mathfrak{a} M/xM \geq n$. On considère alors la suite exacte de $A$-modules:
$$0\rightarrow M \xrightarrow{x.} M\rightarrow M/xM\rightarrow 0$$

\noindent et la suite exacte longue de cohomologie associée:

$$..\rightarrow H^{n-1}_\mathfrak{a}(M/xM) \rightarrow H^n_\mathfrak{a}(M) \xrightarrow{x.}  H^n_\mathfrak{a}(M) \rightarrow ...$$

\noindent Comme $H^{n-1}_\mathfrak{a}(M/xM)=0$ par hypothèse de récurrence, l'application $H^n_\mathfrak{a}(M) \rightarrow  H^n_\mathfrak{a}(M)$ est injective. Or ceci ne peut être le cas que si $H^n_\mathfrak{a}(M)=0$ car on peut remarquer que $H^n_\mathfrak{a}$ est un quotient d'un $\Gamma_\mathfrak{a}(N)$ pour un module $N$, ses éléments sont donc annulés par des puissances de $x$. 

Montrons maintenant la réciproque. On suppose $H^i_\mathfrak{a}(M)=0$ pour tout $i<n+1$. Par hypothèse de récurrence et comme $n\geq 1$, il existe $x\in \mathfrak{a}$ qui n'est pas diviseur de zéro pour $M$. On peut à nouveau utiliser la suite exacte longue ci-dessus et en déduire immédiatement que $H^{i}_\mathfrak{a}(M/xM)=0$ pour $i<n$. Ainsi, $\depth_\mathfrak{a} M/xM\geq n$, ce qui montre $\depth_\mathfrak{a} M \geq n+1$.
\end{proof}

\begin{cor}\label{cohomcodimgeq2}
Soit $X$ une variété affine et $Z\subset X$ un fermé tel que la restriction $\Oo(X)\rightarrow \Oo(X\setminus Z)$ soit un isomorphisme. Alors $Z$ est de codimension au moins $2$ dans $X$.
\end{cor}
\begin{proof}
On pose $U:=X\setminus Z$ et on utilise la suite exacte longue \ref{eq:longSESSupport}. Compte tenu de l'hypothèse et de \ref{cohomoaffine} on obtient que $H^0_Z(X,\Oo_X)=H^1_Z(X,\Oo_X)=0$. D'après la propriété précédente cela donne $\depth_\mathfrak{a}(\Oo(X))\geq 2$, où $\mathfrak{a}:=\Ii(Z)$. Mais d'après, \ref{dimsousvariete} on obtient facilement $\codime_X(Z)\geq \depth_\mathfrak{a}(\Oo(X))$.
\end{proof}


\subsection{Faisceaux inversibles, Fibrés en droites}
\begin{defn}
Soit $X$ une variété. Un faisceau inversible $\Ll$ sur $X$ est un $\mathcal{O}_X$-module localement libre de rang 1. Autrement dit, tout point $x\in X$ admet un voisinage ouvert $U \subset X$ tel que ${\mathcal L}|_U$ est isomorphe à ${\mathcal O}_U$.
\end{defn}

On peut toujours trivialiser deux faisceaux inversibles sur un même recouvrement ouvert de $X$. On voit ainsi que le produit tensoriel sur $\mathcal{O}_X$ de faisceaux inversibles est inversible. Par ailleurs, le faisceau dual $\Ll^\vee:=\Hh om(\Ll,\Oo_X)$ est clairement inversible car sur les ouverts $U$ où $\Ll$ est trivial, se donner un morphisme $\Ll_{|U}\rightarrow\Oo_{|U}$ revient à se donner une section de $\Oo(U)$. De plus, l'application naturelle $\Ll\otimes_{\Oo_X} \Hh om(\Ll,\Oo_X)\rightarrow \Oo_X, (s,f)\mapsto f(s)$ est un isomorphisme. Ainsi, les classes d'isomorphie de faisceaux inversible sur $X$ munies du produit tensoriel forment un groupe appelé groupe de Picard de $X$, noté $\pic(X)$. 

\begin{ex}\label{expicaff}
Soit $X=\spec (A)$ irréductible. Alors se donner un faisceau inversible sur $X$ revient (à isomorphisme près) à se donner un idéal fractionnaire $I$ de $k[X]$ qui est inversible (cf \ref{ideauxinversibles}), son inverse est alors $I^{-1}:=(A:I)$. Les idéaux fractionnaires inversibles donnant le faisceau inversible trivial sont les idéaux fractionnaires principaux. Le groupe de Picard de $X$ est ainsi isomorphe au groupe des idéaux fractionnaires inversibles modulo les idéaux fractionnaires principaux. Les idéaux de $A$ qui sont inversibles forment une partie génératrice de ce groupe. 

Si de plus $A$ est localement factoriel, par exemple si $X$ est lisse, les idéaux inversibles sont les idéaux de hauteur 1 pure, c'est à dire tels que ses idéaux premiers associés sont tous de hauteur 1. De plus tout idéal inversible s'écrit de manière unique comme produit de puissances d'idéaux premiers de hauteur 1. Pic(X) est donc le quotient du groupe libre sur les idéaux premiers de hauteur 1 par les idéaux fractionnaires principaux.
\end{ex}

On va maintenant voir que les faisceaux inversibles sur $X$ s'incarnent naturellement en des variétés sur $X$, ce sont les fibrés en droites.

\begin{defn}[Fibré en droites, morphismes, faisceau des sections]\label{linebundle}
Soit $X$ une variété. Un fibré en droite sur $X$ est une variété $L$ munie d'un morphisme $\pi:L\rightarrow X$ tel que $X$ admet un recouvrement ouvert $(U_i)_{i\in I}$ satisfaisant:

\begin{enumerate}
\item $\forall i\in I$, il existe un isomorphisme $\phi_i :\pi^{-1}(U_i)\rightarrow U_i\times\AAA^1$ de variétés sur $U_i$.
\item $\forall i, j\in I$, l'isomorphisme $\phi_j\circ \phi_i^{-1}: (U_i\cap U_j)\times \AAA^1\rightarrow (U_i\cap U_j)\times \AAA^1$ est de la forme $(x, z)\mapsto (x, a_{ij}(x)z)$.
\end{enumerate}
Un morphisme de fibrés en droites sur $X$ est un morphisme de variétés sur $X$ avec la conditions supplémentaire que les morphismes induits sur les fibres soient linéaires.
Une section d'un fibré en droites $(L, \pi)$ est une section de $\pi$, et on a la version locale de cette notion.
\end{defn}

On constate qu'un fibré en droite $(L,\pi)$ sur $X$ est obtenu en recollant des fibrés en droites de la forme $U_i\times \AAA^1\rightarrow U_i$ appelés fibrés triviaux via des automorphismes linéaires sur les intersections définis par des fonctions $a_{ij}\in \Oo(U_i\cap U_j)^*$, dites de transition. De plus, un automorphisme de fibré en droites est donnée par une fonction $f\in \Oo(X)^*$. En effet, localement il s'agit d'automorphismes de fibrés triviaux qui sont nécessairement de cette forme.

Considérons un faisceau inversible $\Ll$ sur $X$ trivialisé sur un recouvrement affine $(U_i)_{i\in I}$ avec un générateur $s_i\in\Ll(U_i)$ sur chaque $U_i$. Sur $U_i\cap U_j$, on a $s_j=a_{ij}s_i$ avec $a_{ij} \in \mathcal{O}_X(U_i\cap U_j)^\times$. On considère au dessus de chaque $U_i$ le fibré trivial $(U_i\times\AAA^1, \pi_i)$, et on les recolle avec des isomorphismes définis par $\mathcal{O}_X(U_i\cap U_j)\otimes_k k[t]\rightarrow \mathcal{O}_X(U_i\cap U_j)\otimes k[u]$, $f\otimes_k 1\mapsto f\otimes_k 1$, $1 \otimes_k t \mapsto a_{ij}\otimes_k u$. On a ainsi construit un fibré en droites sur $X$.

Réciproquement, considérons le $\mathcal{O}_X$-module des sections d'un fibré en droite $L$ sur $X$. Sur les ouverts $U_i$ où $L$ est trivialisé on voit que les sections forment un faisceau isomorphe à $\mathcal{O}_{X|U_i}$. En effet se donner une section sur $U_i$ revient à se donner un morphisme $U_i\rightarrow \AAA^1$, c'est à dire un élément de $\mathcal{O}_X(U_i)$. C'est donc un faisceau inversible. Les sections globales de $L$ s'identifie via les trivialisations locales aux familles $(f_i)_{i\in I}$ telles que $f_i=a_{ij}f_j$ sur $U_i\cap U_j$. En effet, un telle section donne sur les intersections $U_i\cap U_j$ un diagramme commutatif:

	\begin{center}
	\begin{tikzcd}
  		U_i\cap U_j\times \AAA^1 \arrow[rr, "\id\times m_{a_{ij}}"] & & U_i\cap U_j\times \AAA^1 \arrow[ld, ""] \\ 
  		& U_i\cap U_j \arrow[ul, "\id\times f_i"] \arrow[ur, swap, "\id\times f_j"] &
	\end{tikzcd}
	$\,\,\,\,\,\,\,\,\,$ où $m_{a_{ij}}$ est la multiplication par $a_{ij}$ 
	\end{center}

En composant les deux opérations on trouve le faisceau inversible dual du faisceau de départ, car les sections de $L$ s'identifient naturellement à des éléments de $\Hh om(\Ll,\Oo_X)$, et on a particulier $\Gamma(X,L)=\Gamma(X,\Ll^\vee)$. Ces opérations sont fonctorielles et réalisent une anti-équivalence de catégorie entre faisceaux inversibles sur $X$ et fibrés en droites sur $X$. Cela permet de transporter la structure du groupe de Picard sur les classes d'isomorphie de fibrés en droites. En particulier, on définit le fibré dual $L^{^-1}$ de $L$ comme le fibré en droites construit à partir de $\Ll^\vee$. Il est défini par les fonctions de transition $a_{ij}^{-1}$.

\begin{rem}
Si on se donne un faisceau inversible $\Ll$ sur une variété $X$, le fibré en droites qu'on lui associe dans la discussion précédente n'est autre que $\spec_X(\sym(\Ll))$, où $\sym(\Ll))$ est l'algèbre symétrique associée à $\Ll$ sur $\mathcal{O}_X$. En effet, on recolle les $\spec_{U_i}(\sym(\Ll)_{|U_i}))\simeq\spec_{U_i}( \mathcal{O}_{U_i}[t])\simeq U_i \times_k \AAA^1_k$, où $(U_i)_i$ est un recouvrement qui trivialise $\Ll)$.
\end{rem}

Soit $(L,\pi)$ un fibré en droite sur $X$, et $f:X'\rightarrow X$ un morphisme de variétés. L'image inverse de $f^*(L)$ est le produit fibré $X'\times_X L$ muni de sa projection vers $X'$. C'est un fibré en droites sur $X'$, en effet c'est un recollement des fibrés triviaux $f^{-1}(U_i)\times \AAA^1\rightarrow f^{-1}(U_i)$ via les fonctions de transition $f^\sharp(a_{ij})$. Si on a $L=\spec_X(\sym(\Ll))$ pour un faisceau inversible $\Ll$, on constate que $f^*(L)$ est le fibré en droites construit à partir du faisceau inversible $f^*(\Ll)$. Enfin, si on se donne un morphisme $\phi:(L_1,\pi_1)\rightarrow (L_2,\pi_2)$ de fibrés en droites sur $X$ et un morphisme de variétés $f:X'\rightarrow X$ on définit l'image inverse $f^*(\phi)$ comme l'unique morphisme faisant commuter le diagramme ci-dessous:

	\begin{center}
	\begin{tikzcd}
  		f^*(L_1)=X'\times_X L_1 \arrow[r, ""] \arrow[rd, dashed, "f^*(\phi)"] \arrow[rdd, bend right, ""] & L_1 \arrow[rd, bend left, "\phi"] &\\ 
  		& f^*(L_2)=X'\times_X L_2 \arrow[r, ""]  \arrow[d, ""] & L_2 \arrow[d, "\pi_2"] \\ 
		& X' \arrow[r, "f"] & X
	\end{tikzcd}
	\end{center}

\begin{rem}\label{remfibsectionsglobales}
Notons qu'un fibré en droites $(L, \pi)$ est muni d'une action de $\GG_m$, c'est l'action de multiplication par les scalaires dans les fibres. L'ensemble $L_0$ des points fixes sous $\GG_m$ est le fermé correspondant à l'image de la section nulle. Son complémentaire $L^\times:=L\setminus L_0$ est une $\GG_m$-variété et $\pi$ se restreint en $\pi^\times: L^\times \rightarrow X$ qui est un quotient géométrique. En effet sur les $U_i$, on a $\pi^{\times-1}(U_i) \simeq U_i\times_k \GG_m$ et l'action de $\GG_m$ se fait par multiplication sur le facteur de droite. Cette action sur $L$  se traduit par une graduation du faisceau d'algèbres $\pi_*\Oo_L=\sym\Ll=\oplus_{n\geq 0}\Ll^{\otimes n}$ sur $X$. Le sous-espace de poids $1$ de $\Oo(L)=\pi_*\Oo_L(X)$ s'identifie alors à $\Gamma(X,L^{-1})$.
\end{rem}



\subsection{$G$-linearisation d'un fibré en droite}

Dans cette section on se pose la question de la possibilité d'étendre une action d'un groupe algébrique $G$ sur une variété $X$ à un fibré en droite $(L,\pi)$ sur $X$ tout en préservant la structure du fibré. C'est la notion de $G$-linéarisation. 

\begin{defn}
Soit $G$ un groupe algébrique, $X$ une $G$-variété, et $(L,\pi)$ un fibré en droites. Une $G$-linéarisation de  $(L,\pi)$ est une action de $G$ sur $L$ telle que $\pi$ est $G$-équivariante et pour tout $(g,x)\in G\times X$ l'application $L_x\rightarrow L_{g.x},\, l\mapsto g.l$ est linéaire.
\end{defn}

Autrement dit, le morphisme associé à une $G$-linéarisation est à valeurs dans le groupe d'automorphisme de fibrés en droites de $(L,\pi)$. On note $\alpha: G\times X\rightarrow X$ l'action de $G$ sur $X$ et $p_2:G\times X\rightarrow X$ la projection sur $X$. Pour tout $g\in G$ on a une application:
$$g\times \id: X\rightarrow G\times X,\,\, x\mapsto (g,x)$$ 
Les images inverses de ces deux fibrés en droites par cette application sont explicitement: 
$$(g\times \id)^*\alpha^*(L)=X\times_{G\times X}(G\times X)\times_X L=\lbrace (x,(g',x'),l)\mid \alpha(g',x')=\pi(l)\text{ et } (g,x)=(g',x')\rbrace$$
$$(g\times \id)^*p_2^*(L)=X\times_{G\times X}(G\times X)\times_X L=\lbrace (x,(g',x'),l)\mid x'=\pi(l)\text{ et } (g,x)=(g',x')\rbrace$$
On obtient ainsi des isomorphismes canoniques $(g\times \id)^*\alpha^*(L)\simeq g^*L$ et $(g\times \id)^*p_2^*(L)\simeq L$, où $g^*L$ est l'image inverse de $L$ par l'automorphisme de $X$ associé à l'action de $g$, et on fait ces identifications par la suite. Ainsi, vu la discussion suivant \ref{linebundle}, tout morphisme de fibrés en droites $\Phi: \alpha^*(L)\rightarrow p_2^*(L)$ induit pour tout $g\in G$ un morphisme $\Phi_g:g^*(L)\rightarrow L$.

\begin{lem}
Avec les notations ci-dessus, on a une correspondance bijective entre les $G$-linéarisations de $L$ et les isomorphismes
$$\Phi: \alpha^*(L)\rightarrow p_2^*(L)$$
de fibrés en droites sur $G\times X$ tels que $\Phi_{gh}=\Phi_h\circ h^*(\Phi_g)$ pour tous $g,h\in G$.
\end{lem}
\begin{proof}
Soit $\beta:G\times L\rightarrow L$ une $G$-linéarisation. Par définition, on a un diagramme commutatif:
	\begin{center}
	\begin{tikzcd}
  		G\times L \arrow[r, "\beta"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}\\
	\end{center}
Par la propriété universelle du produit fibré on a donc un morphisme $\gamma:G\times L\rightarrow\alpha^*(L)$ de variétés sur $G\times X$. On remarque que l'on a un isomorphisme canonique $G\times L\rightarrow p_2^*(L),\, (g,l)\mapsto ((g,\pi (l)),l)$. Avec cette identification, $\gamma$ s'écrit explicitement $\gamma(g,l)=((g,\pi(l)),\beta(g,l))$. C'est un isomorphisme car on a un inverse évident $\Phi((g,x),l)=(g,\beta(g^{-1},l))$. Pour $g\in G$ fixé, l'image inverse de $\gamma$ par $g\times \id$ est simplement $\gamma_g:L\rightarrow g^*L, l\mapsto (\pi(l),\beta(g,l))$. Soit maintenant $h\in G$, et on note également $h$ l'automorphisme de $X$ donné par son action. En tenant compte des identifications précédentes on a pour $l\in L$ les formules $h^*(\gamma_g)\circ\gamma_h(l)=h^*(\gamma_g)(\pi(l),\beta(h,l))=(\pi(l),\beta(g,\beta(h,l)))=(\pi(l),\beta(gh,l))=\gamma_{gh}(l)$. Ainsi, $\Phi$ satisfait la condition de l'énoncé.

Réciproquement, étant donné un $\Phi$ comme dans l'énoncé, on note $\gamma:=\Phi^{-1}$ et $p_L:\alpha^*(L)\rightarrow L$ la projection sur $L$. On a alors un morphisme $\beta:=p_L\circ\gamma : G\times L \rightarrow L$. La condition sur $\Phi$ exprime qu'il s'agit d'une action de $G$  sur $L$. Enfin, pour $g\in G$ fixé, $p_L\circ \gamma_g$ est un automorphisme de $(L,\pi)$, autrement dit on obtient un diagramme commutatif comme ci-dessus. On a donc bien une $G$-linéarisation.
\end{proof}

\begin{lem}\label{existenceGLin}
Soient $G$ un groupe algébrique connexe, $X$ une $G$-variété irréductible, et $(L,\pi)$ un fibré en droites sur $X$. Alors $L$ admet une $G$-linéarisation si et seulement si $\alpha^*(L)$ et $p_2^*(L)$ sont isomorphes en tant que fibrés en droites sur $G\times X$.
\end{lem}
\begin{proof}
L'implication directe est contenue dans le lemme précédent. Pour la réciproque, on considère un isomorphisme $\Phi:\alpha^*(L)\rightarrow p_2^*(L)$ de fibrés en droites sur $G\times X$. Comme $\alpha(e,x)=x$ pour tout $x\in X$, on a une identification canonique $(e\times \id)^*\alpha^*(L)\simeq L$, d'où un automorphisme $(e\times \id)^*(\Phi):L\rightarrow L$ de fibré en droites. Cet automorphisme est donné d'après \ref{linebundle} par une fonction $f\in \Oo(X)^*$. En remplaçant $\Phi$ par $\Phi\circ p_2^\sharp(f^{-1})$, on peut supposer $f=1$. On obtient ainsi un morphisme  $\beta: G\times L \rightarrow L$ qui satisfait le diagramme commutatif suivant:
	\begin{center}
	\begin{tikzcd}
  		G\times L \arrow[r, "\beta"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}\\
	\end{center}
De plus, on a modifié $\Phi$ de telle manière que l'on ait $\forall l\in L,\,\beta(e,l)=l$. Il reste maintenant à prouver que la condition d'associativité d'une action de groupe est satisfaite. On note $\beta_1:G\times G\times X\rightarrow X, (g,h,x)\mapsto \beta(g,\beta(h, x))$, $\beta_2:G\times G\times X\rightarrow X, (g,h,x)\mapsto \beta(gh, x)$, et par abus $\alpha:G\times G\times X\rightarrow X, (g,h,x)\mapsto \alpha(gh, x)$. On obtient deux diagrammes commutatifs:
	\begin{center}
	\begin{tikzcd}
  		G\times G\times L \arrow[r, "\beta_1"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}
	\,\,\,\,\,\,\,\,\,\,\,\,
	\begin{tikzcd}
  		G\times G\times L \arrow[r, "\beta_2"] \arrow[d, "id\times\pi"]& L\arrow[d, "\pi"] \\ 
  		G\times G\times X \arrow[r, "\alpha"] & X
	\end{tikzcd}
	\end{center}
	On obtient ainsi deux isomorphismes $\gamma_1:G\times G\times L\rightarrow\alpha^*(L), (g,h,l)\mapsto ((g,h,\pi(l)), \beta_1(g,h,l))$ et $\gamma_2:G\times G\times L\rightarrow\alpha^*(L), (g,h,l)\mapsto ((g,h,\pi(l)), \beta_2(g,h,l))$. La condition d'associativité correspond à $\gamma_1\gamma_2^{-1}=\id$. Or $\gamma_1\gamma_2^{-1}$ est un automorphisme du fibré en droite $(G\times G\times L,\id\times \pi)$, donc correspond à une fonction $\phi\in \Oo(G\times G\times X)^*$. D'après \ref{}, il existe $\chi\in X^*(G\times G)$ et $\psi\in\Oo(X)^*$ tels que $\phi(g,h,x)=\chi(g,h)\psi(x)$ pour tout $g,h\in G$ et $x\in X$. En évaluant en $g=h=e$ on obtient $\psi=1$, puis comme $\phi(g,e,x)=1=\phi(e,g,x)$ pour tout $g\in G$ et $x\in X$, on obtient $\chi(g,e)=\chi(e,g)$ pour tout $g\in G$. Comme l'application naturelle $X^*(G)\times X^*(G)\rightarrow X^*(G\times G)$ est un isomorphisme, on conclut que $\chi=1$ et donc $\phi=1$, ce qui termine la preuve.
\end{proof}

\begin{prop}\label{GmoduleSectionsGlobalesGlin}
Soit $X$ une $G$-variété et $L$ un fibré en droite $G$-linéarisé sur $X$. Alors le $k$-ev des sections globales $\Gamma(X, L)$ a une structure naturelle de $G$-module.
\end{prop}
\begin{proof}
Comme $L^{-1}$ admet aussi une $G$-linéarisation d'après \ref{}, il s'agit d'une $G\times \GG_m$-variété où l'action de $\GG_m$ est l'action naturelle sur les fibres par multiplication. D'après \ref{GmoduleSectionsGlobales}, $\Oo(L^{-1})$ est un $G\times \GG_m$-module, donc en particulier un $\GG_m$-module. Le sous-espace de poids $1$ pour l'action de $\GG_m$ de ce module est $\Gamma(X, L)$ d'après \ref{remfibsectionsglobales}. Il est facile de vérifier que ce sous-espace est stable par l'action de $G$, ce qui en fait un $G$-module.
\end{proof}

\section{Diviseurs}

\subsection{Diviseurs de Weil}

En se rappelant le résultat \ref{extregularnormal}, on voit que la "géométrie en codimension 1" d'une variété normale, c'est à dire le comportement des fonctions sur les fermés irréductibles de codimension 1, contient beaucoup d'information sur la variété. Ces fermés sont appelés des diviseurs premiers, on va voir qu'ils permettent de définir un invariant particulièrement intéressant de la variété, et fondamental pour la construction de l'anneau de Cox, c'est le groupe des classes. Notre cadre est celui d'une variété normale que l'on supposera de plus irréductible pour plus de simplicité, suivant la remarque \ref{normaluniondisjointe}.

\begin{defn}[Diviseur premier, diviseur de Weil, diviseur effectif]
Soit $X$ une variété normale irréductible. Un diviseur premier $D$ est une sous-variété fermée irréductible de codimension 1. On définit $\wdiv(X)$ le groupe libre engendré par les diviseurs premiers. Un élément de $\wdiv(X)$ est appelé un diviseur de Weil. Enfin, un diviseur est dit effectif si il est à coefficients $\geq 0$. 
\end{defn}
On introduit maintenant pour chaque diviseur premier $D$ une valuation sur $k(X)$ donnant des informations sur le comportement des fonctions rationnelles en $D$. C'est l'analogue de l'ordre d'un zéro ou d'un pôle d'une fonction rationnelle de la droite affine en un point. Soit $\eta$ le point générique de $D$, et $\mathcal{O}_{\eta,X}$ son anneau local. Par hypothèse et grâce aux propriétés de la localisation, il est noethérien normal et de dimension 1, c'est donc un anneau de valuation discrète. La valuation associée $v_D:k(X)\rightarrow \ZZ$ donne par définition l'ordre d'annulation d'une fonction rationnelle le long de $D$. La propriété ci-dessous montre que les fonctions rationnelles permettent de définir des diviseurs de Weil.

\begin{prop}\label{noetherienPWDivBienDef}
Soit $X$ une variété normale et irréductible et $f\in k(X)^*$. Alors $v_D(f)=0$ sauf pour un nombre fini de diviseurs premiers $D$.
\end{prop}
\begin{proof}
Soit $f=g/h\in k(X)^*$, où l'on peut supposer $X=\spec A$ affine. Comme $v_D(f)=v_D(g)-v_D(h)$, on peut supposer $f\in A$, et non-inversible. Soit $D$ un diviseur premier et $\mathfrak{p}$ son point générique. Si $f\in A_\mathfrak{p}^*$ alors $v_D(f)=0$. Sinon, $f\in \mathfrak{p}$ et donc $D \subset \mathcal{V}_X(f)$. Or, d'après \ref{factonormal} et \ref{AssociatedPrimesProp1}, les éléments minimaux du support de $A/(f)$ sont en bijection avec les idéaux premiers associés à $(f)$, qui sont tous de hauteur $1$. On en déduit que les composantes irréductibles $Z_i$ de $\mathcal{V}_X(f)$ qui leur correspondent sont des diviseurs premiers, en nombre fini. Ainsi $v_D(f)=0$ à moins que $D$ ne soit l'un des $Z_i$.
\end{proof}

Ainsi l'application $k(X)^*\rightarrow \wdiv(X),\, f\mapsto $ div$(f):=\sum_D v_D(f)D$ définit un morphisme de groupes. Son image est le \textit{groupe des diviseurs principaux} noté PDiv$(X)$. La relation modulo PDiv$(X)$ s'appelle \textit{l'équivalence linéaire}, et le groupe quotient Cl$(X)$ est le \textit{groupe des classes de diviseurs}.\\
Cl$(X)$ est un invariant en général difficile à calculer. Ci-dessous on liste quelques outils et exemples.


\begin{prop}\label{AffUFDClgTrifial}
Soit $X=\spec(A)$ une variété affine normale et irréductible. Alors $A$ est factoriel si et seulement si $\clg(X)=0$
\end{prop}
\begin{proof}
C'est une conséquence de \ref{factonormal} et \ref{UFDPID}. Voir \cite{Hartshorne} II.6.2.
\end{proof}

\begin{cor}
$\clg(\mathbb{A} ^n_k)=0$ pour $n\geq 1$
\end{cor}

\begin{thm}\label{divexactseq}
Soit $X$ une variété normale et irréductible et $Z$ une sous-variété fermée propre. On pose $U:=X\setminus Z$. Alors:
\begin{enumerate}
\item Cl$(X)\rightarrow$ Cl$(U)$ défini par $\sum_i n_iD_i\mapsto \sum_i n_i(D_i\cap U)$, avec $D_i\cap U = 0$ si $D_i\cap U=\emptyset $, est un morphisme de groupe surjectif.
\item Si codim$(Z,X)\geq 2$, alors $\clg(X)\rightarrow \clg(U)$ est un isomorphisme.
\item Soient $D_1,..., D_s$ les composantes irréductibles de $Z$ qui sont des diviseurs. Alors la suite ci-dessous exacte $$\bigoplus_{j=1}^s \ZZ D_j \xrightarrow{\pi} \clg(X) \xrightarrow{.\cap U} \clg(U) \rightarrow 0 $$
\end{enumerate}
\end{thm}
\begin{proof}
\begin{enumerate}
\item Si $D\cap U\neq \emptyset$ alors $\dim X=\dim U$ et $\dim D=\dim D\cap U$ car ce sont des ouverts de variétés irréductibles donc la dimension est préservée. Ainsi cela définit une application $\wdiv(X)\rightarrow \wdiv(U)$ qui est un morphisme par construction. De plus, comme un diviseur principal est envoyé sur un diviseur principal, on a bien le morphisme attendu. Il est surjectif car pour tout $D\in\wdiv(U)$ premier, on a $D=\overline{D}\cap U$.
\item Dans ce cas on ne peut avoir $D\subset Z$ cause de la dimension donc $D\cap U\neq \emptyset$. Ainsi, le noyau du morphisme WDiv$(X)\rightarrow$ WDiv$(U)$ est exactement PDiv$(X)$ d'où l'isomorphisme.
\item Le noyau de $.\cap U$ est exactement l'ensemble des $\pi(D)$ où $D$ est un diviseur dont le support est contenu dans $X\setminus U=Z$, d'où le résultat.
\end{enumerate}
\end{proof}

\subsection{Faisceau d'algèbres divisorielles}

La proposition suivante montre que l'on peut caractériser les sections du faisceau structural de $X$ en terme de diviseurs.

\begin{prop}\label{caracfaisceaustructdiv}
Soit $X$ une variété normale et irréductible et $f\in k(X)^*$. Alors 
\begin{enumerate}
\item div$(f)\geq 0\iff f \in\Oo_X(X)$
\item div$(f)= 0\iff f\in\Oo_X(X)^\times$
\end{enumerate}
\end{prop}
\begin{proof}
Il est suffisant de vérifier ces propriétés localement sur les ouverts affines. Or dans ce cas, $f$ est une section globale si et seulement si $f$ appartient à tous les anneaux locaux des diviseurs premier d'après \ref{factonormal}. Cette dernière condition revient à dire que div$(f)$ est effectif, cela prouve 1).  \\
Pour la deuxième assertion, on remarque que div$(f)=0\iff$div$(f)\geq 0$ et div$(f^{-1})\geq 0$.
\end{proof}

Plus généralement, on définit pour chaque diviseur $D$ un $\Oo_X$-module $\Oo_X(D)$ dont les sections sur un ouvert $U\subset X$ sont définies par $$\Gamma(U,\Oo_X(D)):=\lbrace f\in k(X)^* \mid (\textrm{div}(f)+D)_{|U}\geq 0\rbrace\cup \lbrace 0 \rbrace$$
On vérifie, grâce aux propriétés des valuations $v_D$, qu'il s'agit d'un sous $\Oo_X(U)$-module de $k(X)$, autrement dit un idéal fractionnaire de $\Oo_X(U)$, pour tout ouvert affine $U$. C'est donc un sous $\Oo_X$-module de la  $\Oo_X$-algèbre $k(X)$. Dans le cas où $X$ est affine on a une description explicite des sections globales:

\begin{prop}\label{divaff}
Soit $X$ une variété affine normale et irréductible, $A:=k[X]$. 
\begin{enumerate}
\item Soit un diviseur de Weil $D=a_{p_1}Y_{p_1}+...+a_{p_r}Y_{p_r}$, on a $\Gamma(X,\Oo_X(D))=\bigcap_{ht(p)=1}p^{-a_p}A_p$, où $a_p=0$ si $p\notin \lbrace p_1,...,p_r\rbrace$.
\item Soit $(Y_i)_{i\leq r}$ des diviseurs premiers de Cartier et $D=a_{p_1}Y_{p_1}+...+a_{p_r}Y_{p_r}$, on a $\Gamma(X,\Oo_X(D))=\prod_{i=1}^n p^{-a_p}$.
\item Pour un diviseur premier $Y_p$, on a $\Gamma(X,\Oo_X(-Y_p))=p$. Si de plus $p$ est inversible et $a\in \ZZ$, on a $\Gamma(X,\Oo_X(aY_p))=p^{-a}$.
\end{enumerate}
\end{prop}
\begin{proof}
\begin{enumerate}
\item Pour tout idéal premier $p$ de hauteur 1, $A_p$ est un DVR. On a donc $pA_p=(\pi)$ pour un certain $\pi \in A_p\subset k(X)$. Pour tout entier $a\in \ZZ$, on définit un sous $A_p$-module de $k(X)$ isomorphe à $pA_p$ en posant $p^aA_p:= (\pi^a)$. C'est un idéal fractionnaire de $A_p$ et on a pour $f\in k(X)^*$, $v_{Y_p}(f)\geq a \iff f\in p^a A_p$.
Or, $f\in \Gamma(X,\Oo_X(D)) \iff $ div$(f)\geq -D \iff v_{Y_p}(f)\geq -a_p$, pour tout $p$ de hauteur 1, avec $a_p$ le coefficient de $Y_p$ dans $D$.
\item Cela est une conséquence de \ref{isopic} et \ref{expicaff}.

\item Dans ce cas, $Y_p$ est effectif, donc $\Gamma(X,\Oo_X(-Y_p))$ est un sous-module de $A$, donc un idéal. On a donc $\Gamma(X,\Oo_X(-Y_p))=pA_p\cap A=p$. Pour l'autre assertion, c'est immédiat car $\Oo_X(Y_p)$ est alors inversible d'après \ref{expicaff}, c'est à dire que $Y_p$ est de Cartier.
\end{enumerate}
\end{proof}

On forme maintenant la somme directe des $\Oo_X(D)$ et on la munit d'un produit de la façon suivante: pour $f_1\in \Oo_X(D_1),\, f_2\in \Oo_X(D_2)$, on définit le produit de $f_1$ et $f_2$ comme l'élément $f_1f_2$ de $\Oo_X(D_1+D_2)$. On voit que cette algèbre est naturellement WDiv-graduée, avec pour chaque degré $D$ un contrôle prescrit quant au comportement des fonctions sur le support de $D$. Ceci mène à la définition suivante.

\begin{defn}[Faisceau d'algèbres divisorielles]
Soit $X$ une variété normale et irréductible. Le faisceau d'algèbres divisorielles associé à un sous-groupe $K\in \wdiv(X)$ est le faisceau de $\Oo_X$-algèbres $K$-graduées $$\bigoplus_{D\in K}S_D,\,\,\,\,\,\,\,\,\, S_D:=\Oo_X(D)$$ 
\end{defn}


\begin{ex}
On considère la droite projective $\PP^1$, $D=\lbrace\infty\rbrace$ et $K=\ZZ D$. Cherchons la forme d'une section $f\in S_{nD}(\PP^1)$. On se place sur la carte affine $U_0=\PP^1\setminus \lbrace \infty\rbrace$ associée au repère projectif $(\infty, 0, 1)=(e_0,e_1,e_0+e_1)$, on note $z$ la coordonnée associée. Par hypothèse, $f$ est régulière sur $U_0$, c'est donc un polynôme en $z$. On fait agir l'homographie $z\mapsto w=1/z$  pour se placer sur la carte $U_1=\PP^1\setminus \lbrace e_1 \rbrace$ associée au repère $(0, \infty,1)$. Sur cette carte, la fonction qui coïncide avec $f$ sur $U_0\cap U_1$ est $g(w)=f(1/w)$. Or si on écrit $f(z)=z^kh(z)$ avec $z\nmid h(z)$, on obtient $g(w)=w^{-k-\textrm{deg}(h)}h(w)$. Comme on doit avoir $k+\textrm{deg}(h)\leq n$, on obtient que $f$ est un polynôme de degré $\leq n$.\\
Ainsi on voit que l'application $\phi_n:k[t_0,t_1]_n\rightarrow S_{nD}(\PP^1), f\mapsto f(1,z)$ est un isomorphisme de $k$-ev. De plus, on a facilement $\phi_n\phi_m=\phi_{n+m}$. Finalement, $(\phi, \widetilde{\phi})$ avec $\phi: k[t_0,t_n]\rightarrow S(\PP^1), f\mapsto f(1,z)$ et $\widetilde{\phi}:\ZZ\rightarrow K, n\mapsto nD$ est un isomorphisme d'algèbres graduées.
\end{ex}

\begin{prop}
Soit $X$ une variété normale et irréductible et $D\in\wdiv(X)$. Alors $\Oo_X(D)$ est un $\Oo_X$-module cohérent. En particulier, le faisceau d'algèbres divisorielles associé à un sous-groupe $K\in \wdiv(X)$ est une $\Oo_X$-algèbre quasi-cohérente.
\end{prop}
\begin{proof}
On peut supposer $X=\spec A$ affine car le problème est local.  Alors d'après \ref{quasicoaff}, $\Oo_X(D)\simeq \tilde{M}$ où $M=\Gamma(X,\Oo_X(D))$. Il s'agit donc de montrer que $M$ est un $A$-module de type fini. Mais d'après \ref{divaff}, on voit que $\Gamma(X,\Oo_X(D))$ est un idéal fractionnaire de $A$, il est donc isomorphe à un idéal de $A$ en tant $A$-module après multiplication par une certaine fonction rationnelle. Comme $A$ est noetherien cela conclut la preuve. En fait, cela revient à constater que les fonctions $f\in \Gamma(X,\Oo_X(D))$ peuvent admettre des pôles uniquement sur les diviseurs premiers intervenant dans l'écriture de $D$, soit un nombre fini. L'ordre de ces pôle peut  donc être borné par un même $d\in \NN$.
\end{proof}

\begin{prop}\label{isomorphismcodim2}
Soit $X$ une variété normale et irréductible et $D\in\wdiv(X)$. Alors pour tout ouvert $U\subset X$ tels que $X\setminus U$ soit de codimension $\geq 2$ dans $X$, on a $\Gamma(U,\Oo_X(D))\simeq \Gamma(X,\Oo_X(D))$.
\end{prop}
\begin{proof}
Encore une fois, on peut traiter le problème localement et supposer $X=\spec A$ affine. La restriction est injective et comme en \ref{extregularnormal}, on remarque que $U$ contient tous les premiers $p$ de hauteur 1. On écrit $D=a_{p_1}Y_{p_1}+...+a_{p_r}Y_{p_r}$ comme en \ref{divaff}, et on considère les injections dans les tiges $\Gamma(X,\Oo_X(D))_p=p^{-a_p}A_p$. On construit ainsi l'inverse de la restriction $\Gamma(U, \Oo_X(D))\xhookrightarrow{}\Gamma(X,\Oo_X(D))=\bigcap_{ht(p)=1}p^{-a_p}A_p$, en procédant comme en \ref{extregularnormal}.
\end{proof}

\subsection{Diviseurs de Cartier et groupe de Picard}

Sur des variétés plus générales, par exemple avec des singularités, les anneaux locaux associés aux diviseurs premiers ne sont plus en général des DVR. On a alors des difficultés pour définir par exemple le diviseur d'une fonction rationnelle. On a néanmoins la notion générale de diviseur de Cartier, qui dans le cadre des variétés normales irréductibles correspondra aux diviseur de Weil "localement principaux".

\begin{defn}[Diviseur de Cartier]
Soit $X$ une variété irréductible. Un diviseur de Cartier sur $X$ est une section globale du faisceau $k(X)^\times/\mathcal{O}_X^\times$. Ainsi un diviseur de Cartier est la donnée d'une famille $(U_i, f_i)_{i\in I}$ telle que pour tout $i$, $U_i$ est un ouvert de $X$, $(U_i)_{i\in I}$ est un recouvrement de $X$, $f_i\in k(X)^\times$, et pour tout $i,j \in I$, $f_if_j^{-1}\in \mathcal{O}_X^\times(U_i\cap U_j)$.\\
Un diviseur de cartier est dit principal si il provient d'une section globale de $k(X)^\times$ c'est à dire d'une fonction rationnelle. Deux diviseurs de Cartier sont dits linéairement équivalents si ils sont égaux modulo le sous-groupe des diviseurs principaux. Le groupe quotient se note CaCl$(X)$.
\end{defn}





Soit $X$ une variété irréductible. On remarque que pour un diviseur de Cartier $D=(U_i, f_i)_{i\in I}$ de $X$, $\mathcal{O}_X(D)_{|U_i}$ est le $(\mathcal{O}_X)_{|U_i}$-module libre de base $(f_i^{-1})$. Il est donc localement libre de rang 1, c'est à dire inversible. On récupère facilement $D$ à partir de $\mathcal{O}_X(D)$ en prenant un recouvrement qui le trivialise. Enfin, pour tout sous-faisceau inversible de $k(X)^\times$ on construit de la même manière un diviseur de Cartier. On a donc une correspondance bijective entre diviseurs de Cartier et sous-faisceau inversible de $k(X)^\times$. Par cette correspondance, deux diviseurs sont linéairement équivalents si et seulement si les faisceaux inversibles sont isomorphes. On a ainsi définit une application injective CaCl$(X)\rightarrow$ Pic$(X)$ dont on voit facilement que c'est un morphisme de groupe. Comme $X$ est supposé irréductible, c'est un isomorphisme car tout faisceau inversible est isomorphe à un sous-faisceau inversible de $k(X)^\times$. En résumé on a le résultat suivant:


\begin{prop}\label{isopic}
Soit $X$ une variété irréductible. L'application $D\mapsto \mathcal{O}_X(D)$ définit un isomorphisme de groupe CaCl$(X)\simeq $ Pic$(X)$.
\end{prop}


On suppose à nouveau $X$ normale et irréductible. Dans ce cadre, tout diviseur de Cartier $(U_i, f_i)_{i\in I}$ définit un unique diviseur de Weil de la façon suivante. Pour tout diviseur premier $Y$, on choisit un indice $i\in I$ tel que $U_i\cap Y\neq \emptyset$ et on prend $v_Y(f_i)$ pour coefficient de $Y$. Cette somme est finie par la même preuve que \ref{noetherienPWDivBienDef}. Par ailleurs elle ne dépend pas du choix des indices car si $j$ est un autre indice possible, $f_if_j^{-1}\in \Oo_X^\times(U_i\cap U_j)$ par définition, donc $v_Y(f_i)=v_Y(f_j)$. On a ainsi un diviseur de Weil tel que sa restriction à tout ouvert du recouvrement $(U_i)_{i\in I}$ est principal. D'où la terminologie "localement principal". Ce constat permet de voir CaCl$(X)$ comme un sous-groupe de Cl$(X)$ (on vérifie que les diviseurs principaux se correspondent).

Ce sous-groupe est propre en général (cf \cite{Hartshorne} 6.11.3). En revanche, si $X$ est lisse, tout diviseur de Weil est localement principal . En effet dans ce cas, les anneaux locaux sont factoriels, on obtient ainsi en tout point une équation locale d'un diviseur premier car un idéal premier de hauteur 1 d'un anneau factoriel est principal, ce qui permet de conclure.

\begin{prop}\label{isomophismeOTimes}
Soit $X$ une variété normale irréductible, $D,E\in\wdiv X$ avec $D$ de Cartier. Alors le morphisme naturel $\alpha:\Oo_X(D)\otimes_{\Oo_X}\Oo_X(E)\rightarrow \Oo_X(D+E)$ est un isomorphisme.
\end{prop}
\begin{proof}
Écrivons $D=(U_i,f_i)_{i\in I}$. Alors sur chaque $U_i$, le morphisme $\alpha$ induit un isomorphisme de $\Oo_X$-module. En effet on a un morphisme inverse, il s'agit de la multiplication par $f_i$ composée avec l'inverse de l'isomorphisme $\Oo_{U_i}(D)\otimes_{\Oo_{U_i}}\Oo_{U_i}(E) \simeq \Oo_{U_i}(D)$, localement donné par $a\otimes b\mapsto abf_i$ .
\end{proof}

Par analogie avec les diviseurs de Weil, un diviseur de Cartier $D=(U_i, f_i)_{i\in I}$ est dit effectif si pour tout $i\in I$, $f_i\in \Oo_X(U_i)$. Dans ce cas $\Oo_X(-D)$ est un sous $\Oo_X$-module de $\Oo_X$, c'est concrètement le faisceau d'idéaux localement généré sur chaque $U_i$ par $f_i$. D'après \ref{dimsousvariete} cela définit un sous-schéma fermé de $X$ de codimension 1. L'inclusion $\Oo_X(-D)\xhookrightarrow{} \Oo_X$ est une section globale de $\Hh om(\Oo_X(-D), \Oo_X)\simeq \Oo_X(D)$ appelée section canonique et notée $1_D$ puisqu'elle correspond à la multiplication par $1$. Réciproquement, la donnée d'un couple $(\Ll, s)$ constitué d'un faisceau inversible sur $X$ et d'une section globale définit un diviseur de Cartier effectif de la manière suivante. Soit $(U_i)_{i\in I}$ un recouvrement qui trivialise $\Ll$. Sur chaque $U_i$ on a un isomorphisme $\phi_i:\Ll_{|U_i}\rightarrow\Oo_{X|U_i}$. On voit que $(U_i,\phi_i(s))_i$ définit un diviseur de Cartier effectif indépendant du choix des $\phi_i$, et donc du couple $(\Ll,s)$ à isomorphisme près. On l'appelle le diviseur des zéros de $s$ et on le note $\divi_D(s)$. Les deux procédés que l'on vient de décrire sont inverses l'un de l'autre, on obtient ainsi une correspondance bijective:

$$
\left\{
\begin{matrix}
\text{Diviseurs de Cartier effectif sur }X
\end{matrix}
\right\}
\leftrightarrow
\left\{
\begin{matrix}
\text{couples }(\mathcal{L}, s)\text{ constitués d'un faisceau}\\
\text{inversible et d'une section globale}
\end{matrix}
\right\}
$$

Considérons un diviseur de Cartier $D$ quelconque et $\Oo_X(D)$ le sous-faisceau inversible de $k(X)$ qui lui correspond. En faisant varier $s$ non-nulle dans les couples $(\Oo_X(D),s)$ tels que ci-dessus, on obtient tous les diviseurs de Cartier effectifs linéairement équivalent à $D$. En effet, $\divi_D(s)$ est par définition un diviseur effectif linéairement équivalent à $D$. Réciproquement un diviseur effectif linéairement équivalent à $D$ s'écrit $D+\divi(s)\geq 0$ où $s$ est donc une section globale $s$ de $\Oo_X(D)$.

\subsection{L'espace projectif $\PP_k^n$}

\subsubsection{Faisceaux inversibles sur $\PP_k^n$}

\subsubsection{Morphismes vers l'espace projectif}
\label{morphismeproj}
Soit $X$ une variété munie d'un morphisme $(f,f^\sharp):X\rightarrow \PP^n_k$, où $\PP^n_k=$Proj$k[x_0,...,x_n]$. On considère le faisceau tordu de Serre $\Oo(1)$ sur $\PP^n_k$. C'est un faisceau inversible engendré par les sections globales $x_0,...,x_n$. $f^*\Oo(1)$ est également inversible et on a un morphisme canonique de $\Oo_{\PP^n_k}$-module $\alpha:\Oo(1)\rightarrow f_*f^*\Oo(1)$ où la structure de $\Oo_{\PP^n_k}$-module sur $f_*f^*\Oo(1)$ est donnée par $\lambda.t=f^\sharp(\lambda)t$ pour tout ouvert $V\subset \PP^n_k$, $\lambda\in \Oo_{\PP^n_k}(V)$, $t\in f_*f^*\Oo(1)(V)$. On définit des sections globales $f^*(x_0):=s_0:=\alpha(\PP^n_k)(x_0),...,f^*(x_n):=s_n:=\alpha(\PP^n_k)(x_n)$ de $f^*\Oo(1)$ dont on voit facilement qu'elles engendrent $f^*\Oo(1)$.\\
Considérons un faisceau inversible $\Ll$ sur une variété $Y$, une section globale $l$, et un morphisme $(g,g^\sharp):X\rightarrow Y$. On définit l'ouvert 
$$Y_l:=\lbrace y\in Y\mid \Oo_{Y,y}l_y=\Ll_y\rbrace=\lbrace y\in Y\mid l_y\notin m_y\Ll_y\rbrace$$
C'est tout simplement le complémentaire du support du diviseur des zéros associé au couple $(\Ll,l)$. Si $\Ll=\Oo_Y$ il s'agit de l'ouvert principal $Y_l$, et on a de plus $g^{-1}(Y_l)=X_{g^\sharp(l)}=X_{g^*(l)}$ car $g^*\Oo_Y=\Oo_X$ et $\alpha=g^\sharp$ dans ce cas. Revenant dans le cas général, on voit facilement que $g^*\Ll$ est inversible et en raisonnant localement sur des ouverts affines qui trivialisent $\Ll$, on voit d'après ce qui précède que $g^{-1}(Y_l)=X_{g^*(l)}$. D'autre part, si $l_1,...,l_n$ sont des sections globales qui engendrent $\Ll$, on voit que $(Y_{l_i})$ est un recouvrement de $Y$ qui trivialise $\Ll$. En effet, sur chaque $Y_{l_i}$, on a un isomorphisme $\Oo_{Y|Y_{l_i}}\rightarrow \Ll_{Y|Y_{l_i}}$, $\lambda \mapsto \lambda l_i$, et par hypothèse, l'intersection des complémentaires des $Y_{l_i}$ est vide. Enfin, on note sans ambiguïté $l_j/l_i$ l'unique élément de $\Oo_{Y|Y_{l_i}}(Y_l)$ tel que $l_j/l_i.l_i=l_j$ par l'isomorphisme précédent.\\
Revenons au cas initial et notons $U_i=D_+(x_i)=\Oo(1)_{x_i}$. La $k$-algèbre $\Oo_{P^n_k}(U_i)$ est engendrée par les éléments $x_j/x_i$ et on a $s_j/s_i.s_i=s_j=\alpha(U_i)(x_j)=\alpha(U_i)(x_j/x_i.x_i)=f^\sharp(x_j/x_i).\alpha(U_i)(x_i)=f^\sharp(x_j/x_i).s_i$. On a donc nécessairement $f^\sharp(x_j/x_i)=s_j/s_i$. Comme les $U_i$ sont affines, cela définit des morphismes $f_i:X_{s_i}\rightarrow P^n_k$ en composant avec l'inclusion. C'est morphismes se recollent en un unique morphisme, car ils coïncident sur les $X_{s_i}\cap X_{s_j}$. Autrement dit, on récupère $f$ par la donnée des $s_i$, et $f$ est ainsi l'unique morphisme tel que $f^*(x_i)=s_i$.\\
Réciproquement montrons que la donnée d'un faisceau inversible $\Ll$ sur $X$ et de sections globales $l_0,...,l_n$ qui l'engendrent définissent un unique morphisme $f:X\rightarrow \PP^n_k$ tel que $\Ll\simeq f^*\Oo(1)$, ce dernier isomorphisme étant celui qui envoie $f^*(x_i)$ sur $l_i$. Si $f$ existe avec ces propriétés, il est unique d'après ce qui précède. Pour l'existence, on construit comme précédemment des morphismes $f_i:X_{l_i}\rightarrow U_i$ qui se recollent en un morphisme $f:X\rightarrow \PP^n_k$. Par construction, $\Ll$ et $f^*\Oo(1)$ se trivialisent sur le même recouvrement $(f^{-1}(U_i)=X_{l_i}=X_{f^*(x_i)})_i$. On a des isomorphismes locaux $\phi_i:\Ll_{|f^{-1}(U_i)}\rightarrow f^*\Oo(1)_{|f^{-1}(U_i)}$, $l_i\mapsto f^*x_i$. Ce sont des sections locales de $\mathscr{H}om_{\Oo_X}(\Ll,\Oo(1))$ sur un recouvrement de $X$. Pour vérifier qu'elles coïncident aux intersections $X_{l_i}\cap X_{l_j}$, on remarque que l'on a $l_i/l_j=f^\sharp(U_i\cap U_j)(x_i/x_j)= f^*(x_i)/f^*(x_j)\in \Oo_X(X_{l_i}\cap X_{l_j})^\times$. Ces sections se recollent donc en un unique isomorphisme $\Ll\simeq f^*\Oo(1)$ qui est bien l'isomorphisme recherché.

Notons que cette propriété caractérise l'espace projectif $\PP^n_k$ à isomorphisme près. En effet il représente le foncteur (voir stacks)...

\subsubsection{Variétés quasi-projectives, faisceaux inversible très amples}

\begin{defn}
Soit $X$ une variété et $\Ll$ un faisceau inversible sur $X$ engendré par une famille finie de sections globales. Si ces sections définissent une immersion $X\xhookrightarrow{}\PP_k^n$, on dit que $\Ll$ est très ample. Cela revient à dire que $\Ll\simeq i^*\Oo(1)$  pour une immersion $i:\xhookrightarrow{}\PP_k^n$.\\
Si $X$ est normale et irréductible, un diviseur de Cartier $D$ est dit très ample si on a $\Oo_X(D)\simeq i^*\Oo(1)$ pour une immersion $i:\xhookrightarrow{}\PP_k^n$.
\end{defn}

Supposons maintenant $X$ lisse (donc normale) et projective, $D\in \wdiv(X)$, $\Oo_X(D)$ le faisceau inversible associé. On a vu que l'ensemble des diviseurs effectifs linéairement équivalents à $D$ est $\lbrace \divi_D(s)\mid s\in\Gamma(X,\Oo_X(D))\setminus\lbrace0\rbrace \rbrace$. D'autre part deux sections globales $s, s'$ non nulles ont même diviseur des zéros si et seulement si elles sont colinéaires dans le $k$-ev $\Gamma(X, \Oo_X(D))$, en effet dans ce cas $s/s'\in \Oo_X^\times(X)=k^*$, car $k$ est algébriquement clos. Notons enfin que $\Gamma(X, \Oo_X(D))$ est de dimension finie (\cite{Hartshorne} II.5.19). Ainsi l'ensemble des diviseurs effectifs linéairement équivalent à $D$ est naturellement muni d'une structure d'espace projectif, cela amène la définition suivante:
\begin{defn}[Système linéaire, point de base]
Soit $X$ une variété lisse et projective, et $D$ un diviseur. Le système linéaire complet définit par $D$ est l'ensemble des diviseurs effectifs linéairement équivalents à $D$, on le note $|D|$. Un système linéaire est une partie de $|D|$ correspondant à un sous espace projectif. On dit que $p\in X$ est un point de base d'un système linéaire $\PP(V)\subset |D|$ si l'intersection des $X\setminus X_s$ pour $s\in V$ est non vide. 
\end{defn}

Autrement dit dans ce langage, se donner un morphisme $X\rightarrow \PP^n_k$ est équivalent à se donner un système linéaire $\PP(V)\subset |D|$ sans point de base et une base de $V$.


\subsection{Le groupe des unités d'une variété irréductible}
\label{unitGroupFiniteType}


Soit $X$ une variété, le groupe des unités $U(X)$ de $X$ est le quotient du groupe $\Oo(X)^*$ des fonctions régulières inversibles par le sous-groupe $k^*$ des fonctions constantes. On va appliquer les techniques précédentes pour obtenir un résultat de finitude de $U(X)$ lorsque $X$ est irréductible, ainsi que du groupe des caractères d'un groupe algébrique.

\begin{prop}
Soit $X$ une variété irréductible. Alors $U(X)$ est libre de type fini.
\end{prop}
\begin{proof}
Comme $\Oo(X)^*$ s'injecte dans $\Oo(U)^*$ pour tout ouvert $U\subset X$, on peut supposer $X$ affine car un sous-groupe d'un groupe abélien libre de type fini est aussi libre de type fini. Soit $\eta_X:\widetilde{X}\rightarrow X$ l'application de normalisation. Alors $\widetilde{X}$ est affine, on a une injection $\eta_X^\sharp:\Oo(X)\xhookrightarrow{}\Oo(\widetilde{X})$ qui induit une injection $U(X)\xhookrightarrow{}U(\widetilde{X})$. On peut donc supposer $X$ normale.

D'après \ref{}, on peut supposer que $X$ est un ouvert d'une variété projective normale $\bar{X}$. On note $D_1,...,D_r$ les composantes irréductibles de $\bar{X}\setminus X$. Ceux sont des diviseurs premiers car ils sont définis par l'équation de l'hyperplan à l'infini. Dans chaque carte affine qui les rencontre, il s'agit donc de sous-variétés fermés de codimension $1$ d'après \ref{dimsousvariete}. Chacun de ces diviseurs premiers $D_i$ définit un anneau de valuation discrète dont on note $v_i$ la valuation. On considère l'application:
$$\Oo(X)^*\rightarrow \ZZ^r, f\mapsto (v_1(f),...,v_r(f))$$
C'est un morphisme de groupes de noyau $k^*$ d'après \cite{Hartshorne} I.3.4. ce qui conclut la preuve.
\end{proof}

\begin{prop}
Soit $X, Y$ des variétés irréductibles. Alors le morphisme:
$$\Oo(X)^*\times\Oo(Y)^*\rightarrow\Oo(X\times Y)^*,\,(f,g)\mapsto ((x,y )\mapsto f(x)g(y))$$
est surjectif.
\end{prop}
\begin{proof}
Il suffit de montrer que $f\in \Oo(X\times Y)^*$ peut s'écrire $f=gh$ pour $g\in k(X)$ et $h\in k(Y)$. En effet, on considère un point $y\in Y$ où $h$ est régulière. D'autre part on constate que $f_y:x\mapsto f(x,y)$ est régulière sur $X$, ce qui se voit sur les ouverts affines $U\times V$. En effet $\Oo(U\times V)$ est alors le coproduit des algèbres de coordonnées $\Oo(U)$ et $\Oo(V)$, c'est à dire leur produit tensoriel. De plus, $f_y$ ne s'annule pas donc est inversible dans $\Oo(X)$. Cela prouve que $g$ est en fait régulière, et $h$ aussi par le même raisonnement.

On peut ainsi remplacer $X$ et $Y$ par deux ouverts affines lisses. Le produit  $X\times Y$ est encore affine et lisse d'après \ref{}. D'après \ref{}, on peut supposer que $X$ est un ouvert d'une variété projective normale $\bar{X}$, et on note $D_1,...,D_r$ les diviseurs premiers correspondants aux composantes irréductibles de $\bar{X}\setminus X$. Soit $f\in \Oo(X\times Y)^*$ que l'on regarde comme une fonction rationnelle sur $\bar{X}\times Y$, qui est normal d'après \ref{}. Le diviseur associé à $f$ est à support dans $(\bar{X}\setminus X)\times Y$, on a donc $\divi(f)=\sum_{i=1}^rn_iD_i\times Y$ pour des entiers $n_1,...,n_r$. Soit $\pi_i$ une uniformisante de l'anneau de valuation discrète $\Oo_{\bar{X},D_i}$. Il existe $x_0\in D_i$ tel que $\pi_i$ définisse une équation locale de $D_i$. Soit $y_0\in Y$, on peut écrire une équation locale de $D_i\times Y$ en $(x_0,y_0)$ s'écrit $f_i(x)u(x,y)$ avec $u$ inversible sur un voisinage de $(x_0,y_0)$. Ainsi il existe un ouvert non-vide $V\subset Y$ tel que pour tout $y\in V$, on ait $\divi(f_y)=\sum_{i=1}^rn_iD_i$. Choisissons $y_0\in V$, alors $\divi(f_yf_{y_0}^{-1})=0$ donc $f_yf_{y_0}^{-1}$ définit une fonction régulière sur $\bar{X}$. Comme $\bar{X}$ est complète (voir \ref{}), $f_yf_{y_0}^{-1}$ est en fait constante. Ainsi $h:=f/f_{y_0}$ définit une fonction rationnelle sur $Y$ telle que $f=f_{y_0}h$ comme désiré.
\end{proof}

\noindent Soit $X,\,Y$ des variétés irréductibles. Considérons la suite exacte courte

\begin{equation}\label{eq:sesUnitGroup}
0\rightarrow k^* \rightarrow \Oo(X)^*\rightarrow U(X) \rightarrow 0
\end{equation}
Elle est scindée car tout choix de $x\in X$ définit une section. En effet, le sous-groupe de $\Oo(X)^*$ des fonctions valant $1$ en $x$ s'envoie isomorphiquement sur $U(X)$. On a donc $\Oo(X)^*\simeq k^*\times U(X)$. De plus, le noyau du morphisme naturel $\Oo(X)^*\times\Oo(Y)^*\rightarrow U(X\times Y)$ est $k^*\times k^*$. Comme il est surjectif d'après la proposition précédente, on obtient $U(X\times Y)\simeq U(X)\times U(Y)$.
On applique maintenant ces résultats au groupe de caractères d'un groupe algébrique connexe. 


\begin{prop}
Soit $G$ un groupe algébrique connexe, et $f\in \Oo(G)^*$ telle que $f(e)=1$. Alors $f\in X^*(G)$.
\end{prop}
\begin{proof}
L'application
$$f\circ m:G\times G\rightarrow \AAA^1, (g,h)\mapsto f(gh)$$
est régulière inversible sur $G\times G$ qui est connexe donc irréductible. On applique donc la proposition précédente pour trouver $\phi,\psi \in \Oo(G)^*$ tels que $f(gh)=\phi(g)\psi(g),\,\forall g,h\in G$. Quitte à multiplier $\phi$ par un scalaire, on peut supposer $\phi(e)=1$. En fixant $g=e$ on obtient $\psi=f$, puis en fixant cette fois $h=e$, on obtient $g=\phi$. Finalement, $f(gh)=f(g)f(h)$, donc $f$ est un caractère.
\end{proof}

Ainsi, pour un groupe algébrique connexe $G$, le groupe des caractères $X^*(G)$ définit un scindage de la suite exacte courte \ref{eq:sesUnitGroup}. On a donc $X^*(G)\simeq U(G)$ et donc $X^*(G\times H)\simeq X^*(G)\times X^*(H)$ pour tout autre groupe algébrique connexe $H$. En particulier on en déduit que le groupe des caractères d'un groupe algébrique quelconque est de type fini comme on le voit en considérant l'injection $X^*(G)\xhookrightarrow{} \prod_{i=1}^rU(g_iG^o)$, où les $g_iG^o$ désignent les composantes connexes de $G$. Le corollaire suivant nous sera utile par la suite.

\begin{cor}\label{rosenlicht1}
Soit $G$ un groupe algébrique connexe, et $X$ une $G$-variété. Alors l'application naturelle $X^*(G)\times \Oo(X)^*\rightarrow \Oo(G\times X)^*$ est un isomorphisme.

Si $X$ est de plus une $G$-variété. Alors pour tout $f\in \Oo(X)^*$, il existe $\chi_f\in X^*(G)$ tel que $f(g.x)=\chi_f(g)f(x)$ pour tout $g\in G$ et $x\in X$.
\end{cor}
\begin{proof}
L'application est bien surjective d'après le corollaire et la proposition précédente et son noyau est clairement trivial. Pour le deuxième point, il suffit de considérer l'application $(g,x)\mapsto f(g.x)\in \Oo(G\times X)^*$.
\end{proof}
